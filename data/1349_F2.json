{
    "title": "F2. Slime and Sequences (Hard Version)",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p><span class=\"tex-font-style-bf\">Note that the only differences between easy and hard versions are the constraints on $$$n$$$ and the time limit. You can make hacks only if all versions are solved.</span></p><p>Slime is interested in sequences. He defined <span class=\"tex-font-style-bf\">good</span> positive integer sequences $$$p$$$ of length $$$n$$$ as follows:</p><ul><li> For each $$$k&gt;1$$$ that presents in $$$p$$$, there should be at least one pair of indices $$$i,j$$$, such that $$$1 \\leq i &lt; j \\leq n$$$, $$$p_i = k - 1$$$ and $$$p_j = k$$$.</li></ul><p>For the given integer $$$n$$$, the set of all good sequences of length $$$n$$$ is $$$s_n$$$. For the fixed integer $$$k$$$ and the sequence $$$p$$$, let $$$f_p(k)$$$ be the number of times that $$$k$$$ appears in $$$p$$$. For each $$$k$$$ from $$$1$$$ to $$$n$$$, Slime wants to know the following value:</p><p>$$$$$$\\left(\\sum_{p\\in s_n} f_p(k)\\right)\\ \\textrm{mod}\\ 998\\,244\\,353$$$$$$</p>",
    "inputSpecification": "<p>The first line contains one integer $$$n\\ (1\\le n\\le 100\\,000)$$$.</p>",
    "outputSpecification": "<p>Print $$$n$$$ integers, the $$$i$$$-th of them should be equal to $$$\\left(\\sum_{p\\in s_n} f_p(i)\\right)\\ \\textrm{mod}\\ 998\\,244\\,353$$$.</p>",
    "samples": [
        {
            "input": "\n2\n",
            "output": "\n3 1 \n"
        },
        {
            "input": "\n3\n",
            "output": "\n10 7 1 \n"
        },
        {
            "input": "\n1\n",
            "output": "\n1 \n"
        }
    ],
    "note": "<p>In the first example, $$$s=\\{[1,1],[1,2]\\}$$$.</p><p>In the second example, $$$s=\\{[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,2],[1,2,3]\\}$$$.</p><p>In the third example, $$$s=\\{[1]\\}$$$.</p>",
    "contestId": 1349,
    "index": "F2",
    "name": "Slime and Sequences (Hard Version)",
    "type": "PROGRAMMING",
    "tags": [
        "dp",
        "fft",
        "math"
    ],
    "solvedCount": 108
}