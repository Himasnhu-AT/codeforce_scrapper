{
    "title": "E. Dasha and cyclic table",
    "timeLimit": {
        "value": 6.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>Dasha is fond of challenging puzzles: Rubik's Cube <span class=\"tex-span\">3\u2009\u00d7\u20093\u2009\u00d7\u20093</span>, <span class=\"tex-span\">4\u2009\u00d7\u20094\u2009\u00d7\u20094</span>, <span class=\"tex-span\">5\u2009\u00d7\u20095\u2009\u00d7\u20095</span> and so on. This time she has a cyclic table of size <span class=\"tex-span\"><i>n</i>\u2009\u00d7\u2009<i>m</i></span>, and each cell of the table contains a lowercase English letter. Each cell has coordinates <span class=\"tex-span\">(<i>i</i>,\u2009<i>j</i>)</span> (<span class=\"tex-span\">0\u2009\u2264\u2009<i>i</i>\u2009&lt;\u2009<i>n</i></span>, <span class=\"tex-span\">0\u2009\u2264\u2009<i>j</i>\u2009&lt;\u2009<i>m</i></span>). The table is cyclic means that to the right of cell <span class=\"tex-span\">(<i>i</i>,\u2009<i>j</i>)</span> there is the cell <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/e00cecdb9def14eda362dd13b8a57d183987a244.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, and to the down there is the cell <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/4af907e4db06c705844ece1487c9a8b73c4446aa.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p><p>Dasha has a pattern as well. A pattern is a non-cyclic table of size <span class=\"tex-span\"><i>r</i>\u2009\u00d7\u2009<i>c</i></span>. Each cell is either a lowercase English letter or a question mark. Each cell has coordinates <span class=\"tex-span\">(<i>i</i>,\u2009<i>j</i>)</span> (<span class=\"tex-span\">0\u2009\u2264\u2009<i>i</i>\u2009&lt;\u2009<i>r</i></span>, <span class=\"tex-span\">0\u2009\u2264\u2009<i>j</i>\u2009&lt;\u2009<i>c</i></span>).</p><p>The goal of the puzzle is to find all the appearance positions of the pattern in the cyclic table.</p><p>We say that the cell <span class=\"tex-span\">(<i>i</i>,\u2009<i>j</i>)</span> of cyclic table is an appearance position, if for every pair <span class=\"tex-span\">(<i>x</i>,\u2009<i>y</i>)</span> such that <span class=\"tex-span\">0\u2009\u2264\u2009<i>x</i>\u2009&lt;\u2009<i>r</i></span> and <span class=\"tex-span\">0\u2009\u2264\u2009<i>y</i>\u2009&lt;\u2009<i>c</i></span> one of the following conditions holds: </p><ul> <li> There is a question mark in the cell <span class=\"tex-span\">(<i>x</i>,\u2009<i>y</i>)</span> of the pattern, or </li><li> The cell <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/d5c67d542f3276ced72278777147ac5f3b4c9958.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> of the cyclic table equals to the cell <span class=\"tex-span\">(<i>x</i>,\u2009<i>y</i>)</span> of the pattern. </li></ul><p>Dasha solved this puzzle in no time, as well as all the others she ever tried. Can you solve it?.</p>",
    "inputSpecification": "<p>The first line contains two integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>\u2009\u2264\u2009400</span>)\u00a0\u2014 the cyclic table sizes.</p><p>Each of the next <span class=\"tex-span\"><i>n</i></span> lines contains a string of <span class=\"tex-span\"><i>m</i></span> lowercase English characters\u00a0\u2014 the description of the cyclic table.</p><p>The next line contains two integers <span class=\"tex-span\"><i>r</i></span> and <span class=\"tex-span\"><i>c</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>r</i>,\u2009<i>c</i>\u2009\u2264\u2009400</span>)\u00a0\u2014 the sizes of the pattern.</p><p>Each of the next <span class=\"tex-span\"><i>r</i></span> lines contains a string of <span class=\"tex-span\"><i>c</i></span> lowercase English letter and/or characters '<span class=\"tex-font-style-tt\">?</span>'\u00a0\u2014 the description of the pattern.</p>",
    "outputSpecification": "<p>Print <span class=\"tex-span\"><i>n</i></span> lines. Each of the <span class=\"tex-span\"><i>n</i></span> lines should contain <span class=\"tex-span\"><i>m</i></span> characters. Each of the characters should equal '<span class=\"tex-font-style-tt\">0</span>' or '<span class=\"tex-font-style-tt\">1</span>'.</p><p>The <span class=\"tex-span\"><i>j</i></span>-th character of the <span class=\"tex-span\"><i>i</i></span>-th (<span class=\"tex-span\">0</span>-indexed) line should be equal to '<span class=\"tex-font-style-tt\">1</span>', in case the cell <span class=\"tex-span\">(<i>i</i>,\u2009<i>j</i>)</span> is an appearance position, otherwise it should be equal to '<span class=\"tex-font-style-tt\">0</span>'.</p>",
    "samples": [
        {
            "input": "5 7<br/>qcezchs<br/>hhedywq<br/>wikywqy<br/>qckrqzt<br/>bqexcxz<br/>3 2<br/>??<br/>yw<br/>?q<br/>",
            "output": "0000100<br/>0001001<br/>0000000<br/>0000000<br/>0000000<br/>"
        },
        {
            "input": "10 10<br/>fwtoayylhw<br/>yyaryyjawr<br/>ywrdzwhscy<br/>hnsyyxiphn<br/>bnjwzyyjvo<br/>kkjgseenwn<br/>gvmiflpcsy<br/>lxvkwrobwu<br/>wyybbcocyy<br/>yysijsvqry<br/>2 2<br/>??<br/>yy<br/>",
            "output": "1000100000<br/>0000000001<br/>0001000000<br/>0000010000<br/>0000000000<br/>0000000000<br/>0000000000<br/>0100000010<br/>1000000001<br/>0000010000<br/>"
        },
        {
            "input": "8 6<br/>ibrgxl<br/>xqdcsg<br/>okbcgi<br/>tvpetc<br/>xgxxig<br/>igghzo<br/>lmlaza<br/>gpswzv<br/>1 4<br/>gx??<br/>",
            "output": "000100<br/>000001<br/>000000<br/>000000<br/>010001<br/>000000<br/>000000<br/>000000<br/>"
        }
    ],
    "note": null,
    "contestId": 754,
    "index": "E",
    "name": "Dasha and cyclic table",
    "type": "PROGRAMMING",
    "tags": [
        "bitmasks",
        "brute force",
        "fft",
        "strings",
        "trees"
    ],
    "solvedCount": 485
}