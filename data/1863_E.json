{
    "title": "E. Speedrun",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are playing a video game. The game has $$$n$$$ quests that need to be completed. However, the $$$j$$$-th quest can only be completed at the beginning of hour $$$h_j$$$ of a game day. The game day is $$$k$$$ hours long. The hours of each game day are numbered $$$0, 1, \\ldots, k - 1$$$. After the first day ends, a new one starts, and so on.</p><p>Also, there are dependencies between the quests, that is, for some pairs $$$(a_i, b_i)$$$ the $$$b_i$$$-th quest can only be completed after the $$$a_i$$$-th quest. It is guaranteed that there are <span class=\"tex-font-style-bf\">no circular dependencies</span>, as otherwise the game would be unbeatable and nobody would play it.</p><p>You are skilled enough to complete any number of quests in a negligible amount of time (i.\u00a0e. you can complete any number of quests at the beginning of the same hour, even if there are dependencies between them). You want to complete all quests as fast as possible. To do this, you can complete the quests in any valid order. The completion time is equal to the difference between the time of completing the last quest and the time of completing the first quest in this order.</p><p>Find the least amount of time you need to complete the game.</p>",
    "inputSpecification": "<p>Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1\\le t\\le 100\\,000$$$). The description of the test cases follows.</p><p>The first line of each test case contains three integers $$$n$$$, $$$m$$$, and $$$k$$$ ($$$1\\le n\\le 200\\,000$$$, $$$0\\le m\\le 200\\,000$$$, $$$1\\le k\\le 10^9$$$)\u00a0\u2014 the number of quests, the number of dependencies between them, and the number of hours in a game day, respectively.</p><p>The next line contains $$$n$$$ integers $$$h_1, h_2, \\ldots, h_n$$$ ($$$0\\le h_i &lt; k$$$).</p><p>The next $$$m$$$ lines describe the dependencies. The $$$i$$$-th of these lines contains two integers $$$a_i$$$ and $$$b_i$$$ ($$$1\\le a_i &lt; b_i\\le n$$$) meaning that quest $$$b_i$$$ can only be completed after quest $$$a_i$$$. It is guaranteed that all dependencies are pairwise distinct.</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$200\\,000$$$.</p><p>It is guaranteed that the sum of $$$m$$$ over all test cases does not exceed $$$200\\,000$$$.</p>",
    "outputSpecification": "<p>For each test case, output a single integer\u00a0\u2014 the minimum completion time.</p>",
    "samples": [
        {
            "input": "\n<div class=\"test-example-line test-example-line-even test-example-line-0\">6</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">4 4 24</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">12 16 18 12</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">1 2</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">1 3</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">2 4</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">3 4</div><div class=\"test-example-line test-example-line-even test-example-line-2\">4 3 10</div><div class=\"test-example-line test-example-line-even test-example-line-2\">2 6 5 9</div><div class=\"test-example-line test-example-line-even test-example-line-2\">1 4</div><div class=\"test-example-line test-example-line-even test-example-line-2\">2 4</div><div class=\"test-example-line test-example-line-even test-example-line-2\">3 4</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">2 1 10</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">5 5</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">1 2</div><div class=\"test-example-line test-example-line-even test-example-line-4\">5 0 1000</div><div class=\"test-example-line test-example-line-even test-example-line-4\">8 800 555 35 35</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">5 0 10</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">3 2 5 4 7</div><div class=\"test-example-line test-example-line-even test-example-line-6\">3 2 5</div><div class=\"test-example-line test-example-line-even test-example-line-6\">4 3 2</div><div class=\"test-example-line test-example-line-even test-example-line-6\">1 2</div><div class=\"test-example-line test-example-line-even test-example-line-6\">2 3</div>",
            "output": "\n24\n7\n0\n480\n5\n8\n"
        }
    ],
    "note": "<p>In the first test case, quests $$$1$$$ and $$$4$$$ must be completed at the beginning of the $$$12$$$-th hour of the day, but they cannot be completed during the same hour, because you also need to complete quests $$$2$$$ and $$$3$$$ between them. You can do all this in $$$24$$$ hours, though. To do so, you start at $$$12$$$ hours of the first game day by completing the first quest. At $$$16$$$ hours you complete quest $$$2$$$. At $$$18$$$ hours you complete quest $$$3$$$. Finally at $$$12$$$ hours of the second day you can complete quest $$$4$$$. The total time elapsed (from the moment you completed the first quest and the moment you completed the last) is $$$24$$$ hours.</p><p>In the third test case, you can complete the first quest and then complete the remaining quest right after. You start at $$$5$$$ hours of the first day by completing the first quest. After this the second quest becomes available, you complete it as well. The total time elapsed is $$$0$$$.</p><p>In the fourth test case, you can start with the third quest. You start at $$$555$$$ hours of the first day and you can finish at $$$35$$$ hours of the second day. The total time elapsed is $$$1035-555=480$$$.</p>",
    "contestId": 1863,
    "index": "E",
    "name": "Speedrun",
    "type": "PROGRAMMING",
    "tags": [
        "brute force",
        "dfs and similar",
        "dp",
        "graphs",
        "greedy",
        "math",
        "sortings",
        "two pointers"
    ],
    "solvedCount": 2646
}