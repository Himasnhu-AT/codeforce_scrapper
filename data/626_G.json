{
    "title": "G. Raffles",
    "timeLimit": {
        "value": 5.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Johnny is at a carnival which has <span class=\"tex-span\"><i>n</i></span> raffles. Raffle <span class=\"tex-span\"><i>i</i></span> has a prize with value <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub></span>. Each participant can put tickets in whichever raffles they choose (they may have more than one ticket in a single raffle). At the end of the carnival, one ticket is selected at random from each raffle, and the owner of the ticket wins the associated prize. A single person can win multiple prizes from different raffles. </p><p>However, county rules prevent any one participant from owning more than half the tickets in a single raffle, i.e. putting more tickets in the raffle than all the other participants combined. To help combat this (and possibly win some prizes), the organizers started by placing a single ticket in each raffle, which they will never remove.</p><p>Johnny bought <span class=\"tex-span\"><i>t</i></span> tickets and is wondering where to place them. Currently, there are a total of <span class=\"tex-span\"><i>l</i><sub class=\"lower-index\"><i>i</i></sub></span> tickets in the <span class=\"tex-span\"><i>i</i></span>-th raffle. He watches as other participants place tickets and modify their decisions and, at every moment in time, wants to know how much he can possibly earn. Find the maximum possible expected value of Johnny's winnings at each moment if he distributes his tickets optimally. Johnny may redistribute all of his tickets arbitrarily between each update, but he may not place more than <span class=\"tex-span\"><i>t</i></span> tickets total or have more tickets in a single raffle than all other participants combined.</p>",
    "inputSpecification": "<p>The first line contains two integers <span class=\"tex-span\"><i>n</i></span>, <span class=\"tex-span\"><i>t</i></span>, and <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>t</i>,\u2009<i>q</i>\u2009\u2264\u2009200 000</span>) \u2014 the number of raffles, the number of tickets Johnny has, and the total number of updates, respectively.</p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> space-separated integers <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>p</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u20091000</span>) \u2014 the value of the <span class=\"tex-span\"><i>i</i></span>-th prize.</p><p>The third line contains <span class=\"tex-span\"><i>n</i></span> space-separated integers <span class=\"tex-span\"><i>l</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>l</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u20091000</span>) \u2014 the number of tickets initially in the <span class=\"tex-span\"><i>i</i></span>-th raffle.</p><p>The last <span class=\"tex-span\"><i>q</i></span> lines contain the descriptions of the updates. Each description contains two integers <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>k</i></sub></span>, <span class=\"tex-span\"><i>r</i><sub class=\"lower-index\"><i>k</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>t</i><sub class=\"lower-index\"><i>k</i></sub>\u2009\u2264\u20092</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>r</i><sub class=\"lower-index\"><i>k</i></sub>\u2009\u2264\u2009<i>n</i></span>) \u2014 the type of the update and the raffle number. An update of type <span class=\"tex-span\">1</span> represents another participant adding a ticket to raffle <span class=\"tex-span\"><i>r</i><sub class=\"lower-index\"><i>k</i></sub></span>. An update of type <span class=\"tex-span\">2</span> represents another participant removing a ticket from raffle <span class=\"tex-span\"><i>r</i><sub class=\"lower-index\"><i>k</i></sub></span>.</p><p>It is guaranteed that, after each update, each raffle has at least <span class=\"tex-span\">1</span> ticket (not including Johnny's) in it.</p>",
    "outputSpecification": "<p>Print <span class=\"tex-span\"><i>q</i></span> lines, each containing a single real number\u00a0\u2014 the maximum expected value of Johnny's winnings after the <span class=\"tex-span\"><i>k</i></span>-th update. Your answer will be considered correct if its absolute or relative error does not exceed <span class=\"tex-span\">10<sup class=\"upper-index\">\u2009-\u20096</sup></span>. </p><p>Namely: let's assume that your answer is <span class=\"tex-span\"><i>a</i></span>, and the answer of the jury is <span class=\"tex-span\"><i>b</i></span>. The checker program will consider your answer correct, if <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/c97ba2000ebfad962bff7ffd8d043594f5ae1086.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p>",
    "samples": [
        {
            "input": "2 1 3<br/>4 5<br/>1 2<br/>1 1<br/>1 2<br/>2 1<br/>",
            "output": "1.666666667<br/>1.333333333<br/>2.000000000<br/>"
        },
        {
            "input": "3 20 5<br/>6 8 10<br/>6 6 6<br/>1 1<br/>1 2<br/>1 3<br/>2 3<br/>2 3<br/>",
            "output": "12.000000000<br/>12.000000000<br/>11.769230769<br/>12.000000000<br/>12.000000000<br/>"
        }
    ],
    "note": "<p>In the first case, Johnny only has one ticket to distribute. The prizes are worth <span class=\"tex-span\">4</span> and <span class=\"tex-span\">5</span>, and the raffles initially have <span class=\"tex-span\">1</span> and <span class=\"tex-span\">2</span> tickets, respectively. After the first update, each raffle has <span class=\"tex-span\">2</span> tickets, so Johnny has expected value <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/436bcf2181eea8fe79cdb015a5567ca1b8d69652.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> of winning by placing his ticket into the second raffle. The second update adds a ticket to the second raffle, so Johnny can win <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/6ed6e0db65395a75b021f54fa4289733d0399cee.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> in the first raffle. After the final update, Johnny keeps his ticket in the first raffle and wins <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/83dfd107e988fb3278df4f4561bd77ba068cc202.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p><p>In the second case, Johnny has more tickets than he is allowed to spend. In particular, after the first update, there are <span class=\"tex-span\">7</span>, <span class=\"tex-span\">6</span>, and <span class=\"tex-span\">6</span> tickets in each raffle, respectively, so Johnny can only put in <span class=\"tex-span\">19</span> tickets, winning each prize with probability <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/eb946338365d9781f7d2e9ec692c26702d0ae3a7.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. Also, note that after the last two updates, Johnny must remove a ticket from the last raffle in order to stay under <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/eb946338365d9781f7d2e9ec692c26702d0ae3a7.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> the tickets in the third raffle.</p>",
    "contestId": 626,
    "index": "G",
    "name": "Raffles",
    "type": "PROGRAMMING",
    "tags": [
        "data structures",
        "dp",
        "greedy",
        "math"
    ],
    "solvedCount": 520
}