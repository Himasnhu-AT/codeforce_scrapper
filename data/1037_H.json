{
    "title": "H. Security",
    "timeLimit": {
        "value": 4.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>Some programming website is establishing a secure communication protocol. For security reasons, they want to choose several more or less random strings.</p><p>Initially, they have a string $$$s$$$ consisting of lowercase English letters. Now they want to choose $$$q$$$ strings using the following steps, and you are to help them.</p><ol> <li> A string $$$x$$$ consisting of lowercase English letters and integers $$$l$$$ and $$$r$$$ ($$$1 \\leq l \\leq r \\leq |s|$$$) are chosen. </li><li> Consider all non-empty distinct substrings of the $$$s_l s_{l + 1} \\ldots s_r$$$, that is all distinct strings $$$s_i s_{i+1} \\ldots s_{j}$$$ where $$$l \\le i \\le j \\le r$$$. Among all of them choose all strings that are lexicographically greater than $$$x$$$. </li><li> If there are no such strings, you should print $$$-1$$$. Otherwise print the lexicographically smallest among them. </li></ol><p>String $$$a$$$ is lexicographically less than string $$$b$$$, if either $$$a$$$ is a prefix of $$$b$$$ and $$$a \\ne b$$$, or there exists such a position $$$i$$$ ($$$1 \\le i \\le min(|a|, |b|)$$$), such that $$$a_i &lt; b_i$$$ and for all $$$j$$$ ($$$1 \\le j &lt; i$$$) $$$a_j = b_j$$$. Here $$$|a|$$$ denotes the length of the string $$$a$$$.</p>",
    "inputSpecification": "<p>The first line of input contains a non-empty string $$$s$$$ ($$$1 \\leq |s| \\leq 10^{5}$$$) consisting of lowercase English letters.</p><p>The second line contains an integer $$$q$$$ ($$$1 \\le q \\le 2 \\cdot 10^5$$$)\u00a0\u2014 the number of strings to select.</p><p>Each of the next $$$q$$$ lines contains two integers $$$l$$$, $$$r$$$ ($$$1 \\leq l \\leq r \\leq |s|$$$) and a non-empty string $$$x$$$ consisting of lowercase English letters. The total length of strings $$$x$$$ for all queries does not exceed $$$2 \\cdot 10^{5}$$$.</p>",
    "outputSpecification": "<p>Output $$$q$$$ lines, each of them should contain the desired string or $$$-1$$$, if there is no such string.</p>",
    "samples": [
        {
            "input": "baa<br/>5<br/>1 2 ba<br/>2 3 a<br/>1 2 b<br/>2 3 aa<br/>1 3 b<br/>",
            "output": "-1<br/>aa<br/>ba<br/>-1<br/>ba<br/>"
        },
        {
            "input": "bacb<br/>4<br/>1 2 ba<br/>2 3 ac<br/>1 3 ac<br/>3 4 c<br/>",
            "output": "-1<br/>c<br/>b<br/>cb<br/>"
        },
        {
            "input": "bba<br/>1<br/>1 1 b<br/>",
            "output": "-1<br/>"
        }
    ],
    "note": "<p>Consider the first example.</p><p>The string $$$s$$$ is \"<span class=\"tex-font-style-tt\">baa</span>\". The queries are as follows.</p><ol> <li> We consider the substring $$$s_1 s_2$$$ that is \"<span class=\"tex-font-style-tt\">ba</span>\". It has substrings \"<span class=\"tex-font-style-tt\">b</span>\", \"<span class=\"tex-font-style-tt\">a</span>\" and \"<span class=\"tex-font-style-tt\">ba</span>\", since none of them is greater than the query string \"<span class=\"tex-font-style-tt\">ba</span>\", the answer is $$$-1$$$.</li><li> We consider substring \"<span class=\"tex-font-style-tt\">aa</span>\". Among its substrings only \"<span class=\"tex-font-style-tt\">aa</span>\" is greater than the query string \"<span class=\"tex-font-style-tt\">a</span>\". So the answer is \"<span class=\"tex-font-style-tt\">aa</span>\".</li><li> We consider substring \"<span class=\"tex-font-style-tt\">ba</span>\". Out of \"<span class=\"tex-font-style-tt\">b</span>\", \"<span class=\"tex-font-style-tt\">a</span>\" and \"<span class=\"tex-font-style-tt\">ba</span>\" only \"<span class=\"tex-font-style-tt\">ba</span>\" is greater than the query string \"<span class=\"tex-font-style-tt\">b</span>\", so the answer is \"<span class=\"tex-font-style-tt\">ba</span>\".</li><li> We consider substring \"<span class=\"tex-font-style-tt\">aa</span>\". No substring of \"<span class=\"tex-font-style-tt\">aa</span>\" is greater than the query string \"<span class=\"tex-font-style-tt\">aa</span>\" so the answer is $$$-1$$$.</li><li> We consider substring \"<span class=\"tex-font-style-tt\">baa</span>\" and it has (among others) substrings \"<span class=\"tex-font-style-tt\">ba</span>\", \"<span class=\"tex-font-style-tt\">baa</span>\" which are greater than the query string \"<span class=\"tex-font-style-tt\">b</span>\". Since \"<span class=\"tex-font-style-tt\">ba</span>\" is lexicographically smaller than \"<span class=\"tex-font-style-tt\">baa</span>\", the answer is \"<span class=\"tex-font-style-tt\">ba</span>\". </li></ol>",
    "contestId": 1037,
    "index": "H",
    "name": "Security",
    "type": "PROGRAMMING",
    "tags": [
        "data structures",
        "string suffix structures"
    ],
    "solvedCount": 992
}