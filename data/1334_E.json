{
    "title": "E. Divisor Paths",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given a positive integer $$$D$$$. Let's build the following graph from it: </p><ul> <li> each vertex is a divisor of $$$D$$$ (not necessarily prime, $$$1$$$ and $$$D$$$ itself are also included); </li><li> two vertices $$$x$$$ and $$$y$$$ ($$$x &gt; y$$$) have an undirected edge between them if $$$x$$$ is divisible by $$$y$$$ and $$$\\frac x y$$$ is a prime; </li><li> the weight of an edge is the number of divisors of $$$x$$$ that are not divisors of $$$y$$$. </li></ul><p>For example, here is the graph for $$$D=12$$$: </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/9ce70289d27adde3575a5aa840a6cc7f1d3682bb.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>Edge $$$(4,12)$$$ has weight $$$3$$$ because $$$12$$$ has divisors $$$[1,2,3,4,6,12]$$$ and $$$4$$$ has divisors $$$[1,2,4]$$$. Thus, there are $$$3$$$ divisors of $$$12$$$ that are not divisors of $$$4$$$ \u2014 $$$[3,6,12]$$$.</p><p>There is no edge between $$$3$$$ and $$$2$$$ because $$$3$$$ is not divisible by $$$2$$$. There is no edge between $$$12$$$ and $$$3$$$ because $$$\\frac{12}{3}=4$$$ is not a prime.</p><p>Let the length of the path between some vertices $$$v$$$ and $$$u$$$ in the graph be the total weight of edges on it. For example, path $$$[(1, 2), (2, 6), (6, 12), (12, 4), (4, 2), (2, 6)]$$$ has length $$$1+2+2+3+1+2=11$$$. The empty path has length $$$0$$$.</p><p>So the shortest path between two vertices $$$v$$$ and $$$u$$$ is the path that has the minimal possible length.</p><p>Two paths $$$a$$$ and $$$b$$$ are different if there is either a different number of edges in them or there is a position $$$i$$$ such that $$$a_i$$$ and $$$b_i$$$ are different edges.</p><p>You are given $$$q$$$ queries of the following form: </p><ul> <li> $$$v$$$ $$$u$$$ \u2014 calculate the <span class=\"tex-font-style-bf\">number of the shortest paths</span> between vertices $$$v$$$ and $$$u$$$. </li></ul><p>The answer for each query might be large so print it modulo $$$998244353$$$.</p>",
    "inputSpecification": "<p>The first line contains a single integer $$$D$$$ ($$$1 \\le D \\le 10^{15}$$$) \u2014 the number the graph is built from.</p><p>The second line contains a single integer $$$q$$$ ($$$1 \\le q \\le 3 \\cdot 10^5$$$) \u2014 the number of queries.</p><p>Each of the next $$$q$$$ lines contains two integers $$$v$$$ and $$$u$$$ ($$$1 \\le v, u \\le D$$$). It is guaranteed that $$$D$$$ is divisible by both $$$v$$$ and $$$u$$$ (both $$$v$$$ and $$$u$$$ are divisors of $$$D$$$).</p>",
    "outputSpecification": "<p>Print $$$q$$$ integers \u2014 for each query output the <span class=\"tex-font-style-bf\">number of the shortest paths</span> between the two given vertices modulo $$$998244353$$$.</p>",
    "samples": [
        {
            "input": "\n12\n3\n4 4\n12 1\n3 4\n",
            "output": "\n1\n3\n1\n"
        },
        {
            "input": "\n1\n1\n1 1\n",
            "output": "\n1\n"
        },
        {
            "input": "\n288807105787200\n4\n46 482955026400\n12556830686400 897\n414 12556830686400\n4443186242880 325\n",
            "output": "\n547558588\n277147129\n457421435\n702277623\n"
        }
    ],
    "note": "<p>In the first example: </p><ul> <li> The first query is only the empty path \u2014 length $$$0$$$; </li><li> The second query are paths $$$[(12, 4), (4, 2), (2, 1)]$$$ (length $$$3+1+1=5$$$), $$$[(12, 6), (6, 2), (2, 1)]$$$ (length $$$2+2+1=5$$$) and $$$[(12, 6), (6, 3), (3, 1)]$$$ (length $$$2+2+1=5$$$). </li><li> The third query is only the path $$$[(3, 1), (1, 2), (2, 4)]$$$ (length $$$1+1+1=3$$$). </li></ul>",
    "contestId": 1334,
    "index": "E",
    "name": "Divisor Paths",
    "type": "PROGRAMMING",
    "tags": [
        "combinatorics",
        "graphs",
        "greedy",
        "math",
        "number theory"
    ],
    "solvedCount": 2649
}