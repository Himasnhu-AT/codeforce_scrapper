{
    "title": "G. Jellyfish and Inscryption",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 1024.0,
        "unit": "megabytes"
    },
    "statement": "<p>Jellyfish loves playing a game called \"Inscryption\" which is played on a directed acyclic graph with $$$n$$$ vertices and $$$m$$$ edges. All edges $$$a \\to b$$$ satisfy $$$a &lt; b$$$.</p><p>You need to move from vertex $$$1$$$ to vertex $$$n$$$ along the directed edges, and then fight with the final boss.</p><p>You will collect <span class=\"tex-font-style-bf\">cards</span> and <span class=\"tex-font-style-bf\">props</span> in the process.</p><p>Each <span class=\"tex-font-style-bf\">card</span> has two attributes: HP and damage. If a <span class=\"tex-font-style-bf\">card's</span> HP is $$$a$$$ and its damage is $$$b$$$, then the power of the <span class=\"tex-font-style-bf\">card</span> is $$$a \\times b$$$.</p><p>Each <span class=\"tex-font-style-bf\">prop</span> has only one attribute: power.</p><p>In addition to vertex $$$1$$$ and vertex $$$n$$$, there are some vertices that trigger special events. The special events are:</p><ol> <li> You will get a <span class=\"tex-font-style-bf\">card</span> with $$$a$$$ HP, and $$$b$$$ damage. </li><li> If you have at least one <span class=\"tex-font-style-bf\">card</span>, choose one of your <span class=\"tex-font-style-bf\">cards</span> and increase its HP by $$$x$$$. </li><li> If you have at least one <span class=\"tex-font-style-bf\">card</span>, choose one of your <span class=\"tex-font-style-bf\">cards</span> and increase its damage by $$$y$$$. </li><li> You will get a <span class=\"tex-font-style-bf\">prop</span> with $$$w$$$ power. </li></ol><p>When you get to vertex $$$n$$$, you can choose <span class=\"tex-font-style-bf\">at most one</span> of your <span class=\"tex-font-style-bf\">cards</span> and multiply its damage by $$$10^9$$$.</p><p>The final boss is very strong, so you want to maximize the sum of the power of all your <span class=\"tex-font-style-bf\">cards</span> and <span class=\"tex-font-style-bf\">props</span>. Find the maximum possible sum of power of all your <span class=\"tex-font-style-bf\">cards</span> and <span class=\"tex-font-style-bf\">props</span> if you play the game optimally.</p>",
    "inputSpecification": "<p>The first line contains two integers $$$n$$$ and $$$m$$$ ($$$2 \\leq n \\leq 200$$$, $$$n - 1\\leq m \\leq \\min(\\frac{n(n-1)}2, 2000)$$$)\u00a0\u2014 the number of the vertices and the number of the edges.</p><p>In the following $$$n$$$ lines, the $$$i$$$-th $$$(1 \\leq i \\leq n)$$$ line describes the special event that will trigger on vertex $$$i$$$:</p><ul> <li> <span class=\"tex-font-style-tt\">0</span>\u00a0\u2014 no special events. </li><li> <span class=\"tex-font-style-tt\">1 a b</span> ($$$1 \\leq a, b \\leq 200$$$)\u00a0\u2014 you will get a card with $$$a$$$ HP, and $$$b$$$ damage. </li><li> <span class=\"tex-font-style-tt\">2 x</span> ($$$1 \\leq x \\leq 200$$$)\u00a0\u2014 if you have at least one card, choose one of your cards and increase its HP by $$$x$$$. </li><li> <span class=\"tex-font-style-tt\">3 y</span> ($$$1 \\leq y \\leq 200$$$)\u00a0\u2014 if you have at least one card, choose one of your cards and increase its damage by $$$y$$$. </li><li> <span class=\"tex-font-style-tt\">4 w</span> ($$$1 \\leq w \\leq 10^6$$$)\u00a0\u2014 you will get a prop with $$$w$$$ power. </li></ul><p>In the following $$$m$$$ lines, each line contains two integers $$$u$$$ and $$$v$$$ ($$$1 \\leq u &lt; v \\leq n$$$) representing a directed edge from vertex $$$u$$$ to vertex $$$v$$$.</p><p>It is guaranteed that every edge $$$(u,v)$$$ appears at most once.</p><p>It is guaranteed that there are no special events on vertex $$$1$$$ and vertex $$$n$$$.</p><p>It is guaranteed that for all $$$i$$$, there exists a path from vertex $$$1$$$ to vertex $$$n$$$ that passes through vertex $$$i$$$.</p>",
    "outputSpecification": "<p>Output a single integer\u00a0\u2014 the maximum sum of the power of all your cards and props.</p>",
    "samples": [
        {
            "input": "\n6 8\n0\n1 2 10\n1 6 6\n2 8\n3 10\n0\n1 2\n1 3\n2 4\n2 5\n3 4\n3 5\n4 6\n5 6\n",
            "output": "\n100000000000"
        },
        {
            "input": "\n4 3\n0\n4 1000000\n4 1000000\n0\n1 2\n2 3\n3 4\n",
            "output": "\n2000000"
        },
        {
            "input": "\n16 15\n0\n1 1 10\n1 10 1\n2 4\n3 4\n1 20 20\n2 30\n3 20\n1 1 100\n2 9\n1 1 200\n2 9\n3 10\n1 190 100\n2 10\n0\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n9 10\n10 11\n11 12\n12 13\n13 14\n14 15\n15 16\n",
            "output": "\n20000000005600"
        },
        {
            "input": "\n9 9\n0\n1 1 200\n3 200\n3 200\n3 200\n3 200\n1 200 200\n3 200\n0\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n1 9\n",
            "output": "\n80000000001000"
        },
        {
            "input": "\n9 8\n0\n1 20 200\n3 200\n3 200\n2 5\n1 100 200\n3 200\n3 200\n0\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n7 8\n8 9\n",
            "output": "\n60000000015000"
        },
        {
            "input": "\n16 34\n0\n0\n0\n2 6\n3 1\n4 27\n4 40\n3 9\n0\n2 6\n1 8 1\n0\n2 2\n1 10 7\n2 9\n0\n2 4\n3 10\n2 11\n2 7\n13 15\n3 15\n2 3\n6 14\n4 12\n10 12\n9 10\n7 8\n4 13\n11 12\n4 6\n11 16\n14 15\n2 5\n5 15\n9 13\n8 14\n1 3\n2 15\n12 16\n7 10\n4 5\n1 2\n4 11\n4 9\n4 16\n3 6\n6 8\n7 11\n15 16\n",
            "output": "\n133000000040"
        }
    ],
    "note": "<p>In the first example, we will play the game in the following order:</p><ul> <li> move from vertex $$$1$$$ to vertex $$$2$$$, get a card with $$$2$$$ HP, and $$$10$$$ damage. </li><li> move from vertex $$$2$$$ to vertex $$$4$$$, choose the card we get from vertex $$$2$$$ and increase its HP by $$$8$$$. </li><li> move from vertex $$$4$$$ to vertex $$$6$$$, choose the card we get from vertex $$$2$$$ and multiply its damage by $$$10^9$$$. </li></ul><p>In the end, we will have a card with $$$(2+8)=10$$$ HP and $$$10 \\times 10^9=10^{10}$$$ damage, It's power is $$$10 \\times 10^{10}=10^{11}$$$. Because we only have the card we get from vertex $$$2$$$, so the sum of power of all your cards and props is $$$10^{11}$$$.</p>",
    "contestId": 1874,
    "index": "G",
    "name": "Jellyfish and Inscryption",
    "type": "PROGRAMMING",
    "tags": [
        "dp"
    ],
    "solvedCount": 75
}