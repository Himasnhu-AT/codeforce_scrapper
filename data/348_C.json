{
    "title": "C. Subset Sums",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given an array <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> and <span class=\"tex-span\"><i>m</i></span> sets <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\">1</sub>,\u2009<i>S</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>S</i><sub class=\"lower-index\"><i>m</i></sub></span> of indices of elements of this array. Let's denote <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\"><i>k</i></sub>\u2009=\u2009{<i>S</i><sub class=\"lower-index\"><i>k</i>,\u2009<i>i</i></sub>}\u00a0(1\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009|<i>S</i><sub class=\"lower-index\"><i>k</i></sub>|)</span>. In other words, <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\"><i>k</i>,\u2009<i>i</i></sub></span> is some element from set <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\"><i>k</i></sub></span>.</p><p>In this problem you have to answer <span class=\"tex-span\"><i>q</i></span> queries of the two types:</p><ol> <li> Find the sum of elements with indices from set <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\"><i>k</i></sub></span>: <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/6d0c103912105915deadec2dfbf3e852cfbce1fd.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. The query format is \"<span class=\"tex-font-style-tt\">? k</span>\". </li><li> Add number <span class=\"tex-span\"><i>x</i></span> to all elements at indices from set <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\"><i>k</i></sub></span>: <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>S</i><sub class=\"lower-index\"><i>k</i>,\u2009<i>i</i></sub></sub></span> is replaced by <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>S</i><sub class=\"lower-index\"><i>k</i>,\u2009<i>i</i></sub></sub>\u2009+\u2009<i>x</i></span> for all <span class=\"tex-span\"><i>i</i></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009|<i>S</i><sub class=\"lower-index\"><i>k</i></sub>|)</span>. The query format is \"<span class=\"tex-font-style-tt\">+ k x</span>\". </li></ol><p>After each first type query print the required sum.</p>",
    "inputSpecification": "<p>The first line contains integers <span class=\"tex-span\"><i>n</i>,\u2009<i>m</i>,\u2009<i>q</i></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>,\u2009<i>q</i>\u2009\u2264\u200910<sup class=\"upper-index\">5</sup>)</span>. The second line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> <span class=\"tex-span\">(|<i>a</i><sub class=\"lower-index\"><i>i</i></sub>|\u2009\u2264\u200910<sup class=\"upper-index\">8</sup>)</span> \u2014 elements of array <span class=\"tex-span\"><i>a</i></span>. </p><p>Each of the following <span class=\"tex-span\"><i>m</i></span> lines describes one set of indices. The <span class=\"tex-span\"><i>k</i></span>-th line first contains a positive integer, representing the number of elements in set (<span class=\"tex-span\">|<i>S</i><sub class=\"lower-index\"><i>k</i></sub>|</span>), then follow <span class=\"tex-span\">|<i>S</i><sub class=\"lower-index\"><i>k</i></sub>|</span> distinct integers <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\"><i>k</i>,\u20091</sub>,\u2009<i>S</i><sub class=\"lower-index\"><i>k</i>,\u20092</sub>,\u2009...,\u2009<i>S</i><sub class=\"lower-index\"><i>k</i>,\u2009|<i>S</i><sub class=\"lower-index\"><i>k</i></sub>|</sub></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>S</i><sub class=\"lower-index\"><i>k</i>,\u2009<i>i</i></sub>\u2009\u2264\u2009<i>n</i>)</span> \u2014 elements of set <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\"><i>k</i></sub></span>.</p><p>The next <span class=\"tex-span\"><i>q</i></span> lines contain queries. Each query looks like either \"<span class=\"tex-font-style-tt\">? k</span>\" or \"<span class=\"tex-font-style-tt\">+ k x</span>\" and sits on a single line. For all queries the following limits are held: <span class=\"tex-span\">1\u2009\u2264\u2009<i>k</i>\u2009\u2264\u2009<i>m</i></span>, <span class=\"tex-span\">|<i>x</i>|\u2009\u2264\u200910<sup class=\"upper-index\">8</sup></span>. The queries are given in order they need to be answered.</p><p>It is guaranteed that the sum of sizes of all sets <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\"><i>k</i></sub></span> doesn't exceed <span class=\"tex-span\">10<sup class=\"upper-index\">5</sup></span>.</p>",
    "outputSpecification": "<p>After each first type query print the required sum on a single line.</p><p>Please, do not write the <span class=\"tex-font-style-tt\">%lld</span> specifier to read or write 64-bit integers in \u0421++. It is preferred to use the <span class=\"tex-font-style-tt\">cin</span>, <span class=\"tex-font-style-tt\">cout</span> streams or the <span class=\"tex-font-style-tt\">%I64d</span> specifier.</p>",
    "samples": [
        {
            "input": "5 3 5<br/>5 -5 5 1 -4<br/>2 1 2<br/>4 2 1 4 5<br/>2 2 5<br/>? 2<br/>+ 3 4<br/>? 1<br/>+ 2 1<br/>? 2<br/>",
            "output": "-3<br/>4<br/>9<br/>"
        }
    ],
    "note": null,
    "contestId": 348,
    "index": "C",
    "name": "Subset Sums",
    "type": "PROGRAMMING",
    "tags": [
        "brute force",
        "data structures"
    ],
    "solvedCount": 2110
}