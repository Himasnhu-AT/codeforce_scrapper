{
    "title": "E. Nearly Shortest Repeating Substring",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given a string $$$s$$$ of length $$$n$$$ consisting of lowercase Latin characters. Find the length of the shortest string $$$k$$$ such that several (possibly one) copies of $$$k$$$ can be concatenated together to form a string with the same length as $$$s$$$ and, at most, one different character.</p><p>More formally, find the length of the shortest string $$$k$$$ such that $$$c = \\underbrace{k + \\cdots + k}_{x\\rm\\ \\text{times}}$$$ for some <span class=\"tex-font-style-it\">positive integer</span> $$$x$$$, strings $$$s$$$ and $$$c$$$ has the same length and $$$c_i \\neq s_i$$$ for at most one $$$i$$$ (i.e. there exist $$$0$$$ or $$$1$$$ such positions).</p>",
    "inputSpecification": "<p>The first line contains a single integer $$$t$$$ ($$$1 \\leq t \\leq 10^3$$$)\u00a0\u2014 the number of test cases.</p><p>The first line of each test case contains a single integer $$$n$$$ ($$$1 \\leq n \\leq 2\\cdot10^5$$$)\u00a0\u2014 the length of string $$$s$$$.</p><p>The second line of each test case contains the string $$$s$$$, consisting of lowercase Latin characters.</p><p>The sum of $$$n$$$ over all test cases does not exceed $$$2\\cdot10^5$$$.</p>",
    "outputSpecification": "<p>For each test case, print the length of the shortest string $$$k$$$ satisfying the constraints in the statement.</p>",
    "samples": [
        {
            "input": "\n<div class=\"test-example-line test-example-line-even test-example-line-0\">5</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">4</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">abaa</div><div class=\"test-example-line test-example-line-even test-example-line-2\">4</div><div class=\"test-example-line test-example-line-even test-example-line-2\">abba</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">13</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">slavicgslavic</div><div class=\"test-example-line test-example-line-even test-example-line-4\">8</div><div class=\"test-example-line test-example-line-even test-example-line-4\">hshahaha</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">20</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">stormflamestornflame</div>",
            "output": "\n1\n4\n13\n2\n10\n"
        }
    ],
    "note": "<p>In the first test case, you can select $$$k = \\texttt{a}$$$ and $$$k+k+k+k = \\texttt{aaaa}$$$, which only differs from $$$s$$$ in the second position.</p><p>In the second test case, you cannot select $$$k$$$ of length one or two. We can have $$$k = \\texttt{abba}$$$, which is equal to $$$s$$$.</p>",
    "contestId": 1950,
    "index": "E",
    "name": "Nearly Shortest Repeating Substring",
    "type": "PROGRAMMING",
    "tags": [
        "brute force",
        "implementation",
        "number theory",
        "strings"
    ],
    "solvedCount": 12740
}