{
    "title": "F. New Year Shopping",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Dohyun is running a grocery store. He sells <span class=\"tex-span\"><i>n</i></span> items numbered by integers from 1 to <span class=\"tex-span\"><i>n</i></span>. The <span class=\"tex-span\"><i>i</i></span>-th (<span class=\"tex-span\">1\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009<i>n</i></span>) of them costs <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> dollars, and if I buy it, my happiness increases by <span class=\"tex-span\"><i>h</i><sub class=\"lower-index\"><i>i</i></sub></span>. Each item can be displayed only for <span class=\"tex-span\"><i>p</i></span> units of time because of freshness. As Dohyun displays the <span class=\"tex-span\"><i>i</i></span>-th item at time <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>i</i></sub></span>, the customers can buy the <span class=\"tex-span\"><i>i</i></span>-th item only from time <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>i</i></sub></span> to time <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>i</i></sub>\u2009+\u2009(<i>p</i>\u2009-\u20091)</span> inclusively. Also, each customer cannot buy the same item more than once.</p><p>I'd like to visit Dohyun's grocery store and buy some items for the New Year Party, and maximize my happiness. Because I am a really busy person, I can visit the store only once, and for very short period of time. In other words, if I visit the store at time <span class=\"tex-span\"><i>t</i></span>, I can only buy the items available at time <span class=\"tex-span\"><i>t</i></span>. But I can buy as many items as possible, if the budget holds. I can't buy same item several times due to store rules. It is not necessary to use the whole budget.</p><p>I made a list of <span class=\"tex-span\"><i>q</i></span> pairs of integers <span class=\"tex-span\">(<i>a</i><sub class=\"lower-index\"><i>j</i></sub>,\u2009<i>b</i><sub class=\"lower-index\"><i>j</i></sub>)</span>, which means I may visit the store at time <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>j</i></sub></span>, and spend at most <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>j</i></sub></span> dollars at the store. For each pair, I'd like to know the maximum happiness I can obtain. But there are so many pairs that I can't handle them. Can you help me?</p>",
    "inputSpecification": "<p>The first line contains two space-separated integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>p</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>\u2009\u2264\u20094000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>p</i>\u2009\u2264\u200910\u2009000</span>) \u2014 the number of items, and the display time of each item.</p><p>Next <span class=\"tex-span\"><i>n</i></span> lines describe the items. The <span class=\"tex-span\"><i>i</i></span>-th (<span class=\"tex-span\">1\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009<i>n</i></span>) of them contains three space-separated integers <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span>, <span class=\"tex-span\"><i>h</i><sub class=\"lower-index\"><i>i</i></sub></span>, <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>h</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u20094000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>t</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u200910\u2009000</span>) \u2014 the cost of the <span class=\"tex-span\"><i>i</i></span>-th item, the happiness of the <span class=\"tex-span\"><i>i</i></span>-th item, and the time when the <span class=\"tex-span\"><i>i</i></span>-th item starts to be displayed.</p><p>The next line contains an integer <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u200920\u2009000</span>)\u2014 the number of candidates.</p><p>Next <span class=\"tex-span\"><i>q</i></span> lines describe the candidates. The <span class=\"tex-span\"><i>j</i></span>-th (<span class=\"tex-span\">1\u2009\u2264\u2009<i>j</i>\u2009\u2264\u2009<i>q</i></span>) of them contains two space-separated integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>j</i></sub></span>, <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>j</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>j</i></sub>\u2009\u2264\u200920\u2009000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>b</i><sub class=\"lower-index\"><i>j</i></sub>\u2009\u2264\u20094000</span>) \u2014 the visit time and the budget for <span class=\"tex-span\"><i>j</i></span>-th visit of store.</p>",
    "outputSpecification": "<p>For each candidate, print a single line containing the maximum happiness that I can obtain by buying some items.</p>",
    "samples": [
        {
            "input": "4 4<br/>2 3 2<br/>3 5 1<br/>4 7 2<br/>11 15 5<br/>4<br/>1 3<br/>2 5<br/>2 6<br/>5 14<br/>",
            "output": "5<br/>8<br/>10<br/>18<br/>"
        },
        {
            "input": "5 4<br/>3 2 1<br/>7 4 4<br/>2 1 2<br/>6 3 5<br/>3 2 2<br/>10<br/>1 5<br/>2 5<br/>4 8<br/>4 9<br/>4 10<br/>5 8<br/>5 9<br/>5 10<br/>8 4<br/>7 9<br/>",
            "output": "2<br/>3<br/>5<br/>5<br/>6<br/>4<br/>5<br/>6<br/>0<br/>4<br/>"
        }
    ],
    "note": "<p>Consider the first sample. </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/39bdeb26c275404cda44d2f49cbae69087f38eae.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><ol> <li> At time 1, only the 2nd item is available. I can buy the 2nd item using 3 dollars and my happiness will increase by 5. </li><li> At time 2, the 1st, 2nd, and 3rd item is available. I can buy the 1st item using 2 dollars, and the 2nd item using 3 dollars. My happiness will increase by 3 + 5 = 8. </li><li> At time 2, the 1st, 2nd, and 3rd item is available. I can buy the 1st item using 2 dollars, and the 3nd item using 4 dollars. My happiness will increase by 3 + 7 = 10. </li><li> At time 5, the 1st, 3rd, and 4th item is available. I can buy the 1st item using 2 dollars, and the 4th item using 11 dollars. My happiness will increase by 3 + 15 = 18. Note that I don't need to use the whole budget in this case. </li></ol>",
    "contestId": 500,
    "index": "F",
    "name": "New Year Shopping",
    "type": "PROGRAMMING",
    "tags": [
        "divide and conquer",
        "dp"
    ],
    "solvedCount": 702
}