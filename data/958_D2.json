{
    "title": "D2. Hyperspace Jump (hard)",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>It is now 125 years later, but humanity is still on the run from a humanoid-cyborg race determined to destroy it. Or perhaps we are getting some stories mixed up here... In any case, the fleet is now smaller. However, in a recent upgrade, all the navigation systems have been outfitted with higher-dimensional, linear-algebraic jump processors.</p><p>Now, in order to make a jump, a ship's captain needs to specify a <span class=\"tex-font-style-it\">subspace</span> of the <span class=\"tex-span\"><i>d</i></span>-dimensional space in which the events are taking place. She does so by providing a generating set of vectors for that subspace.</p><p>Princess Heidi has received such a set from the captain of each of <span class=\"tex-span\"><i>m</i></span> ships. Again, she would like to group up those ships whose hyperspace jump subspaces are equal. To do so, she wants to assign a group number between <span class=\"tex-span\">1</span> and <span class=\"tex-span\"><i>m</i></span> to each of the ships, so that two ships have the same group number if and only if their corresponding subspaces are equal (even though they might be given using different sets of vectors).</p><p>Help Heidi!</p>",
    "inputSpecification": "<p>The first line of the input contains two space-separated integers <span class=\"tex-span\"><i>m</i></span> and <span class=\"tex-span\"><i>d</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>m</i>\u2009\u2264\u200930\u2009000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>d</i>\u2009\u2264\u20095</span>) \u2013 the number of ships and the dimension of the full underlying vector space, respectively. Next, the <span class=\"tex-span\"><i>m</i></span> subspaces are described, one after another. The <span class=\"tex-span\"><i>i</i></span>-th subspace, which corresponds to the <span class=\"tex-span\"><i>i</i></span>-th ship, is described as follows:</p><p>The first line contains one integer <span class=\"tex-span\"><i>k</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>k</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>d</i></span>). Then <span class=\"tex-span\"><i>k</i><sub class=\"lower-index\"><i>i</i></sub></span> lines follow, the <span class=\"tex-span\"><i>j</i></span>-th of them describing the <span class=\"tex-span\"><i>j</i></span>-th vector sent by the <span class=\"tex-span\"><i>i</i></span>-th ship. Each of the <span class=\"tex-span\"><i>j</i></span> lines consists of <span class=\"tex-span\"><i>d</i></span> space-separated integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>j</i></sub></span>, <span class=\"tex-span\"><i>j</i>\u2009=\u20091,\u2009...,\u2009<i>d</i></span>, that describe the vector <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/ab929a3e14032f5003e6f023f92be72813548b37.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>; it holds that <span class=\"tex-span\">|<i>a</i><sub class=\"lower-index\"><i>j</i></sub>|\u2009\u2264\u2009250</span>. The <span class=\"tex-span\"><i>i</i></span>-th subspace is the linear span of these <span class=\"tex-span\"><i>k</i><sub class=\"lower-index\"><i>i</i></sub></span> vectors.</p>",
    "outputSpecification": "<p>Output <span class=\"tex-span\"><i>m</i></span> space-separated integers <span class=\"tex-span\"><i>g</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>g</i><sub class=\"lower-index\"><i>m</i></sub></span>, where <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/3eb37f80bcb83d8830fb0aa4d1327b5783fc2ff8.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> denotes the group number assigned to the <span class=\"tex-span\"><i>i</i></span>-th ship. That is, for any <span class=\"tex-span\">1\u2009\u2264\u2009<i>i</i>\u2009&lt;\u2009<i>j</i>\u2009\u2264\u2009<i>m</i></span>, the following should hold: <span class=\"tex-span\"><i>g</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u2009<i>g</i><sub class=\"lower-index\"><i>j</i></sub></span> if and only if the <span class=\"tex-span\"><i>i</i></span>-th and the <span class=\"tex-span\"><i>j</i></span>-th subspaces are equal. In addition, the sequence <span class=\"tex-span\">(<i>g</i><sub class=\"lower-index\">1</sub>,\u2009<i>g</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>g</i><sub class=\"lower-index\"><i>m</i></sub>)</span> should be lexicographically minimal among all sequences with that property.</p>",
    "samples": [
        {
            "input": "8 2<br/>1<br/>5 0<br/>1<br/>0 1<br/>1<br/>0 1<br/>2<br/>0 6<br/>0 1<br/>2<br/>0 1<br/>1 0<br/>2<br/>-5 -5<br/>4 3<br/>2<br/>1 1<br/>0 1<br/>2<br/>1 0<br/>1 0<br/>",
            "output": "1 2 2 2 3 3 3 1 "
        }
    ],
    "note": "<p>In the sample testcase, the first and the last subspace are equal, subspaces 2 to 4 are equal, and subspaces 5 to 7 are equal.</p><p>Recall that two subspaces, one given as the span of vectors <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/e8dc56705315ce4b334dd46dbc9c8c51fffb0036.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> and another given as the span of vectors <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/99fd3b5233ff3b6f4989df43e2f60edb184bee11.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, are equal if each vector <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> can be written as a linear combination of vectors <span class=\"tex-span\"><i>w</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>w</i><sub class=\"lower-index\"><i>k</i></sub></span> (that is, there exist coefficients <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/ae69b90a53c26d24b0b4a40a6970f6d5903cd568.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> such that <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u2009\u03b1<sub class=\"lower-index\">1</sub><i>w</i><sub class=\"lower-index\">1</sub>\u2009+\u2009...\u2009+\u2009\u03b1<sub class=\"lower-index\"><i>k</i></sub><i>w</i><sub class=\"lower-index\"><i>k</i></sub></span>) and, similarly, each vector <span class=\"tex-span\"><i>w</i><sub class=\"lower-index\"><i>i</i></sub></span> can be written as a linear combination of vectors <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>v</i><sub class=\"lower-index\"><i>n</i></sub></span>.</p><p>Recall that a sequence <span class=\"tex-span\">(<i>g</i><sub class=\"lower-index\">1</sub>,\u2009<i>g</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>g</i><sub class=\"lower-index\"><i>m</i></sub>)</span> is lexicographically smaller than a sequence <span class=\"tex-span\">(<i>h</i><sub class=\"lower-index\">1</sub>,\u2009<i>h</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>h</i><sub class=\"lower-index\"><i>m</i></sub>)</span> if there exists an index <span class=\"tex-span\"><i>i</i></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009<i>m</i></span>, such that <span class=\"tex-span\"><i>g</i><sub class=\"lower-index\"><i>i</i></sub>\u2009&lt;\u2009<i>h</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>g</i><sub class=\"lower-index\"><i>j</i></sub>\u2009=\u2009<i>h</i><sub class=\"lower-index\"><i>j</i></sub></span> for all <span class=\"tex-span\"><i>j</i>\u2009&lt;\u2009<i>i</i></span>.</p>",
    "contestId": 958,
    "index": "D2",
    "name": "Hyperspace Jump (hard)",
    "type": "PROGRAMMING",
    "tags": [],
    "solvedCount": 86
}