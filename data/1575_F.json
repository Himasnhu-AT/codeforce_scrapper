{
    "title": "F. Finding Expected Value",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>Mr. Chanek opened a letter from his fellow, who is currently studying at Singanesia. Here is what it says.</p><p>Define an array $$$b$$$ ($$$0 \\leq b_i &lt; k$$$) with $$$n$$$ integers. While there exists a pair $$$(i, j)$$$ such that $$$b_i \\ne b_j$$$, do the following operation:</p><ul> <li> Randomly pick a number $$$i$$$ satisfying $$$0 \\leq i &lt; n$$$. Note that each number $$$i$$$ has a probability of $$$\\frac{1}{n}$$$ to be picked. </li><li> Randomly Pick a number $$$j$$$ satisfying $$$0 \\leq j &lt; k$$$. </li><li> Change the value of $$$b_i$$$ to $$$j$$$. It is possible for $$$b_i$$$ to be changed to the same value. </li></ul><p>Denote $$$f(b)$$$ as the expected number of operations done to $$$b$$$ until all elements of $$$b$$$ are equal. </p><p>You are given two integers $$$n$$$ and $$$k$$$, and an array $$$a$$$ ($$$-1 \\leq a_i &lt; k$$$) of $$$n$$$ integers. </p><p>For every index $$$i$$$ with $$$a_i = -1$$$, replace $$$a_i$$$ with a random number $$$j$$$ satisfying $$$0 \\leq j &lt; k$$$. Let $$$c$$$ be the number of occurrences of $$$-1$$$ in $$$a$$$. There are $$$k^c$$$ possibilites of $$$a$$$ after the replacement, each with equal probability of being the final array.</p><p>Find the expected value of $$$f(a)$$$ modulo $$$10^9 + 7$$$. </p><p>Formally, let $$$M = 10^9 + 7$$$. It can be shown that the answer can be expressed as an irreducible fraction $$$\\frac{p}{q}$$$, where $$$p$$$ and $$$q$$$ are integers and $$$q \\not \\equiv 0 \\pmod{M}$$$. Output the integer equal to $$$p \\cdot q^{-1} \\bmod M$$$. In other words, output such an integer $$$x$$$ that $$$0 \\le x &lt; M$$$ and $$$x \\cdot q \\equiv p \\pmod{M}$$$.</p><p>After reading the letter, Mr. Chanek gave the task to you. Solve it for the sake of their friendship!</p>",
    "inputSpecification": "<p>The first line contains two integers $$$n$$$ and $$$k$$$ ($$$2 \\leq n \\leq 10^5$$$, $$$2 \\leq k \\leq 10^9$$$). </p><p>The second line contains $$$n$$$ integers $$$a_1, a_2, \\ldots, a_n$$$ ($$$-1 \\leq a_i &lt; k$$$).</p>",
    "outputSpecification": "<p>Output an integer denoting the expected value of $$$f(a)$$$ modulo $$$10^9 + 7$$$.</p>",
    "samples": [
        {
            "input": "\n2 2\n0 1\n",
            "output": "\n2\n"
        },
        {
            "input": "\n2 2\n0 -1\n",
            "output": "\n1\n"
        },
        {
            "input": "\n3 3\n0 1 1\n",
            "output": "\n12\n"
        },
        {
            "input": "\n3 3\n-1 -1 -1\n",
            "output": "\n11\n"
        },
        {
            "input": "\n10 9\n-1 0 -1 1 1 2 2 3 3 3\n",
            "output": "\n652419213\n"
        }
    ],
    "note": null,
    "contestId": 1575,
    "index": "F",
    "name": "Finding Expected Value",
    "type": "PROGRAMMING",
    "tags": [
        "math"
    ],
    "solvedCount": 110
}