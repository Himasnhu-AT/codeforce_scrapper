{
    "title": "D. Little Elephant and Retro Strings",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>The Little Elephant has found a ragged old black-and-white string <span class=\"tex-span\"><i>s</i></span> on the attic.</p><p>The characters of string <span class=\"tex-span\"><i>s</i></span> are numbered from the left to the right from <span class=\"tex-span\">1</span> to <span class=\"tex-span\">|<i>s</i>|</span>, where <span class=\"tex-span\">|<i>s</i>|</span> is the length of the string. Let's denote the <span class=\"tex-span\"><i>i</i></span>-th character of string <span class=\"tex-span\"><i>s</i></span> as <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>i</i></sub></span>. As the string is black-and-white, each character of the string is either letter \"<span class=\"tex-font-style-tt\">B</span>\", or letter \"<span class=\"tex-font-style-tt\">W</span>\". Unfortunately, the string is very old and some characters are damaged. The damaged positions are denoted as \"<span class=\"tex-font-style-tt\">X</span>\".</p><p>The Little Elephant in determined to restore the string and hang it on the wall. For that he needs to replace each character \"<span class=\"tex-font-style-tt\">X</span>\" by a \"<span class=\"tex-font-style-tt\">B</span>\" or a \"<span class=\"tex-font-style-tt\">W</span>\". The string must look good on the wall, so it must be <span class=\"tex-font-style-underline\">beautiful</span>. The Little Elephant considers a string beautiful if it has two non-intersecting substrings of a given length <span class=\"tex-span\"><i>k</i></span>, such that the left one fully consists of characters \"<span class=\"tex-font-style-tt\">B</span>\", and the right one fully consists of characters \"<span class=\"tex-font-style-tt\">W</span>\". More formally, there are four integers <span class=\"tex-span\"><i>a</i>,\u2009<i>b</i>,\u2009<i>c</i>,\u2009<i>d</i></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>a</i>\u2009\u2264\u2009<i>b</i>\u2009&lt;\u2009<i>c</i>\u2009\u2264\u2009<i>d</i>\u2009\u2264\u2009|<i>s</i>|;\u00a0<i>b</i>\u2009-\u2009<i>a</i>\u2009+\u20091\u2009=\u2009<i>d</i>\u2009-\u2009<i>c</i>\u2009+\u20091\u2009=\u2009<i>k</i>)</span> such that <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>i</i></sub></span> = \"<span class=\"tex-font-style-tt\">B</span>\" <span class=\"tex-span\">(<i>a</i>\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009<i>b</i>)</span> and <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> = \"<span class=\"tex-font-style-tt\">W</span>\" <span class=\"tex-span\">(<i>c</i>\u2009\u2264\u2009<i>j</i>\u2009\u2264\u2009<i>d</i>)</span>. </p><p>Help the Little Elephant find the number of different beautiful strings he can obtain from string <span class=\"tex-span\"><i>s</i></span>. Two strings are considered different if there is such position, where the character in the first string differs from the corresponding character in the second string. If this string doesn't contain characters \u00ab<span class=\"tex-font-style-tt\">X</span>\u00bb and it is already beautiful \u2014 the answer is <span class=\"tex-font-style-tt\">1</span>.</p><p>As the answer can be rather large, print it modulo <span class=\"tex-span\">1000000007</span> <span class=\"tex-span\">(10<sup class=\"upper-index\">9</sup>\u2009+\u20097)</span>.</p>",
    "inputSpecification": "<p>The first line contains two space-separated integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>k</i></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>k</i>\u2009\u2264\u2009<i>n</i>\u2009\u2264\u200910<sup class=\"upper-index\">6</sup>)</span>. The second line contains string <span class=\"tex-span\"><i>s</i></span>. String <span class=\"tex-span\"><i>s</i></span> has length <span class=\"tex-span\"><i>n</i></span> and only consists of characters \"<span class=\"tex-font-style-tt\">W</span>\", \"<span class=\"tex-font-style-tt\">B</span>\" and \"<span class=\"tex-font-style-tt\">X</span>\".</p>",
    "outputSpecification": "<p>On a single line print an integer \u2014 the answer to the problem modulo <span class=\"tex-span\">1000000007</span> <span class=\"tex-span\">(10<sup class=\"upper-index\">9</sup>\u2009+\u20097)</span>.</p>",
    "samples": [
        {
            "input": "3 2<br/>XXX<br/>",
            "output": "0<br/>"
        },
        {
            "input": "4 2<br/>XXXX<br/>",
            "output": "1<br/>"
        },
        {
            "input": "10 2<br/>XXBXXWXXXX<br/>",
            "output": "166<br/>"
        }
    ],
    "note": null,
    "contestId": 204,
    "index": "D",
    "name": "Little Elephant and Retro Strings",
    "type": "PROGRAMMING",
    "tags": [
        "dp"
    ],
    "solvedCount": 398
}