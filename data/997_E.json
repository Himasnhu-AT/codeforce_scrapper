{
    "title": "E. Good Subsegments",
    "timeLimit": {
        "value": 7.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>A permutation $$$p$$$ of length $$$n$$$ is a sequence $$$p_1, p_2, \\ldots, p_n$$$ consisting of $$$n$$$ distinct integers, each of which from $$$1$$$ to $$$n$$$ ($$$1 \\leq p_i \\leq n$$$) .</p><p>Let's call the subsegment $$$[l,r]$$$ of the permutation <span class=\"tex-font-style-bf\">good</span> if all numbers from the minimum on it to the maximum on this subsegment occur among the numbers $$$p_l, p_{l+1}, \\dots, p_r$$$.</p><p>For example, good segments of permutation $$$[1, 3, 2, 5, 4]$$$ are:</p><ul> <li> $$$[1, 1]$$$, </li><li> $$$[1, 3]$$$, </li><li> $$$[1, 5]$$$, </li><li> $$$[2, 2]$$$, </li><li> $$$[2, 3]$$$, </li><li> $$$[2, 5]$$$, </li><li> $$$[3, 3]$$$, </li><li> $$$[4, 4]$$$, </li><li> $$$[4, 5]$$$, </li><li> $$$[5, 5]$$$. </li></ul><p>You are given a permutation $$$p_1, p_2, \\ldots, p_n$$$.</p><p>You need to answer $$$q$$$ queries of the form: find the number of good subsegments of the given segment of permutation.</p><p>In other words, to answer one query, you need to calculate the number of good subsegments $$$[x \\dots y]$$$ for some given segment $$$[l \\dots r]$$$, such that $$$l \\leq x \\leq y \\leq r$$$.</p>",
    "inputSpecification": "<p>The first line contains a single integer $$$n$$$ ($$$1 \\leq n \\leq 120000$$$)\u00a0\u2014 the number of elements in the permutation.</p><p>The second line contains $$$n$$$ distinct integers $$$p_1, p_2, \\ldots, p_n$$$ separated by spaces ($$$1 \\leq p_i \\leq n$$$).</p><p>The third line contains an integer $$$q$$$ ($$$1 \\leq q \\leq 120000$$$)\u00a0\u2014 number of queries.</p><p>The following $$$q$$$ lines describe queries, each line contains a pair of integers $$$l$$$, $$$r$$$ separated by space ($$$1 \\leq l \\leq r \\leq n$$$).</p>",
    "outputSpecification": "<p>Print a $$$q$$$ lines, $$$i$$$-th of them should contain a number of good subsegments of a segment, given in the $$$i$$$-th query.</p>",
    "samples": [
        {
            "input": "5<br/>1 3 2 5 4<br/>15<br/>1 1<br/>1 2<br/>1 3<br/>1 4<br/>1 5<br/>2 2<br/>2 3<br/>2 4<br/>2 5<br/>3 3<br/>3 4<br/>3 5<br/>4 4<br/>4 5<br/>5 5<br/>",
            "output": "1<br/>2<br/>5<br/>6<br/>10<br/>1<br/>3<br/>4<br/>7<br/>1<br/>2<br/>4<br/>1<br/>3<br/>1<br/>"
        }
    ],
    "note": null,
    "contestId": 997,
    "index": "E",
    "name": "Good Subsegments",
    "type": "PROGRAMMING",
    "tags": [
        "data structures"
    ],
    "solvedCount": 1097
}