{
    "title": "F. Tree Coloring",
    "timeLimit": {
        "value": 4.5,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given a rooted tree consisting of $$$n$$$ vertices numbered from $$$1$$$ to $$$n$$$. The root of the tree is the vertex $$$1$$$.</p><p>You have to color all vertices of the tree into $$$n$$$ colors (also numbered from $$$1$$$ to $$$n$$$) so that there is exactly one vertex for each color. Let $$$c_i$$$ be the color of vertex $$$i$$$, and $$$p_i$$$ be the parent of vertex $$$i$$$ in the rooted tree. The coloring is considered beautiful if there is no vertex $$$k$$$ ($$$k &gt; 1$$$) such that $$$c_k = c_{p_k} - 1$$$, i.\u2009e. no vertex such that its color is less than the color of its parent by <span class=\"tex-font-style-bf\">exactly $$$1$$$</span>.</p><p>Calculate the number of beautiful colorings, and print it modulo $$$998244353$$$.</p>",
    "inputSpecification": "<p>The first line contains one integer $$$n$$$ ($$$2 \\le n \\le 250000$$$) \u2014 the number of vertices in the tree.</p><p>Then $$$n-1$$$ lines follow, the $$$i$$$-th line contains two integers $$$x_i$$$ and $$$y_i$$$ ($$$1 \\le x_i, y_i \\le n$$$; $$$x_i \\ne y_i$$$) denoting an edge between the vertex $$$x_i$$$ and the vertex $$$y_i$$$. These edges form a tree.</p>",
    "outputSpecification": "<p>Print one integer \u2014 the number of beautiful colorings, taken modulo $$$998244353$$$.</p>",
    "samples": [
        {
            "input": "\n5\n1 2\n3 2\n4 2\n2 5\n",
            "output": "\n42\n"
        },
        {
            "input": "\n5\n1 2\n2 3\n3 4\n4 5\n",
            "output": "\n53\n"
        },
        {
            "input": "\n20\n20 19\n20 4\n12 4\n5 8\n1 2\n20 7\n3 10\n7 18\n11 8\n9 10\n17 10\n1 15\n11 16\n14 11\n18 10\n10 1\n14 2\n13 17\n20 6\n",
            "output": "\n955085064\n"
        }
    ],
    "note": null,
    "contestId": 1613,
    "index": "F",
    "name": "Tree Coloring",
    "type": "PROGRAMMING",
    "tags": [
        "combinatorics",
        "divide and conquer",
        "fft"
    ],
    "solvedCount": 670
}