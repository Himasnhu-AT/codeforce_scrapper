{
    "title": "G. Can Bash Save the Day?",
    "timeLimit": {
        "value": 5.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 768.0,
        "unit": "megabytes"
    },
    "statement": "<p>Whoa! You did a great job helping Team Rocket who managed to capture all the Pokemons sent by Bash. Meowth, part of Team Rocket, having already mastered the human language, now wants to become a master in programming as well. He agrees to free the Pokemons if Bash can answer his questions.</p><p>Initially, Meowth gives Bash a weighted tree containing <span class=\"tex-span\"><i>n</i></span> nodes and a sequence <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> which is a permutation of <span class=\"tex-span\">1,\u20092,\u2009...,\u2009<i>n</i></span>. Now, Mewoth makes <span class=\"tex-span\"><i>q</i></span> queries of one of the following forms:</p><ul> <li> <span class=\"tex-font-style-tt\">1 l r v</span>: meaning Bash should report <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/816a5c5f7673f6efda3e7eb855b33f1cd0660d88.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, where <span class=\"tex-span\"><i>dist</i>(<i>a</i>,\u2009<i>b</i>)</span> is the length of the shortest path from node <span class=\"tex-span\"><i>a</i></span> to node <span class=\"tex-span\"><i>b</i></span> in the given tree.  </li><li> <span class=\"tex-font-style-tt\">2 x</span>: meaning Bash should swap <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>x</i></sub></span> and <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>x</i>\u2009+\u20091</sub></span> in the given sequence. This new sequence is used for later queries. </li></ul><p>Help Bash to answer the questions!</p>",
    "inputSpecification": "<p>The first line contains two integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>\u2009\u2264\u20092\u00b710<sup class=\"upper-index\">5</sup></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u20092\u00b710<sup class=\"upper-index\">5</sup></span>)\u00a0\u2014 the number of nodes in the tree and the number of queries, respectively.</p><p>The next line contains <span class=\"tex-span\"><i>n</i></span> space-separated integers\u00a0\u2014 the sequence <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> which is a permutation of <span class=\"tex-span\">1,\u20092,\u2009...,\u2009<i>n</i></span>.</p><p>Each of the next <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> lines contain three space-separated integers <span class=\"tex-span\"><i>u</i></span>, <span class=\"tex-span\"><i>v</i></span>, and <span class=\"tex-span\"><i>w</i></span> denoting that there exists an undirected edge between node <span class=\"tex-span\"><i>u</i></span> and node <span class=\"tex-span\"><i>v</i></span> of weight <span class=\"tex-span\"><i>w</i></span>, (<span class=\"tex-span\">1\u2009\u2264\u2009<i>u</i>,\u2009<i>v</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\"><i>u</i>\u2009\u2260\u2009<i>v</i></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>w</i>\u2009\u2264\u200910<sup class=\"upper-index\">6</sup></span>). It is guaranteed that the given graph is a tree.</p><p>Each query consists of two lines. First line contains single integer <span class=\"tex-span\"><i>t</i></span>, indicating the type of the query. Next line contains the description of the query: </p><ul> <li> <span class=\"tex-font-style-bf\">t = 1</span>: Second line contains three integers <span class=\"tex-span\"><i>a</i></span>, <span class=\"tex-span\"><i>b</i></span> and <span class=\"tex-span\"><i>c</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i>,\u2009<i>b</i>,\u2009<i>c</i>\u2009&lt;\u20092<sup class=\"upper-index\">30</sup></span>) using which <span class=\"tex-span\"><i>l</i></span>, <span class=\"tex-span\"><i>r</i></span> and <span class=\"tex-span\"><i>v</i></span> can be generated using the formula given below: <ul> <li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/41e63c8dc8bc8ccdd6518f3545d4ed6563ad0149.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, </li><li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/d507471ec4ac41dfdb7ae85e8e229454a071fabf.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, </li><li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/ef5c7174e223cf6451bba39d4eec35ac6d923636.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. </li></ul> </li><li> <span class=\"tex-font-style-bf\">t = 2</span>: Second line contains single integer <span class=\"tex-span\"><i>a</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i>\u2009&lt;\u20092<sup class=\"upper-index\">30</sup></span>) using which <span class=\"tex-span\"><i>x</i></span> can be generated using the formula given below: <ul> <li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/d48156478483a72dae043d51512212446bbff09e.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. </li></ul> </li></ul><p>The <span class=\"tex-span\"><i>ans</i><sub class=\"lower-index\"><i>i</i></sub></span> is the answer for the <span class=\"tex-span\"><i>i</i></span>-th query, assume that <span class=\"tex-span\"><i>ans</i><sub class=\"lower-index\">0</sub>\u2009=\u20090</span>. If the <span class=\"tex-span\"><i>i</i></span>-th query is of type 2 then <span class=\"tex-span\"><i>ans</i><sub class=\"lower-index\"><i>i</i></sub></span> = <span class=\"tex-span\"><i>ans</i><sub class=\"lower-index\"><i>i</i>\u2009-\u20091</sub></span>. It is guaranteed that: </p><ul> <li> <span class=\"tex-font-style-bf\">for each query of type 1</span>: <span class=\"tex-span\">1\u2009\u2264\u2009<i>l</i>\u2009\u2264\u2009<i>r</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>v</i>\u2009\u2264\u2009<i>n</i></span>, </li><li> <span class=\"tex-font-style-bf\">for each query of type 2</span>: <span class=\"tex-span\">1\u2009\u2264\u2009<i>x</i>\u2009\u2264\u2009<i>n</i>\u2009-\u20091</span>. </li></ul><p>The <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/c4b7092c0f7ce6535f2574569c98f7b3c2fe2c5f.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> operation means bitwise exclusive OR.</p>",
    "outputSpecification": "<p>For each query of type <span class=\"tex-span\">1</span>, output a single integer in a separate line, denoting the answer to the query.</p>",
    "samples": [
        {
            "input": "5 5<br/>4 5 1 3 2<br/>4 2 4<br/>1 3 9<br/>4 1 4<br/>4 5 2<br/>1<br/>1 5 4<br/>1<br/>22 20 20<br/>2<br/>38<br/>2<br/>39<br/>1<br/>36 38 38<br/>",
            "output": "23<br/>37<br/>28<br/>"
        }
    ],
    "note": "<p>In the sample, the actual queries are the following: </p><ul> <li> <span class=\"tex-font-style-tt\">1 1 5 4</span> </li><li> <span class=\"tex-font-style-tt\">1 1 3 3</span> </li><li> <span class=\"tex-font-style-tt\">2 3</span> </li><li> <span class=\"tex-font-style-tt\">2 2</span> </li><li> <span class=\"tex-font-style-tt\">1 1 3 3</span> </li></ul>",
    "contestId": 757,
    "index": "G",
    "name": "Can Bash Save the Day?",
    "type": "PROGRAMMING",
    "tags": [
        "data structures",
        "divide and conquer",
        "graphs",
        "trees"
    ],
    "solvedCount": 484
}