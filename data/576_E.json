{
    "title": "E. Painting Edges",
    "timeLimit": {
        "value": 6.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 600.0,
        "unit": "megabytes"
    },
    "statement": "<p><span class=\"tex-font-style-it\">Note the unusual memory limit for this problem.</span></p><p>You are given an undirected graph consisting of <span class=\"tex-span\"><i>n</i></span> vertices and <span class=\"tex-span\"><i>m</i></span> edges. The vertices are numbered with integers from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>n</i></span>, the edges are numbered with integers from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>m</i></span>. Each edge can be unpainted or be painted in one of the <span class=\"tex-span\"><i>k</i></span> colors, which are numbered with integers from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>k</i></span>. Initially, none of the edges is painted in any of the colors.</p><p>You get queries of the form \"Repaint edge <span class=\"tex-span\"><i>e</i><sub class=\"lower-index\"><i>i</i></sub></span> to color <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span>\". At any time the graph formed by the edges of the same color must be bipartite. If after the repaint this condition is violated, then the query is considered to be invalid and edge <span class=\"tex-span\"><i>e</i><sub class=\"lower-index\"><i>i</i></sub></span> keeps its color. Otherwise, edge <span class=\"tex-span\"><i>e</i><sub class=\"lower-index\"><i>i</i></sub></span> is repainted in color <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span>, and the query is considered to valid.</p><p>Recall that the graph is called <span class=\"tex-font-style-it\">bipartite</span> if the set of its vertices can be divided into two parts so that no edge connected vertices of the same parts.</p><p>For example, suppose you are given a triangle graph, that is a graph with three vertices and edges <span class=\"tex-span\">(1,\u20092)</span>, <span class=\"tex-span\">(2,\u20093)</span> and <span class=\"tex-span\">(3,\u20091)</span>. Suppose that the first two edges are painted color <span class=\"tex-span\">1</span>, and the third one is painted color <span class=\"tex-span\">2</span>. Then the query of \"repaint the third edge in color <span class=\"tex-span\">1</span>\" will be incorrect because after its execution the graph formed by the edges of color <span class=\"tex-span\">1</span> will not be bipartite. On the other hand, it is possible to repaint the second edge in color <span class=\"tex-span\">2</span>.</p><p>You receive <span class=\"tex-span\"><i>q</i></span> queries. For each query, you should either apply it, and report that the query is valid, or report that the query is invalid.</p>",
    "inputSpecification": "<p>The first line contains integers <span class=\"tex-span\"><i>n</i></span>, <span class=\"tex-span\"><i>m</i></span>, <span class=\"tex-span\"><i>k</i></span>, <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u20095\u00b710<sup class=\"upper-index\">5</sup></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>m</i>,\u2009<i>q</i>\u2009\u2264\u20095\u00b710<sup class=\"upper-index\">5</sup></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>k</i>\u2009\u2264\u200950</span>) \u2014 the number of vertices, the number of edges, the number of colors and the number of queries. </p><p>Then follow <span class=\"tex-span\"><i>m</i></span> edges of the graph in the form <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span>, <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>b</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i></span>). </p><p>Then follow <span class=\"tex-span\"><i>q</i></span> queries of the form <span class=\"tex-span\"><i>e</i><sub class=\"lower-index\"><i>i</i></sub></span>, <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>e</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>m</i></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>k</i></span>).</p><p>It is guaranteed that the graph doesn't contain multiple edges and loops.</p>",
    "outputSpecification": "<p>For each query print \"<span class=\"tex-font-style-tt\">YES</span>\" (without the quotes), if it is valid, or \"<span class=\"tex-font-style-tt\">NO</span>\" (without the quotes), if this query destroys the bipartivity of the graph formed by the edges of some color.</p>",
    "samples": [
        {
            "input": "3 3 2 5<br/>1 2<br/>2 3<br/>1 3<br/>1 1<br/>2 1<br/>3 2<br/>3 1<br/>2 2<br/>",
            "output": "YES<br/>YES<br/>YES<br/>NO<br/>YES<br/>"
        }
    ],
    "note": null,
    "contestId": 576,
    "index": "E",
    "name": "Painting Edges",
    "type": "PROGRAMMING",
    "tags": [
        "binary search",
        "data structures"
    ],
    "solvedCount": 1126
}