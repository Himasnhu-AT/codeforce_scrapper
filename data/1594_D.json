{
    "title": "D. The Number of Imposters",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Theofanis started playing the new online game called \"Among them\". However, he always plays with Cypriot players, and they all have the same name: \"Andreas\" (the most common name in Cyprus).</p><p>In each game, Theofanis plays with $$$n$$$ other players. Since they all have the same name, they are numbered from $$$1$$$ to $$$n$$$.</p><p>The players write $$$m$$$ comments in the chat. A comment has the structure of \"$$$i$$$ $$$j$$$ $$$c$$$\" where $$$i$$$ and $$$j$$$ are two distinct integers and $$$c$$$ is a string ($$$1 \\le i, j \\le n$$$; $$$i \\neq j$$$; $$$c$$$ is either <span class=\"tex-font-style-tt\">imposter</span> or <span class=\"tex-font-style-tt\">crewmate</span>). The comment means that player $$$i$$$ said that player $$$j$$$ has the role $$$c$$$.</p><p>An imposter always lies, and a crewmate always tells the truth. </p><p>Help Theofanis find the maximum possible number of imposters among all the other Cypriot players, or determine that the comments contradict each other (see the notes for further explanation).</p><p>Note that each player has exactly <span class=\"tex-font-style-bf\">one</span> role: either <span class=\"tex-font-style-tt\">imposter</span> or <span class=\"tex-font-style-tt\">crewmate</span>.</p>",
    "inputSpecification": "<p>The first line contains a single integer $$$t$$$ ($$$1 \\le t \\le 10^4$$$)\u00a0\u2014 the number of test cases. Description of each test case follows.</p><p>The first line of each test case contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\le n \\le 2 \\cdot 10^5$$$; $$$0 \\le m \\le 5 \\cdot 10^5$$$)\u00a0\u2014 the number of players except Theofanis and the number of comments.</p><p>Each of the next $$$m$$$ lines contains a comment made by the players of the structure \"$$$i$$$ $$$j$$$ $$$c$$$\" where $$$i$$$ and $$$j$$$ are two <span class=\"tex-font-style-bf\">distinct</span> integers and $$$c$$$ is a string ($$$1 \\le i, j \\le n$$$; $$$i \\neq j$$$; $$$c$$$ is either <span class=\"tex-font-style-tt\">imposter</span> or <span class=\"tex-font-style-tt\">crewmate</span>).</p><p>There can be multiple comments for the same pair of $$$(i, j)$$$.</p><p>It is guaranteed that the sum of all $$$n$$$ does not exceed $$$2 \\cdot 10^5$$$ and the sum of all $$$m$$$ does not exceed $$$5 \\cdot 10^5$$$.</p>",
    "outputSpecification": "<p>For each test case, print one integer\u00a0\u2014 the <span class=\"tex-font-style-bf\">maximum</span> possible number of imposters. If the comments contradict each other, print $$$-1$$$.</p>",
    "samples": [
        {
            "input": "\n5\n3 2\n1 2 imposter\n2 3 crewmate\n5 4\n1 3 crewmate\n2 5 crewmate\n2 4 imposter\n3 4 imposter\n2 2\n1 2 imposter\n2 1 crewmate\n3 5\n1 2 imposter\n1 2 imposter\n3 2 crewmate\n3 2 crewmate\n1 3 imposter\n5 0\n",
            "output": "\n2\n4\n-1\n2\n5\n"
        }
    ],
    "note": "<p>In the first test case, imposters can be Andreas $$$2$$$ and $$$3$$$.</p><p>In the second test case, imposters can be Andreas $$$1$$$, $$$2$$$, $$$3$$$ and $$$5$$$.</p><p>In the third test case, comments contradict each other. This is because player $$$1$$$ says that player $$$2$$$ is an imposter, and player $$$2$$$ says that player $$$1$$$ is a crewmate. If player $$$1$$$ is a crewmate, then he must be telling the truth, so player $$$2$$$ must be an imposter. But if player $$$2$$$ is an imposter then he must be lying, so player $$$1$$$ can't be a crewmate. Contradiction.</p>",
    "contestId": 1594,
    "index": "D",
    "name": "The Number of Imposters",
    "type": "PROGRAMMING",
    "tags": [
        "constructive algorithms",
        "dfs and similar",
        "dp",
        "dsu",
        "graphs"
    ],
    "solvedCount": 7178
}