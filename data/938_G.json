{
    "title": "G. Shortest Path Queries",
    "timeLimit": {
        "value": 3.5,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given an undirected connected graph with weighted edges. The length of some path between two vertices is the bitwise xor of weights of all edges belonging to this path (if some edge is traversed more than once, then it is included in bitwise xor the same number of times). </p><p>There are three types of queries you have to process:</p><ul> <li> <span class=\"tex-span\">1</span> <span class=\"tex-span\"><i>x</i></span> <span class=\"tex-span\"><i>y</i></span> <span class=\"tex-span\"><i>d</i></span> \u2014 add an edge connecting vertex <span class=\"tex-span\"><i>x</i></span> to vertex <span class=\"tex-span\"><i>y</i></span> with weight <span class=\"tex-span\"><i>d</i></span>. It is guaranteed that there is no edge connecting <span class=\"tex-span\"><i>x</i></span> to <span class=\"tex-span\"><i>y</i></span> before this query; </li><li> <span class=\"tex-span\">2</span> <span class=\"tex-span\"><i>x</i></span> <span class=\"tex-span\"><i>y</i></span> \u2014 remove an edge connecting vertex <span class=\"tex-span\"><i>x</i></span> to vertex <span class=\"tex-span\"><i>y</i></span>. It is guaranteed that there was such edge in the graph, and the graph stays connected after this query; </li><li> <span class=\"tex-span\">3</span> <span class=\"tex-span\"><i>x</i></span> <span class=\"tex-span\"><i>y</i></span> \u2014 calculate the length of the shortest path (possibly non-simple) from vertex <span class=\"tex-span\"><i>x</i></span> to vertex <span class=\"tex-span\"><i>y</i></span>. </li></ul><p>Print the answers for all queries of type <span class=\"tex-span\">3</span>.</p>",
    "inputSpecification": "<p>The first line contains two numbers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>\u2009\u2264\u2009200000</span>) \u2014 the number of vertices and the number of edges in the graph, respectively.</p><p>Then <span class=\"tex-span\"><i>m</i></span> lines follow denoting the edges of the graph. Each line contains three integers <span class=\"tex-span\"><i>x</i></span>, <span class=\"tex-span\"><i>y</i></span> and <span class=\"tex-span\"><i>d</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>x</i>\u2009&lt;\u2009<i>y</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\">0\u2009\u2264\u2009<i>d</i>\u2009\u2264\u20092<sup class=\"upper-index\">30</sup>\u2009-\u20091</span>). Each pair <span class=\"tex-span\">(<i>x</i>,\u2009<i>y</i>)</span> is listed at most once. The initial graph is connected.</p><p>Then one line follows, containing an integer <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u2009200000</span>) \u2014 the number of queries you have to process.</p><p>Then <span class=\"tex-span\"><i>q</i></span> lines follow, denoting queries in the following form:</p><ul> <li> <span class=\"tex-span\">1</span> <span class=\"tex-span\"><i>x</i></span> <span class=\"tex-span\"><i>y</i></span> <span class=\"tex-span\"><i>d</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>x</i>\u2009&lt;\u2009<i>y</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\">0\u2009\u2264\u2009<i>d</i>\u2009\u2264\u20092<sup class=\"upper-index\">30</sup>\u2009-\u20091</span>) \u2014 add an edge connecting vertex <span class=\"tex-span\"><i>x</i></span> to vertex <span class=\"tex-span\"><i>y</i></span> with weight <span class=\"tex-span\"><i>d</i></span>. It is guaranteed that there is no edge connecting <span class=\"tex-span\"><i>x</i></span> to <span class=\"tex-span\"><i>y</i></span> before this query; </li><li> <span class=\"tex-span\">2</span> <span class=\"tex-span\"><i>x</i></span> <span class=\"tex-span\"><i>y</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>x</i>\u2009&lt;\u2009<i>y</i>\u2009\u2264\u2009<i>n</i></span>) \u2014 remove an edge connecting vertex <span class=\"tex-span\"><i>x</i></span> to vertex <span class=\"tex-span\"><i>y</i></span>. It is guaranteed that there was such edge in the graph, and the graph stays connected after this query; </li><li> <span class=\"tex-span\">3</span> <span class=\"tex-span\"><i>x</i></span> <span class=\"tex-span\"><i>y</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>x</i>\u2009&lt;\u2009<i>y</i>\u2009\u2264\u2009<i>n</i></span>) \u2014 calculate the length of the shortest path (possibly non-simple) from vertex <span class=\"tex-span\"><i>x</i></span> to vertex <span class=\"tex-span\"><i>y</i></span>. </li></ul><p>It is guaranteed that at least one query has type <span class=\"tex-span\">3</span>.</p>",
    "outputSpecification": "<p>Print the answers for all queries of type <span class=\"tex-span\">3</span> in the order they appear in input.</p>",
    "samples": [
        {
            "input": "5 5<br/>1 2 3<br/>2 3 4<br/>3 4 5<br/>4 5 6<br/>1 5 1<br/>5<br/>3 1 5<br/>1 1 3 1<br/>3 1 5<br/>2 1 5<br/>3 1 5<br/>",
            "output": "1<br/>1<br/>2<br/>"
        }
    ],
    "note": null,
    "contestId": 938,
    "index": "G",
    "name": "Shortest Path Queries",
    "type": "PROGRAMMING",
    "tags": [
        "bitmasks",
        "data structures",
        "dsu",
        "graphs"
    ],
    "solvedCount": 863
}