{
    "title": "E2. Unforgivable Curse (hard version)",
    "timeLimit": {
        "value": 1.0,
        "unit": "second"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p><span class=\"tex-font-style-bf\">This is a complex version of the problem. This version has no additional restrictions on the number $$$k$$$.</span></p><p>The chief wizard of the Wizengamot once caught the evil wizard Drahyrt, but the evil wizard has returned and wants revenge on the chief wizard. So he stole <span class=\"tex-font-style-it\">spell</span> $$$s$$$ from his student Harry.</p><p>The <span class=\"tex-font-style-it\">spell</span>\u00a0\u2014 is a $$$n$$$-length string of lowercase Latin letters.</p><p>Drahyrt wants to replace <span class=\"tex-font-style-it\">spell</span> with an unforgivable curse\u00a0\u2014 string $$$t$$$.</p><p>Dragirt, using ancient magic, can swap letters at a distance $$$k$$$ or $$$k+1$$$ in <span class=\"tex-font-style-it\">spell</span> as many times as he wants. In other words, Drahyrt can change letters in positions $$$i$$$ and $$$j$$$ in <span class=\"tex-font-style-it\">spell</span> $$$s$$$ if $$$|i-j|=k$$$ or $$$|i-j|=k+1$$$.</p><p>For example, if $$$k = 3, s = $$$ \"<span class=\"tex-font-style-tt\">talant</span>\" and $$$t = $$$ \"<span class=\"tex-font-style-tt\">atltna</span>\", Drahyrt can act as follows:</p><ul> <li> swap the letters at positions $$$1$$$ and $$$4$$$ to get <span class=\"tex-font-style-it\">spell</span> \"<span class=\"tex-font-style-tt\">aaltnt</span>\". </li><li> swap the letters at positions $$$2$$$ and $$$6$$$ to get <span class=\"tex-font-style-it\">spell</span> \"<span class=\"tex-font-style-tt\">atltna</span>\". </li></ul><p>You are given <span class=\"tex-font-style-it\">spells</span> $$$s$$$ and $$$t$$$. Can Drahyrt change <span class=\"tex-font-style-it\">spell</span> $$$s$$$ to $$$t$$$?</p>",
    "inputSpecification": "<p>The first line of input gives a single integer $$$T$$$ ($$$1 \\le T \\le 10^4$$$)\u00a0\u2014 the number of test cases in the test.</p><p>Descriptions of the test cases are follow.</p><p>The first line contains two integers $$$n, k$$$ ($$$1 \\le n \\le 2 \\cdot 10^5$$$, $$$1 \\le k \\le 2 \\cdot 10^5$$$)\u00a0\u2014 the length <span class=\"tex-font-style-it\">spells</span> and the number $$$k$$$ such that Drahyrt can change letters in a spell at a distance $$$k$$$ or $$$k+1$$$.</p><p>The second line gives <span class=\"tex-font-style-it\">spell</span> $$$s$$$\u00a0\u2014 a string of length $$$n$$$ consisting of lowercase Latin letters.</p><p>The third line gives <span class=\"tex-font-style-it\">spell</span> $$$t$$$\u00a0\u2014 a string of length $$$n$$$ consisting of lowercase Latin letters.</p><p>It is guaranteed that the sum of $$$n$$$ values over all test cases does not exceed $$$2 \\cdot 10^5$$$. Note that there is no limit on the sum of $$$k$$$ values over all test cases.</p>",
    "outputSpecification": "<p>For each test case, output on a separate line \"<span class=\"tex-font-style-tt\">YES</span>\" if Drahyrt can change <span class=\"tex-font-style-it\">spell</span> $$$s$$$ to $$$t$$$ and \"<span class=\"tex-font-style-tt\">NO</span>\" otherwise.</p><p>You can output the answer in any case (for example, lines \"<span class=\"tex-font-style-tt\">yEs</span>\", \"<span class=\"tex-font-style-tt\">yes</span>\", \"<span class=\"tex-font-style-tt\">Yes</span>\" and \"<span class=\"tex-font-style-tt\">YES</span>\" will be recognized as positive answer).</p>",
    "samples": [
        {
            "input": "\n<div class=\"test-example-line test-example-line-even test-example-line-0\">7</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">6 3</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">talant</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">atltna</div><div class=\"test-example-line test-example-line-even test-example-line-2\">7 1</div><div class=\"test-example-line test-example-line-even test-example-line-2\">abacaba</div><div class=\"test-example-line test-example-line-even test-example-line-2\">aaaabbc</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">12 6</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">abracadabraa</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">avadakedavra</div><div class=\"test-example-line test-example-line-even test-example-line-4\">5 3</div><div class=\"test-example-line test-example-line-even test-example-line-4\">accio</div><div class=\"test-example-line test-example-line-even test-example-line-4\">cicao</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">5 4</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">lumos</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">molus</div><div class=\"test-example-line test-example-line-even test-example-line-6\">4 3</div><div class=\"test-example-line test-example-line-even test-example-line-6\">uwjt</div><div class=\"test-example-line test-example-line-even test-example-line-6\">twju</div><div class=\"test-example-line test-example-line-odd test-example-line-7\">4 3</div><div class=\"test-example-line test-example-line-odd test-example-line-7\">kvpx</div><div class=\"test-example-line test-example-line-odd test-example-line-7\">vxpk</div>",
            "output": "\nYES\nYES\nNO\nYES\nNO\nYES\nNO\n"
        }
    ],
    "note": "<p>The first case is explained in the condition.</p><p>In the second case, we can swap adjacent letters, so we can sort the string using bubble sorting, for example.</p><p>In the third case, we can show that from the string $$$s$$$ we cannot get the string $$$t$$$ by swapping letters at a distance of $$$6$$$ or $$$7$$$.</p><p>In the fourth case, for example, the following sequence of transformations is appropriate:</p><ul> <li> \"<span class=\"tex-font-style-tt\">accio</span>\" $$$\\rightarrow$$$ \"<span class=\"tex-font-style-tt\">aocic</span>\" $$$\\rightarrow$$$ \"<span class=\"tex-font-style-tt\">cocia</span>\" $$$\\rightarrow$$$ \"<span class=\"tex-font-style-tt\">iocca</span>\" $$$\\rightarrow$$$ \"<span class=\"tex-font-style-tt\">aocci</span>\" $$$\\rightarrow$$$ \"<span class=\"tex-font-style-tt\">aicco</span>\" $$$\\rightarrow$$$ \"<span class=\"tex-font-style-tt\">cicao</span>\" </li></ul><p>In the fifth case, we can show that it is impossible to get the string $$$s$$$ from the string $$$t$$$.</p><p>In the sixth example, it is enough to swap the two outermost letters.</p>",
    "contestId": 1800,
    "index": "E2",
    "name": "Unforgivable Curse (hard version)",
    "type": "PROGRAMMING",
    "tags": [
        "brute force",
        "constructive algorithms",
        "dfs and similar",
        "dsu",
        "graphs",
        "greedy",
        "strings"
    ],
    "solvedCount": 12231
}