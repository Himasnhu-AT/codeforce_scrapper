{
    "title": "D. Fafa and Ancient Alphabet",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Ancient Egyptians are known to have used a large set of symbols <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/782cb89fbe7443d4734af5f2bb9f8d15ac2ace56.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> to write on the walls of the temples. Fafa and Fifa went to one of the temples and found two non-empty words <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\">1</sub></span> and <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\">2</sub></span> of equal lengths on the wall of temple written one below the other. Since this temple is very ancient, some symbols from the words were erased. The symbols in the set <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/782cb89fbe7443d4734af5f2bb9f8d15ac2ace56.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> have equal probability for being in the position of any erased symbol.</p><p>Fifa challenged Fafa to calculate the probability that <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\">1</sub></span> is lexicographically greater than <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\">2</sub></span>. Can you help Fafa with this task?</p><p>You know that <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/e45165853d1771bbec2e6849b3b55f0021c8d6fa.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, i.\u00a0e. there were <span class=\"tex-span\"><i>m</i></span> distinct characters in Egyptians' alphabet, in this problem these characters are denoted by integers from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>m</i></span> in alphabet order. A word <span class=\"tex-span\"><i>x</i></span> is lexicographically greater than a word <span class=\"tex-span\"><i>y</i></span> of the same length, if the words are same up to some position, and then the word <span class=\"tex-span\"><i>x</i></span> has a larger character, than the word <span class=\"tex-span\"><i>y</i></span>.</p><p>We can prove that the probability equals to some fraction <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/8c774283e44990bd22fded6fe64d27b8a23c99ff.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, where <span class=\"tex-span\"><i>P</i></span> and <span class=\"tex-span\"><i>Q</i></span> are coprime integers, and <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/9a89b9238145afe8a88be1ad2fb4dc4a5901b1d1.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. Print as the answer the value <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/8919f4faa13b25e67af57ddcb244a740fdc37fab.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, i.\u00a0e. such a non-negative integer less than <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>, such that <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/b1631491bff462570ddb4b3825cc2b9ca5807ecb.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, where <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/19ed9832b6e4da7413f61a1c23c79068cd8f49d1.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> means that <span class=\"tex-span\"><i>a</i></span> and <span class=\"tex-span\"><i>b</i></span> give the same remainders when divided by <span class=\"tex-span\"><i>m</i></span>.</p>",
    "inputSpecification": "<p>The first line contains two integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009\u2009<i>m</i>\u2009\u2264\u200910<sup class=\"upper-index\">5</sup></span>) \u2014 the length of each of the two words and the size of the alphabet <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/782cb89fbe7443d4734af5f2bb9f8d15ac2ace56.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, respectively.</p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> (<span class=\"tex-span\">0\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>m</i></span>) \u2014 the symbols of <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\">1</sub></span>. If <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u20090</span>, then the symbol at position <span class=\"tex-span\"><i>i</i></span> was erased.</p><p>The third line contains <span class=\"tex-span\"><i>n</i></span> integers representing <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\">2</sub></span> with the same format as <span class=\"tex-span\"><i>S</i><sub class=\"lower-index\">1</sub></span>.</p>",
    "outputSpecification": "<p>Print the value <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/57394b93f524f97ade9fb74b302ba6833a1081c6.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, where <span class=\"tex-span\"><i>P</i></span> and <span class=\"tex-span\"><i>Q</i></span> are coprime and <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/8c774283e44990bd22fded6fe64d27b8a23c99ff.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> is the answer to the problem.</p>",
    "samples": [
        {
            "input": "1 2<br/>0<br/>1<br/>",
            "output": "500000004<br/>"
        },
        {
            "input": "1 2<br/>1<br/>0<br/>",
            "output": "0<br/>"
        },
        {
            "input": "7 26<br/>0 15 12 9 13 0 14<br/>11 1 0 13 15 12 0<br/>",
            "output": "230769233<br/>"
        }
    ],
    "note": "<p>In the first sample, the first word can be converted into (<span class=\"tex-span\">1</span>) or (<span class=\"tex-span\">2</span>). The second option is the only one that will make it lexicographically larger than the second word. So, the answer to the problem will be <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/a762254bc6d3a2cc6ae07485c1de945962e7e524.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, that is <span class=\"tex-span\">500000004</span>, because <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/cbff288b4c38669aa9b8013ee25b8dde80420841.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p><p>In the second example, there is no replacement for the zero in the second word that will make the first one lexicographically larger. So, the answer to the problem is <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/a468ab19fec68399601f37993805846b7dd342ad.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, that is <span class=\"tex-span\">0</span>.</p>",
    "contestId": 935,
    "index": "D",
    "name": "Fafa and Ancient Alphabet",
    "type": "PROGRAMMING",
    "tags": [
        "math",
        "probabilities"
    ],
    "solvedCount": 2531
}