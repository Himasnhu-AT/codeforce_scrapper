{
    "title": "B. Duff in Beach",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>While Duff was resting in the beach, she accidentally found a strange array <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\">0</sub>,\u2009<i>b</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>b</i><sub class=\"lower-index\"><i>l</i>\u2009-\u20091</sub></span> consisting of <span class=\"tex-span\"><i>l</i></span> positive integers. This array was strange because it was extremely long, but there was another (maybe shorter) array, <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">0</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i>\u2009-\u20091</sub></span> that <span class=\"tex-span\"><i>b</i></span> can be build from <span class=\"tex-span\"><i>a</i></span> with formula: <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u2009<i>a</i><sub class=\"lower-index\"><i>i</i> <i>mod</i> <i>n</i></sub></span> where <span class=\"tex-span\"><i>a</i> <i>mod</i> <i>b</i></span> denoted the remainder of dividing <span class=\"tex-span\"><i>a</i></span> by <span class=\"tex-span\"><i>b</i></span>.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/8bd54986ad8c69685742e088fa8f8228ce35984e.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>Duff is so curious, she wants to know the number of subsequences of <span class=\"tex-span\"><i>b</i></span> like <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i><sub class=\"lower-index\">1</sub></sub>,\u2009<i>b</i><sub class=\"lower-index\"><i>i</i><sub class=\"lower-index\">2</sub></sub>,\u2009...,\u2009<i>b</i><sub class=\"lower-index\"><i>i</i><sub class=\"lower-index\"><i>x</i></sub></sub></span> (<span class=\"tex-span\">0\u2009\u2264\u2009<i>i</i><sub class=\"lower-index\">1</sub>\u2009&lt;\u2009<i>i</i><sub class=\"lower-index\">2</sub>\u2009&lt;\u2009...\u2009&lt;\u2009<i>i</i><sub class=\"lower-index\"><i>x</i></sub>\u2009&lt;\u2009<i>l</i></span>), such that: </p><ul> <li> <span class=\"tex-span\">1\u2009\u2264\u2009<i>x</i>\u2009\u2264\u2009<i>k</i></span> </li><li> For each <span class=\"tex-span\">1\u2009\u2264\u2009<i>j</i>\u2009\u2264\u2009<i>x</i>\u2009-\u20091</span>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/8049e70898b1d8579ee1e94f4c68483c301ddfc5.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </li><li> For each <span class=\"tex-span\">1\u2009\u2264\u2009<i>j</i>\u2009\u2264\u2009<i>x</i>\u2009-\u20091</span>, <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i><sub class=\"lower-index\"><i>j</i></sub></sub>\u2009\u2264\u2009<i>b</i><sub class=\"lower-index\"><i>i</i><sub class=\"lower-index\"><i>j</i>\u2009+\u20091</sub></sub></span>. i.e this subsequence is non-decreasing. </li></ul><p>Since this number can be very large, she want to know it modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>.</p><p>Duff is not a programmer, and Malek is unavailable at the moment. So she asked for your help. Please tell her this number.</p>",
    "inputSpecification": "<p>The first line of input contains three integers, <span class=\"tex-span\"><i>n</i>,\u2009<i>l</i></span> and <span class=\"tex-span\"><i>k</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>k</i></span>, <span class=\"tex-span\"><i>n</i>\u2009\u00d7\u2009<i>k</i>\u2009\u2264\u200910<sup class=\"upper-index\">6</sup></span> and <span class=\"tex-span\">1\u2009\u2264\u2009<i>l</i>\u2009\u2264\u200910<sup class=\"upper-index\">18</sup></span>).</p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> space separated integers, <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">0</sub>,\u2009<i>a</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i>\u2009-\u20091</sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u200910<sup class=\"upper-index\">9</sup></span> for each <span class=\"tex-span\">0\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009<i>n</i>\u2009-\u20091</span>). </p>",
    "outputSpecification": "<p>Print the answer modulo <span class=\"tex-span\">1\u2009000\u2009000\u2009007</span> in one line.</p>",
    "samples": [
        {
            "input": "3 5 3<br/>5 9 1<br/>",
            "output": "10<br/>"
        },
        {
            "input": "5 10 3<br/>1 2 3 4 5<br/>",
            "output": "25<br/>"
        }
    ],
    "note": "<p>In the first sample case, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/d9d8fe92937aeef2bcddb9d213e5587f0f950087.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. So all such sequences are: <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/54d7dd513b50dae3415992b37dcf6f8ff2f24a73.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/fcd7414fd5b0b1459adc9dafca95e6d5a23b0d7d.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/f6d2e0d0317c10a3c5213068fb1d1e1f53ff26eb.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/8f6627cad3dd113f47d84a1226f30fe423939757.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/c6db71d99107f752b5caa1ba7e44af1d2302e5db.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/a06ffb7bf9126fd634a790703c0bbfda00c60aa1.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/b086d545b6c80640ea8558920709e3c51ba3bf43.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/661b7811fccac48a9e96733bc99c3dfec93ad6d7.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/8756896f0d00888771e69f1a9ccddeee19d4a9ab.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> and <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/e771f8119b1b8218c875759aa03e38312514c9a2.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p>",
    "contestId": 587,
    "index": "B",
    "name": "Duff in Beach",
    "type": "PROGRAMMING",
    "tags": [
        "dp"
    ],
    "solvedCount": 1378
}