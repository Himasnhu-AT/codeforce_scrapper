{
    "title": "F. MEX counting",
    "timeLimit": {
        "value": 4.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>For an array $$$c$$$ of nonnegative integers, $$$MEX(c)$$$ denotes the smallest nonnegative integer that doesn't appear in it. For example, $$$MEX([0, 1, 3]) = 2$$$, $$$MEX([42]) = 0$$$.</p><p>You are given integers $$$n, k$$$, and an array $$$[b_1, b_2, \\ldots, b_n]$$$.</p><p>Find the number of arrays $$$[a_1, a_2, \\ldots, a_n]$$$, for which the following conditions hold:</p><ul><li><p>$$$0 \\le a_i \\le n$$$ for each $$$i$$$ for each $$$i$$$ from $$$1$$$ to $$$n$$$.</p></li><li><p>$$$|MEX([a_1, a_2, \\ldots, a_i]) - b_i| \\le k$$$ for each $$$i$$$ from $$$1$$$ to $$$n$$$.</p></li></ul><p>As this number can be very big, output it modulo $$$998\\,244\\,353$$$.</p>",
    "inputSpecification": "<p>The first line of the input contains two integers $$$n, k$$$ ($$$1 \\le n \\le 2000$$$, $$$0 \\le k \\le 50$$$).</p><p>The second line of the input contains $$$n$$$ integers $$$b_1, b_2, \\ldots, b_n$$$ ($$$-k \\le b_i \\le n+k$$$)\u00a0\u2014 elements of the array $$$b$$$.</p>",
    "outputSpecification": "<p>Output a single integer\u00a0\u2014 the number of arrays which satisfy the conditions from the statement, modulo $$$998\\,244\\,353$$$.</p>",
    "samples": [
        {
            "input": "\n4 0\n0 0 0 0\n",
            "output": "\n256\n"
        },
        {
            "input": "\n4 1\n0 0 0 0\n",
            "output": "\n431\n"
        },
        {
            "input": "\n4 1\n0 0 1 1\n",
            "output": "\n509\n"
        },
        {
            "input": "\n5 2\n0 0 2 2 0\n",
            "output": "\n6546\n"
        },
        {
            "input": "\n3 2\n-2 0 4\n",
            "output": "\n11\n"
        }
    ],
    "note": null,
    "contestId": 1608,
    "index": "F",
    "name": "MEX counting",
    "type": "PROGRAMMING",
    "tags": [
        "combinatorics",
        "dp",
        "implementation"
    ],
    "solvedCount": 526
}