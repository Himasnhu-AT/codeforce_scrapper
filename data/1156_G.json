{
    "title": "G. Optimizer",
    "timeLimit": {
        "value": 1.0,
        "unit": "second"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Let's analyze a program written on some strange programming language. The variables in this language have names consisting of $$$1$$$ to $$$4$$$ characters, and each character is a lowercase or an uppercase Latin letter, or a digit. There is an extra constraint that the first character should not be a digit.</p><p>There are four types of operations in the program, each denoted by one of the characters: <span class=\"tex-font-style-tt\">$</span>, <span class=\"tex-font-style-tt\">^</span>, <span class=\"tex-font-style-tt\">#</span> or <span class=\"tex-font-style-tt\">&amp;</span>.</p><p>Each line of the program has one of the following formats: </p><ul> <li> <span class=\"tex-font-style-tt\">&lt;lvalue&gt;=&lt;rvalue&gt;</span>, where <span class=\"tex-font-style-tt\">&lt;lvalue&gt;</span> and <span class=\"tex-font-style-tt\">&lt;rvalue&gt;</span> are valid variable names; </li><li> <span class=\"tex-font-style-tt\">&lt;lvalue&gt;=&lt;arg1&gt;&lt;op&gt;&lt;arg2&gt;</span>, where <span class=\"tex-font-style-tt\">&lt;lvalue&gt;</span>, <span class=\"tex-font-style-tt\">&lt;arg1&gt;</span> and <span class=\"tex-font-style-tt\">&lt;arg2&gt;</span> are valid variable names, and &lt;op&gt; is an operation character. </li></ul><p>The program is executed line-by-line, and the result of execution is stored in a variable having the name <span class=\"tex-font-style-tt\">res</span>. If <span class=\"tex-font-style-tt\">res</span> is never assigned in the program, then the result will be equal to the value of <span class=\"tex-font-style-tt\">res</span> before running the program.</p><p>Two programs are called equivalent if no matter which operations do characters <span class=\"tex-font-style-tt\">$</span>, <span class=\"tex-font-style-tt\">^</span>, <span class=\"tex-font-style-tt\">#</span> and <span class=\"tex-font-style-tt\">&amp;</span> denote (but, obviously, performing the same operation on the same arguments gives the same result) and which values do variables have before execution of program, the value of <span class=\"tex-font-style-tt\">res</span> after running the first program is equal to the value of <span class=\"tex-font-style-tt\">res</span> after running the second program (the programs are executed independently).</p><p>You are given a program consisting of $$$n$$$ lines. Your task is to write a program consisting of minimum possible number of lines that is equivalent to the program you are given.</p>",
    "inputSpecification": "<p>The first line contains one integer $$$n$$$ ($$$1 \\le n \\le 1000$$$) \u2014 the number of lines in the program.</p><p>Then $$$n$$$ lines follow \u2014 the program itself. Each line corresponds to the format described in the statement and has no extra whitespaces.</p>",
    "outputSpecification": "<p>In the first line print $$$k$$$ \u2014 the minimum number of lines in the equivalent program.</p><p>Then print $$$k$$$ lines without any whitespaces \u2014 an equivalent program having exactly $$$k$$$ lines, in the same format it is described in the statement.</p>",
    "samples": [
        {
            "input": "\n4\nc=aa#bb\nd12=c\nres=c^d12\ntmp=aa$c\n",
            "output": "\n2\naaaa=aa#bb\nres=aaaa^aaaa\n"
        },
        {
            "input": "\n2\nmax=aaaa$bbbb\nmin=bbbb^aaaa\n",
            "output": "\n0"
        }
    ],
    "note": null,
    "contestId": 1156,
    "index": "G",
    "name": "Optimizer",
    "type": "PROGRAMMING",
    "tags": [
        "graphs",
        "greedy",
        "hashing",
        "implementation"
    ],
    "solvedCount": 125
}