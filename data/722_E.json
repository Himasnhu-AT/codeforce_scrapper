{
    "title": "E. Research Rover",
    "timeLimit": {
        "value": 2.5,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p><span class=\"tex-font-style-it\">Unfortunately, the formal description of the task turned out to be too long, so here is the legend.</span></p><p>Research rover finally reached the surface of Mars and is ready to complete its mission. Unfortunately, due to the mistake in the navigation system design, the rover is located in the wrong place.</p><p>The rover will operate on the grid consisting of <span class=\"tex-span\"><i>n</i></span> rows and <span class=\"tex-span\"><i>m</i></span> columns. We will define as <span class=\"tex-span\">(<i>r</i>,\u2009<i>c</i>)</span> the cell located in the row <span class=\"tex-span\"><i>r</i></span> and column <span class=\"tex-span\"><i>c</i></span>. From each cell the rover is able to move to any cell that share a side with the current one.</p><p>The rover is currently located at cell <span class=\"tex-span\">(1,\u20091)</span> and has to move to the cell <span class=\"tex-span\">(<i>n</i>,\u2009<i>m</i>)</span>. It will randomly follow some <span class=\"tex-font-style-bf\">shortest path</span> between these two cells. Each possible way is chosen equiprobably.</p><p>The cargo section of the rover contains the battery required to conduct the research. Initially, the battery charge is equal to <span class=\"tex-span\"><i>s</i></span> units of energy.</p><p>Some of the cells contain anomaly. Each time the rover gets to the cell with anomaly, the battery looses half of its charge rounded down. Formally, if the charge was equal to <span class=\"tex-span\"><i>x</i></span> before the rover gets to the cell with anomaly, the charge will change to <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/f12f73ab57d327f2f2cb7c8de54e8e6e246f6b2e.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p><p>While the rover picks a random shortest path to proceed, compute the expected value of the battery charge after it reaches cell <span class=\"tex-span\">(<i>n</i>,\u2009<i>m</i>)</span>. If the cells <span class=\"tex-span\">(1,\u20091)</span> and <span class=\"tex-span\">(<i>n</i>,\u2009<i>m</i>)</span> contain anomaly, they also affect the charge of the battery.</p>",
    "inputSpecification": "<p>The first line of the input contains four integers <span class=\"tex-span\"><i>n</i></span>, <span class=\"tex-span\"><i>m</i></span>, <span class=\"tex-span\"><i>k</i></span> and <span class=\"tex-span\"><i>s</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>\u2009\u2264\u2009100\u2009000</span>, <span class=\"tex-span\">0\u2009\u2264\u2009<i>k</i>\u2009\u2264\u20092000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>s</i>\u2009\u2264\u20091\u2009000\u2009000</span>)\u00a0\u2014 the number of rows and columns of the field, the number of cells with anomaly and the initial charge of the battery respectively.</p><p>The follow <span class=\"tex-span\"><i>k</i></span> lines containing two integers <span class=\"tex-span\"><i>r</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>r</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>m</i></span>)\u00a0\u2014 coordinates of the cells, containing anomaly. It's guaranteed that each cell appears in this list no more than once.</p>",
    "outputSpecification": "<p>The answer can always be represented as an irreducible fraction <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/46898f7da6d890f88194a3d5535e5e990ecdd3fa.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. Print the only integer <span class=\"tex-span\"><i>P</i>\u00b7<i>Q</i><sup class=\"upper-index\">\u2009-\u20091</sup></span> modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>.</p>",
    "samples": [
        {
            "input": "3 3 2 11<br/>2 1<br/>2 3<br/>",
            "output": "333333342<br/>"
        },
        {
            "input": "4 5 3 17<br/>1 2<br/>3 3<br/>4 1<br/>",
            "output": "514285727<br/>"
        },
        {
            "input": "1 6 2 15<br/>1 1<br/>1 5<br/>",
            "output": "4<br/>"
        }
    ],
    "note": "<p>In the first sample, the rover picks one of the following six routes:</p><ol> <li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/c9ec158c30775d6289140a3854e05168b09af399.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, after passing cell <span class=\"tex-span\">(2,\u20093)</span> charge is equal to <span class=\"tex-span\">6</span>. </li><li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/fcc490c05d2acb731046a7c4c861f4c9ebff3633.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, after passing cell <span class=\"tex-span\">(2,\u20093)</span> charge is equal to <span class=\"tex-span\">6</span>. </li><li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/8d5828aadc35714d7a3453c40de81ad186e87ab3.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, charge remains unchanged and equals <span class=\"tex-span\">11</span>. </li><li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/3bc680a61ca3712bbbec0eb682f3af16ab7664a2.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, after passing cells <span class=\"tex-span\">(2,\u20091)</span> and <span class=\"tex-span\">(2,\u20093)</span> charge equals <span class=\"tex-span\">6</span> and then <span class=\"tex-span\">3</span>. </li><li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/9a87005ef2b3eb1efc9e486e608fadf3a5b557fa.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, after passing cell <span class=\"tex-span\">(2,\u20091)</span> charge is equal to <span class=\"tex-span\">6</span>. </li><li> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/342ddbff927874c07e9d307d73383aa50f2117b6.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, after passing cell <span class=\"tex-span\">(2,\u20091)</span> charge is equal to <span class=\"tex-span\">6</span>. </li></ol><p>Expected value of the battery charge is calculated by the following formula:</p><p><img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/7ddca3ad80b71df649b7beb01944a4ad8f863265.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p><p>Thus <span class=\"tex-span\"><i>P</i>\u2009=\u200919</span>, and <span class=\"tex-span\"><i>Q</i>\u2009=\u20093</span>.</p><p><span class=\"tex-span\">3<sup class=\"upper-index\">\u2009-\u20091</sup></span> modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span> equals <span class=\"tex-span\">333333336</span>.</p><p><span class=\"tex-span\">19\u00b7333333336\u2009=\u2009333333342\u00a0(<i>mod</i>\u00a010<sup class=\"upper-index\">9</sup>\u2009+\u20097)</span></p>",
    "contestId": 722,
    "index": "E",
    "name": "Research Rover",
    "type": "PROGRAMMING",
    "tags": [
        "combinatorics",
        "dp"
    ],
    "solvedCount": 802
}