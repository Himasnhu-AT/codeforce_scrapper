{
    "title": "E. Flow Optimality",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>There is a computer network consisting of <span class=\"tex-span\"><i>n</i></span> nodes numbered 1 through <span class=\"tex-span\"><i>n</i></span>. There are links in the network that connect pairs of nodes. A pair of nodes may have multiple links between them, but no node has a link to itself.</p><p>Each link supports unlimited bandwidth (in either direction), however a link may only transmit in a single direction at any given time. The cost of sending data across a link is proportional to the square of the bandwidth. Specifically, each link has a positive weight, and the cost of sending data across the link is the weight times the square of the bandwidth.</p><p>The network is connected (there is a series of links from any node to any other node), and furthermore designed to remain connected in the event of any single node failure.</p><p>You needed to send data from node 1 to node <span class=\"tex-span\"><i>n</i></span> at a bandwidth of some positive number <span class=\"tex-span\"><i>k</i></span>. That is, you wish to assign a bandwidth to each link so that the bandwidth into a node minus the bandwidth out of a node is <span class=\"tex-span\">\u2009-\u2009<i>k</i></span> for node 1, <span class=\"tex-span\"><i>k</i></span> for node <span class=\"tex-span\"><i>n</i></span>, and 0 for all other nodes. The individual bandwidths do not need to be integers.</p><p>Wishing to minimize the total cost, you drew a diagram of the network, then gave the task to an intern to solve. The intern claimed to have solved the task and written the optimal bandwidths on your diagram, but then spilled coffee on it, rendering much of it unreadable (including parts of the original diagram, and the value of <span class=\"tex-span\"><i>k</i></span>).</p><p>From the information available, determine if the intern's solution may have been optimal. That is, determine if there exists a valid network, total bandwidth, and optimal solution which is a superset of the given information. Furthermore, determine the efficiency of the intern's solution (if possible), where efficiency is defined as total cost divided by total bandwidth.</p>",
    "inputSpecification": "<p>Input will begin with two integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u2009200000</span>; <span class=\"tex-span\">0\u2009\u2264\u2009<i>m</i>\u2009\u2264\u2009200000</span>), the number of nodes and number of known links in the network, respectively. Following this are <span class=\"tex-span\"><i>m</i></span> lines with four integers each: <span class=\"tex-span\"><i>f</i></span>, <span class=\"tex-span\"><i>t</i></span>, <span class=\"tex-span\"><i>w</i></span>, <span class=\"tex-span\"><i>b</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>f</i>\u2009\u2264\u2009<i>n</i>;\u00a01\u2009\u2264\u2009<i>t</i>\u2009\u2264\u2009<i>n</i>;\u00a0<i>f</i>\u2009\u2260\u2009<i>t</i>;\u00a01\u2009\u2264\u2009<i>w</i>\u2009\u2264\u2009100;\u00a00\u2009\u2264\u2009<i>b</i>\u2009\u2264\u2009100</span>). This indicates there is a link between nodes <span class=\"tex-span\"><i>f</i></span> and <span class=\"tex-span\"><i>t</i></span> with weight <span class=\"tex-span\"><i>w</i></span> and carrying <span class=\"tex-span\"><i>b</i></span> bandwidth. The direction of bandwidth is from <span class=\"tex-span\"><i>f</i></span> to <span class=\"tex-span\"><i>t</i></span>.</p>",
    "outputSpecification": "<p>If the intern's solution is definitely not optimal, print \"BAD <span class=\"tex-span\"><i>x</i></span>\", where <span class=\"tex-span\"><i>x</i></span> is the first link in the input that violates the optimality of the solution. If the intern's solution may be optimal, print the efficiency of the solution if it can be determined rounded to the nearest integer, otherwise print \"UNKNOWN\".</p>",
    "samples": [
        {
            "input": "4 5<br/>1 2 1 2<br/>1 3 4 1<br/>2 3 2 1<br/>2 4 4 1<br/>3 4 1 2<br/>",
            "output": "6<br/>"
        },
        {
            "input": "5 5<br/>2 3 1 1<br/>3 4 1 1<br/>4 2 1 1<br/>1 5 1 1<br/>1 5 100 100<br/>",
            "output": "BAD 3<br/>"
        },
        {
            "input": "6 4<br/>1 3 31 41<br/>1 5 59 26<br/>2 6 53 58<br/>4 6 97 93<br/>",
            "output": "UNKNOWN<br/>"
        },
        {
            "input": "7 5<br/>1 7 2 1<br/>2 3 1 1<br/>4 5 1 0<br/>6 1 10 0<br/>1 3 1 1<br/>",
            "output": "BAD 4<br/>"
        }
    ],
    "note": "<p>Although the known weights and bandwidths happen to always be integers, the weights and bandwidths of the remaining links are not restricted to integers.</p>",
    "contestId": 457,
    "index": "E",
    "name": "Flow Optimality",
    "type": "PROGRAMMING",
    "tags": [
        "constructive algorithms",
        "flows",
        "math"
    ],
    "solvedCount": 83
}