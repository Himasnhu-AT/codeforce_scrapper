{
    "title": "C. LionAge II",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Vasya plays the LionAge II. He was bored of playing with a stupid computer, so he installed this popular MMORPG, to fight with his friends. Vasya came up with the name of his character \u2014 non-empty string <span class=\"tex-span\"><i>s</i></span>, consisting of a lowercase Latin letters. However, in order not to put up a front of friends, Vasya has decided to change no more than <span class=\"tex-span\"><i>k</i></span> letters of the character name so that the new name sounded as good as possible. Euphony of the line is defined as follows: for each pair of adjacent letters <span class=\"tex-span\"><i>x</i></span> and <span class=\"tex-span\"><i>y</i></span> (<span class=\"tex-span\"><i>x</i></span> immediately precedes <span class=\"tex-span\"><i>y</i></span>) the bonus <span class=\"tex-span\"><i>c</i>(<i>x</i>,\u2009<i>y</i>)</span> is added to the result. Your task is to determine what the greatest Euphony can be obtained by changing at most <span class=\"tex-span\"><i>k</i></span> letters in the name of the Vasya's character.</p>",
    "inputSpecification": "<p>The first line contains character's name <span class=\"tex-span\"><i>s</i></span> and an integer number <span class=\"tex-span\"><i>k</i></span> (<span class=\"tex-span\">0\u2009\u2264\u2009<i>k</i>\u2009\u2264\u2009100</span>). The length of the nonempty string <span class=\"tex-span\"><i>s</i></span> does not exceed <span class=\"tex-span\">100</span>. The second line contains an integer number <span class=\"tex-span\"><i>n</i></span> (<span class=\"tex-span\">0\u2009\u2264\u2009<i>n</i>\u2009\u2264\u2009676</span>) \u2014 amount of pairs of letters, giving bonus to the euphony. The next <span class=\"tex-span\"><i>n</i></span> lines contain description of these pairs \u00ab<span class=\"tex-span\"><i>x</i></span> <span class=\"tex-span\"><i>y</i></span> <span class=\"tex-span\"><i>c</i></span>\u00bb, which means that sequence <span class=\"tex-span\"><i>xy</i></span> gives bonus <span class=\"tex-span\"><i>c</i></span> (<span class=\"tex-span\"><i>x</i>,\u2009<i>y</i></span> \u2014 lowercase Latin letters, <span class=\"tex-span\">\u2009-\u20091000\u2009\u2264\u2009<i>c</i>\u2009\u2264\u20091000)</span>. It is guaranteed that no pair <span class=\"tex-span\"><i>x</i></span> <span class=\"tex-span\"><i>y</i></span> mentioned twice in the input data.</p>",
    "outputSpecification": "<p>Output the only number \u2014 maximum possible euphony \u043ef the new character's name.</p>",
    "samples": [
        {
            "input": "winner 4<br/>4<br/>s e 7<br/>o s 8<br/>l o 13<br/>o o 8<br/>",
            "output": "36"
        },
        {
            "input": "abcdef 1<br/>5<br/>a b -10<br/>b c 5<br/>c d 5<br/>d e 5<br/>e f 5<br/>",
            "output": "20"
        }
    ],
    "note": "<p>In the first example the most euphony name will be <span class=\"tex-span\"><i>looser</i></span>. It is easy to calculate that its euphony is 36.</p>",
    "contestId": 73,
    "index": "C",
    "name": "LionAge II",
    "type": "PROGRAMMING",
    "tags": [
        "dp"
    ],
    "solvedCount": 2066
}