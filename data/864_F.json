{
    "title": "F. Cities Excursions",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>There are <span class=\"tex-span\"><i>n</i></span> cities in Berland. Some pairs of them are connected with <span class=\"tex-span\"><i>m</i></span> directed roads. One can use only these roads to move from one city to another. There are no roads that connect a city to itself. For each pair of cities <span class=\"tex-span\">(<i>x</i>,\u2009<i>y</i>)</span> there is at most one road from <span class=\"tex-span\"><i>x</i></span> to <span class=\"tex-span\"><i>y</i></span>.</p><p>A path from city <span class=\"tex-span\"><i>s</i></span> to city <span class=\"tex-span\"><i>t</i></span> is a sequence of cities <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">1</sub></span>, <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">2</sub></span>, ... , <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>k</i></sub></span>, where <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">1</sub>\u2009=\u2009<i>s</i></span>, <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>k</i></sub>\u2009=\u2009<i>t</i></span>, and there is a road from city <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub></span> to city <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i>\u2009+\u20091</sub></span> for each <span class=\"tex-span\"><i>i</i></span> from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>k</i>\u2009-\u20091</span>. The path can pass multiple times through each city except <span class=\"tex-span\"><i>t</i></span>. It can't pass through <span class=\"tex-span\"><i>t</i></span> more than once.</p><p>A path <span class=\"tex-span\"><i>p</i></span> from <span class=\"tex-span\"><i>s</i></span> to <span class=\"tex-span\"><i>t</i></span> is <span class=\"tex-font-style-it\">ideal</span> if it is the lexicographically minimal such path. In other words, <span class=\"tex-span\"><i>p</i></span> is <span class=\"tex-font-style-it\">ideal</span> path from <span class=\"tex-span\"><i>s</i></span> to <span class=\"tex-span\"><i>t</i></span> if for any other path <span class=\"tex-span\"><i>q</i></span> from <span class=\"tex-span\"><i>s</i></span> to <span class=\"tex-span\"><i>t</i></span> <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub>\u2009&lt;\u2009<i>q</i><sub class=\"lower-index\"><i>i</i></sub></span>, where <span class=\"tex-span\"><i>i</i></span> is the minimum integer such that <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2260\u2009<i>q</i><sub class=\"lower-index\"><i>i</i></sub></span>.</p><p>There is a tourist agency in the country that offers <span class=\"tex-span\"><i>q</i></span> unusual excursions: the <span class=\"tex-span\"><i>j</i></span>-th excursion starts at city <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> and ends in city <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>. </p><p>For each pair <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span>, <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span> help the agency to study the ideal path from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>. Note that it is possible that there is no ideal path from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>. This is possible due to two reasons: </p><ul> <li> there is no path from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>; </li><li> there are paths from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>, but for every such path <span class=\"tex-span\"><i>p</i></span> there is another path <span class=\"tex-span\"><i>q</i></span> from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>, such that <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub>\u2009&gt;\u2009<i>q</i><sub class=\"lower-index\"><i>i</i></sub></span>, where <span class=\"tex-span\"><i>i</i></span> is the minimum integer for which <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2260\u2009<i>q</i><sub class=\"lower-index\"><i>i</i></sub></span>. </li></ul><p>The agency would like to know for the ideal path from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span> the <span class=\"tex-span\"><i>k</i><sub class=\"lower-index\"><i>j</i></sub></span>-th city in that path (on the way from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>).</p><p>For each triple <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span>, <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>, <span class=\"tex-span\"><i>k</i><sub class=\"lower-index\"><i>j</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>j</i>\u2009\u2264\u2009<i>q</i></span>) find if there is an ideal path from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span> and print the <span class=\"tex-span\"><i>k</i><sub class=\"lower-index\"><i>j</i></sub></span>-th city in that path, if there is any.</p>",
    "inputSpecification": "<p>The first line contains three integers <span class=\"tex-span\"><i>n</i></span>, <span class=\"tex-span\"><i>m</i></span> and <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u20093000</span>,<span class=\"tex-span\">0\u2009\u2264\u2009<i>m</i>\u2009\u2264\u20093000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u20094\u00b710<sup class=\"upper-index\">5</sup></span>) \u2014 the number of cities, the number of roads and the number of excursions.</p><p>Each of the next <span class=\"tex-span\"><i>m</i></span> lines contains two integers <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>x</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>y</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2260\u2009<i>y</i><sub class=\"lower-index\"><i>i</i></sub></span>), denoting that the <span class=\"tex-span\"><i>i</i></span>-th road goes from city <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\"><i>i</i></sub></span> to city <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\"><i>i</i></sub></span>. All roads are one-directional. There can't be more than one road in each direction between two cities.</p><p>Each of the next <span class=\"tex-span\"><i>q</i></span> lines contains three integers <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span>, <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span> and <span class=\"tex-span\"><i>k</i><sub class=\"lower-index\"><i>j</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>s</i><sub class=\"lower-index\"><i>j</i></sub>,\u2009<i>t</i><sub class=\"lower-index\"><i>j</i></sub>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub>\u2009\u2260\u2009<i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>k</i><sub class=\"lower-index\"><i>j</i></sub>\u2009\u2264\u20093000</span>).</p>",
    "outputSpecification": "<p>In the <span class=\"tex-span\"><i>j</i></span>-th line print the city that is the <span class=\"tex-span\"><i>k</i><sub class=\"lower-index\"><i>j</i></sub></span>-th in the ideal path from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>. If there is no ideal path from <span class=\"tex-span\"><i>s</i><sub class=\"lower-index\"><i>j</i></sub></span> to <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>j</i></sub></span>, or the integer <span class=\"tex-span\"><i>k</i><sub class=\"lower-index\"><i>j</i></sub></span> is greater than the length of this path, print the string '<span class=\"tex-font-style-tt\">-1</span>' (without quotes) in the <span class=\"tex-span\"><i>j</i></span>-th line.</p>",
    "samples": [
        {
            "input": "7 7 5<br/>1 2<br/>2 3<br/>1 3<br/>3 4<br/>4 5<br/>5 3<br/>4 6<br/>1 4 2<br/>2 6 1<br/>1 7 3<br/>1 3 2<br/>1 3 5<br/>",
            "output": "2<br/>-1<br/>-1<br/>2<br/>-1<br/>"
        }
    ],
    "note": null,
    "contestId": 864,
    "index": "F",
    "name": "Cities Excursions",
    "type": "PROGRAMMING",
    "tags": [
        "dfs and similar",
        "graphs",
        "trees"
    ],
    "solvedCount": 581
}