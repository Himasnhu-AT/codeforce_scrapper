{
    "title": "E. Surprise me!",
    "timeLimit": {
        "value": 8.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Tired of boring dates, Leha and Noora decided to play a game.</p><p>Leha found a tree with <span class=\"tex-span\"><i>n</i></span> vertices numbered from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>n</i></span>. We remind you that tree is an undirected graph without cycles. Each vertex <span class=\"tex-span\"><i>v</i></span> of a tree has a number <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>v</i></sub></span> written on it. Quite by accident it turned out that all values written on vertices are distinct and are natural numbers between <span class=\"tex-span\">1</span> and <span class=\"tex-span\"><i>n</i></span>.</p><p>The game goes in the following way. Noora chooses some vertex <span class=\"tex-span\"><i>u</i></span> of a tree uniformly at random and passes a move to Leha. Leha, in his turn, chooses (also uniformly at random) some vertex <span class=\"tex-span\"><i>v</i></span> from remaining vertices of a tree <span class=\"tex-span\">(<i>v</i>\u2009\u2260\u2009<i>u</i>)</span>. As you could guess there are <span class=\"tex-span\"><i>n</i>(<i>n</i>\u2009-\u20091)</span> variants of choosing vertices by players. After that players calculate the value of a function <span class=\"tex-span\"><i>f</i>(<i>u</i>,\u2009<i>v</i>)\u2009=\u2009\u03c6(<i>a</i><sub class=\"lower-index\"><i>u</i></sub>\u00b7<i>a</i><sub class=\"lower-index\"><i>v</i></sub>)</span> <span class=\"tex-span\">\u00b7</span> <span class=\"tex-span\"><i>d</i>(<i>u</i>,\u2009<i>v</i>)</span> of the chosen vertices where <span class=\"tex-span\">\u03c6(<i>x</i>)</span> is Euler's totient function and <span class=\"tex-span\"><i>d</i>(<i>x</i>,\u2009<i>y</i>)</span> is the shortest distance between vertices <span class=\"tex-span\"><i>x</i></span> and <span class=\"tex-span\"><i>y</i></span> in a tree.</p><p>Soon the game became boring for Noora, so Leha decided to defuse the situation and calculate expected value of function <span class=\"tex-span\"><i>f</i></span> over all variants of choosing vertices <span class=\"tex-span\"><i>u</i></span> and <span class=\"tex-span\"><i>v</i></span>, hoping of at least somehow surprise the girl.</p><p>Leha asks for your help in calculating this expected value. Let this value be representable in the form of an irreducible fraction <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/b795551c4ba5b501281e7063ac11feb87c7f234f.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. To further surprise Noora, he wants to name her the value <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/5fdcffd2f508399487ae266723b116faf2fcef30.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. </p><p>Help Leha!</p>",
    "inputSpecification": "<p>The first line of input contains one integer number <span class=\"tex-span\"><i>n</i></span> <span class=\"tex-span\">(2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u20092\u00b710<sup class=\"upper-index\">5</sup>)</span> \u00a0\u2014 number of vertices in a tree.</p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> different numbers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i>)</span> separated by spaces, denoting the values written on a tree vertices.</p><p>Each of the next <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> lines contains two integer numbers <span class=\"tex-span\"><i>x</i></span> and <span class=\"tex-span\"><i>y</i></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>x</i>,\u2009<i>y</i>\u2009\u2264\u2009<i>n</i>)</span>, describing the next edge of a tree. It is guaranteed that this set of edges describes a tree.</p>",
    "outputSpecification": "<p>In a single line print a number equal to <span class=\"tex-span\"><i>P</i>\u00b7<i>Q</i><sup class=\"upper-index\">\u2009-\u20091</sup></span> modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>.</p>",
    "samples": [
        {
            "input": "3<br/>1 2 3<br/>1 2<br/>2 3<br/>",
            "output": "333333338<br/>"
        },
        {
            "input": "5<br/>5 4 3 1 2<br/>3 5<br/>1 2<br/>4 3<br/>2 5<br/>",
            "output": "8<br/>"
        }
    ],
    "note": "<p>Euler's totient function <span class=\"tex-span\">\u03c6(<i>n</i>)</span> is the number of such <span class=\"tex-span\"><i>i</i></span> that <span class=\"tex-span\">1\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009<i>n</i></span>,and <span class=\"tex-span\"><i>gcd</i>(<i>i</i>,\u2009<i>n</i>)\u2009=\u20091</span>, where <span class=\"tex-span\"><i>gcd</i>(<i>x</i>,\u2009<i>y</i>)</span> is the greatest common divisor of numbers <span class=\"tex-span\"><i>x</i></span> and <span class=\"tex-span\"><i>y</i></span>.</p><p>There are <span class=\"tex-span\">6</span> variants of choosing vertices by Leha and Noora in the first testcase:</p><ul> <li> <span class=\"tex-span\"><i>u</i>\u2009=\u20091</span>, <span class=\"tex-span\"><i>v</i>\u2009=\u20092</span>, <span class=\"tex-span\"><i>f</i>(1,\u20092)\u2009=\u2009\u03c6(<i>a</i><sub class=\"lower-index\">1</sub>\u00b7<i>a</i><sub class=\"lower-index\">2</sub>)\u00b7<i>d</i>(1,\u20092)\u2009=\u2009\u03c6(1\u00b72)\u00b71\u2009=\u2009\u03c6(2)\u2009=\u20091</span> </li><li> <span class=\"tex-span\"><i>u</i>\u2009=\u20092</span>, <span class=\"tex-span\"><i>v</i>\u2009=\u20091</span>, <span class=\"tex-span\"><i>f</i>(2,\u20091)\u2009=\u2009<i>f</i>(1,\u20092)\u2009=\u20091</span> </li><li> <span class=\"tex-span\"><i>u</i>\u2009=\u20091</span>, <span class=\"tex-span\"><i>v</i>\u2009=\u20093</span>, <span class=\"tex-span\"><i>f</i>(1,\u20093)\u2009=\u2009\u03c6(<i>a</i><sub class=\"lower-index\">1</sub>\u00b7<i>a</i><sub class=\"lower-index\">3</sub>)\u00b7<i>d</i>(1,\u20093)\u2009=\u2009\u03c6(1\u00b73)\u00b72\u2009=\u20092\u03c6(3)\u2009=\u20094</span> </li><li> <span class=\"tex-span\"><i>u</i>\u2009=\u20093</span>, <span class=\"tex-span\"><i>v</i>\u2009=\u20091</span>, <span class=\"tex-span\"><i>f</i>(3,\u20091)\u2009=\u2009<i>f</i>(1,\u20093)\u2009=\u20094</span> </li><li> <span class=\"tex-span\"><i>u</i>\u2009=\u20092</span>, <span class=\"tex-span\"><i>v</i>\u2009=\u20093</span>, <span class=\"tex-span\"><i>f</i>(2,\u20093)\u2009=\u2009\u03c6(<i>a</i><sub class=\"lower-index\">2</sub>\u00b7<i>a</i><sub class=\"lower-index\">3</sub>)\u00b7<i>d</i>(2,\u20093)\u2009=\u2009\u03c6(2\u00b73)\u00b71\u2009=\u2009\u03c6(6)\u2009=\u20092</span> </li><li> <span class=\"tex-span\"><i>u</i>\u2009=\u20093</span>, <span class=\"tex-span\"><i>v</i>\u2009=\u20092</span>, <span class=\"tex-span\"><i>f</i>(3,\u20092)\u2009=\u2009<i>f</i>(2,\u20093)\u2009=\u20092</span> </li></ul><p>Expected value equals to <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/e5c8809aa28b9319e77ed361e7711c28644edfce.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. The value Leha wants to name Noora is <span class=\"tex-span\">7\u00b73<sup class=\"upper-index\">\u2009-\u20091</sup>\u2009=\u20097\u00b7333333336\u2009=\u2009333333338</span> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/421838b34eb0a8d7fc745c94f007a8c65740bae0.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p><p>In the second testcase expected value equals to <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/cdddc429b0ddf9284f5ecd4a6f5acc0f24270016.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, so Leha will have to surprise Hoora by number <span class=\"tex-span\">8\u00b71<sup class=\"upper-index\">\u2009-\u20091</sup>\u2009=\u20098</span> <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/421838b34eb0a8d7fc745c94f007a8c65740bae0.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p>",
    "contestId": 809,
    "index": "E",
    "name": "Surprise me!",
    "type": "PROGRAMMING",
    "tags": [
        "divide and conquer",
        "math",
        "number theory",
        "trees"
    ],
    "solvedCount": 723
}