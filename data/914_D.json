{
    "title": "D. Bash and a Tough Math Puzzle",
    "timeLimit": {
        "value": 2.5,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Bash likes playing with arrays. He has an array <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009... <i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> of <span class=\"tex-span\"><i>n</i></span> integers. He likes to guess the greatest common divisor (gcd) of different segments of the array. Of course, sometimes the guess is not correct. However, Bash will be satisfied if his guess is <span class=\"tex-font-style-it\">almost correct</span>.</p><p>Suppose he guesses that the gcd of the elements in the range <span class=\"tex-span\">[<i>l</i>,\u2009<i>r</i>]</span> of <span class=\"tex-span\"><i>a</i></span> is <span class=\"tex-span\"><i>x</i></span>. He considers the guess to be almost correct if he can change <span class=\"tex-font-style-bf\">at most</span> one element in the segment such that the gcd of the segment is <span class=\"tex-span\"><i>x</i></span> after making the change. Note that when he guesses, he doesn't actually change the array \u2014 he just wonders if the gcd of the segment can be made <span class=\"tex-span\"><i>x</i></span>. Apart from this, he also sometimes makes changes to the array itself.</p><p>Since he can't figure it out himself, Bash wants you to tell him which of his guesses are almost correct. Formally, you have to process <span class=\"tex-span\"><i>q</i></span> queries of one of the following forms:</p><ul> <li> <span class=\"tex-span\">1\u2009<i>l</i>\u2009<i>r</i>\u2009<i>x</i></span> \u2014 Bash guesses that the gcd of the range <span class=\"tex-span\">[<i>l</i>,\u2009<i>r</i>]</span> is <span class=\"tex-span\"><i>x</i></span>. Report if this guess is almost correct. </li><li> <span class=\"tex-span\">2\u2009<i>i</i>\u2009<i>y</i></span> \u2014 Bash sets <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span> to <span class=\"tex-span\"><i>y</i></span>. </li></ul><p><span class=\"tex-font-style-bf\">Note:</span> The array is <span class=\"tex-span\">1</span>-indexed.</p>",
    "inputSpecification": "<p>The first line contains an integer <span class=\"tex-span\"><i>n</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>\u2009\u2264\u20095\u00b710<sup class=\"upper-index\">5</sup></span>) \u00a0\u2014 the size of the array.</p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u200910<sup class=\"upper-index\">9</sup></span>) \u00a0\u2014 the elements of the array.</p><p>The third line contains an integer <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u20094\u00b710<sup class=\"upper-index\">5</sup></span>) \u00a0\u2014 the number of queries.</p><p>The next <span class=\"tex-span\"><i>q</i></span> lines describe the queries and may have one of the following forms:</p><ul> <li> <span class=\"tex-span\">1\u2009<i>l</i>\u2009<i>r</i>\u2009<i>x</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>l</i>\u2009\u2264\u2009<i>r</i>\u2009\u2264\u2009<i>n</i>,\u20091\u2009\u2264\u2009<i>x</i>\u2009\u2264\u200910<sup class=\"upper-index\">9</sup></span>). </li><li> <span class=\"tex-span\">2\u2009<i>i</i>\u2009<i>y</i></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009<i>n</i>,\u20091\u2009\u2264\u2009<i>y</i>\u2009\u2264\u200910<sup class=\"upper-index\">9</sup>)</span>. </li></ul><p>Guaranteed, that there is at least one query of first type.</p>",
    "outputSpecification": "<p>For each query of first type, output <span class=\"tex-font-style-tt\">\"YES\"</span> (without quotes) if Bash's guess is almost correct and <span class=\"tex-font-style-tt\">\"NO\"</span> (without quotes) otherwise.</p>",
    "samples": [
        {
            "input": "3<br/>2 6 3<br/>4<br/>1 1 2 2<br/>1 1 3 3<br/>2 1 9<br/>1 1 3 2<br/>",
            "output": "YES<br/>YES<br/>NO<br/>"
        },
        {
            "input": "5<br/>1 2 3 4 5<br/>6<br/>1 1 4 2<br/>2 3 6<br/>1 1 4 2<br/>1 1 5 2<br/>2 5 10<br/>1 1 5 2<br/>",
            "output": "NO<br/>YES<br/>NO<br/>YES<br/>"
        }
    ],
    "note": "<p>In the first sample, the array initially is <span class=\"tex-span\">{2,\u20096,\u20093}</span>. </p><p>For query <span class=\"tex-span\">1</span>, the first two numbers already have their gcd as <span class=\"tex-span\">2</span>.</p><p>For query <span class=\"tex-span\">2</span>, we can achieve a gcd of <span class=\"tex-span\">3</span> by changing the first element of the array to <span class=\"tex-span\">3</span>. Note that the changes made during queries of type <span class=\"tex-span\">1</span> are temporary and do not get reflected in the array. </p><p>After query <span class=\"tex-span\">3</span>, the array is now <span class=\"tex-span\">{9,\u20096,\u20093}</span>.</p><p> For query <span class=\"tex-span\">4</span>, no matter which element you change, you cannot get the gcd of the range to be <span class=\"tex-span\">2</span>. </p>",
    "contestId": 914,
    "index": "D",
    "name": "Bash and a Tough Math Puzzle",
    "type": "PROGRAMMING",
    "tags": [
        "data structures",
        "number theory"
    ],
    "solvedCount": 5095
}