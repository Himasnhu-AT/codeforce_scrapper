{
    "title": "D. Flower-like Pseudotree",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>A <span class=\"tex-font-style-it\">pseudotree</span> is a connected graph which has <span class=\"tex-font-style-bf\">exactly one</span> cycle and <span class=\"tex-font-style-bf\">no</span> self-loops. Note that a pseudotree <span class=\"tex-font-style-bf\">may contain multiple-edges</span>. It can be shown that a pseudotree with $$$n$$$ vertices always contains $$$n$$$ edges.</p><p>After deleting all edges on the cycle in the pseudotree, a forest$$$^{\\dagger}$$$ will be formed. It can be shown that each tree in the forest will contain exactly one vertex which is on cycle before removing the edges. If all trees in the forest have the same depth$$$^{\\ddagger}$$$ when picking the vertex on cycle as root, we call the original pseudotree <span class=\"tex-font-style-it\">flower-like</span>.</p><p>Our friend sszcdjr, had a flower-like pseudotree with $$$n$$$ vertices and $$$n$$$ edges. However, he forgot all the edges in the pseudotree. Fortunately, he still remembers the degrees of vertices. Specifically, the degree of the $$$i$$$-th vertex is $$$d_i$$$.</p><p>You have to help sszcdjr construct a possible flower-like pseudotree with $$$n$$$ vertices, where the degree of the $$$i$$$-th vertex is <span class=\"tex-font-style-bf\">exactly</span> $$$d_i$$$, or tell him that it is impossible.</p><p>$$$^{\\dagger}$$$ A forest is a graph in which all connectivity components are trees. A connected graph without cycles and self-loops is called a tree.</p><p>$$$^{\\ddagger}$$$ The depth of a tree with a root is the maximum distance from the root to the vertex of this tree.</p>",
    "inputSpecification": "<p>The first line of the input contains a single integer $$$t$$$ ($$$1\\leq t\\leq 10^5$$$) \u2014 the number of test cases. The description of test cases follows.</p><p>The first line of each test case contains a single integer $$$n$$$ ($$$2\\leq n\\leq 10^6$$$) \u2014 the number of vertices.</p><p>The second line of each test case contains $$$n$$$ integers $$$d_1,d_2,\\ldots,d_n$$$ ($$$1\\leq d_i\\leq n$$$) \u2014 the degree of each vertex.</p><p>It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^6$$$.</p>",
    "outputSpecification": "<p>For each test case, if there exist a possible flower-like pseudotree:</p><ul> <li> Print \"<span class=\"tex-font-style-tt\">Yes</span>\" (without quotes) in the first line. </li><li> Then, output $$$n$$$ lines, in each line print two integers $$$u_i$$$ and $$$v_i$$$ \u2014 the two vertices that the $$$i$$$-th edge connects. </li></ul><p>If there are multiple answers, you may output any of them.</p><p>Otherwise, print \"<span class=\"tex-font-style-tt\">No</span>\" (without quotes) in the only line of output.</p><p>You can output the first line of each test case in any case (upper or lower). For example, the strings \"<span class=\"tex-font-style-tt\">yEs</span>\", \"<span class=\"tex-font-style-tt\">yes</span>\", \"<span class=\"tex-font-style-tt\">Yes</span>\", and \"<span class=\"tex-font-style-tt\">YES</span>\" will be recognized as positive responses.</p>",
    "samples": [
        {
            "input": "\n<div class=\"test-example-line test-example-line-even test-example-line-0\">6</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">3</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">2 2 2</div><div class=\"test-example-line test-example-line-even test-example-line-2\">4</div><div class=\"test-example-line test-example-line-even test-example-line-2\">1 2 3 4</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">7</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">4 3 3 1 1 1 1</div><div class=\"test-example-line test-example-line-even test-example-line-4\">6</div><div class=\"test-example-line test-example-line-even test-example-line-4\">1 1 2 2 3 3</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">10</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">1 1 5 2 1 1 1 1 1 6</div><div class=\"test-example-line test-example-line-even test-example-line-6\">9</div><div class=\"test-example-line test-example-line-even test-example-line-6\">1 1 3 1 1 4 1 1 5</div>",
            "output": "\nYes\n1 2\n2 3\n3 1\nNo\nYes\n1 2\n2 3\n3 1\n1 4\n1 5\n2 6\n3 7\nYes\n5 6\n6 5\n1 3\n2 4\n3 5\n4 6\nNo\nYes\n3 6\n6 9\n9 3\n1 3\n2 6\n4 6\n5 9\n7 9\n8 9\n"
        }
    ],
    "note": "<p>In the first test case, the only possible flower-like psuedotree is:</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/c974b4f2bbeecf54effb79216b16543e263c56eb.png\" style=\"max-width: 100.0%;max-height: 100.0%;\" width=\"227px\"/> </center><p>After deleting all edges on the cycle in the pseudotree, each tree has depth $$$0$$$.</p><p>In the second test case, it can be proven that there's no such flower-like psuedotree.</p><p>In the third test case, one of the possible flower-like psuedotrees is:</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/a6aad0c91e50164d03a39cfc751886bcde064ca6.png\" style=\"max-width: 100.0%;max-height: 100.0%;\" width=\"227px\"/> </center>",
    "contestId": 1868,
    "index": "D",
    "name": "Flower-like Pseudotree",
    "type": "PROGRAMMING",
    "tags": [
        "constructive algorithms",
        "graphs",
        "greedy",
        "implementation",
        "trees"
    ],
    "solvedCount": 251
}