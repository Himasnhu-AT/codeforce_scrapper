{
    "title": "I. Infinite Chess",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>The black king lives on a chess board with an infinite number of columns (files) and $$$8$$$ rows (ranks). The columns are numbered with all integer numbers (including negative). The rows are numbered from $$$1$$$ to\u00a0$$$8$$$.</p><p>Initially, the black king is located on the starting square $$$(x_s, y_s)$$$, and he needs to reach some target square $$$(x_t, y_t)$$$. Unfortunately, there are also white pieces on the board, and they threaten the black king. After negotiations, the white pieces agreed to let the black king pass to the target square on the following conditions:</p><ul> <li> each turn, the black king makes a move according to the movement rules; </li><li> the black king cannot move to a square occupied by a white piece; </li><li> the black king cannot move to a square which is under attack by any white piece. A square is under attack if a white piece can reach it in one move according to the movement rules; </li><li> the white pieces never move. </li></ul><p>Help the black king find the minimum number of moves needed to reach the target square while not violating the conditions. The black king cannot leave the board at any time.</p><p>The black king moves according to the movement rules below. Even though the white pieces never move, squares which they can reach in one move are considered to be under attack, so the black king cannot move into those squares.</p><p>Below are the movement rules. Note that the pieces (except for the knight) cannot jump over other pieces.</p><ul> <li> a king moves exactly one square horizontally, vertically, or diagonally. </li><li> a rook moves any number of vacant squares horizontally or vertically. </li><li> a bishop moves any number of vacant squares diagonally. </li><li> a queen moves any number of vacant squares horizontally, vertically, or diagonally. </li><li> a knight moves to one of the nearest squares not on the same rank, file, or diagonal (this can be thought of as moving two squares horizontally then one square vertically, or moving one square horizontally then two squares vertically \u2014 i.\u2009e. in an \"L\" pattern). Knights are not blocked by other pieces, they can simply jump over them. </li></ul><p>There are no pawns on the board.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/ef96c034c1c6a875e9570e6af92e962797ae57a4.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><center> <span class=\"tex-font-size-small\">King and knight possible moves, respectively. Dotted line shows that knight can jump over other pieces.</span> </center><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/0fd999b1fb77cbb6ff61afaf64df52add433400d.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><center> <span class=\"tex-font-size-small\">Queen, bishop, and rook possible moves, respectively.</span> </center>",
    "inputSpecification": "<p>The first line contains two integers $$$x_s$$$ and $$$y_s$$$ ($$$1 \\le x_s \\le 10^8$$$; $$$1 \\le y_s \\le 8$$$) \u2014 the starting coordinates of the black king.</p><p>The second line contains two integers $$$x_t$$$ and $$$y_t$$$ ($$$1 \\le x_t \\le 10^8$$$; $$$1 \\le y_t \\le 8$$$) \u2014 the coordinates of the target square for the black king.</p><p>The third line contains one integer $$$n$$$ ($$$0 \\le n \\le 2000$$$) \u2014 the number of white pieces on the board.</p><p>Then $$$n$$$ lines follow, the $$$i$$$-th line contains one character $$$t_i$$$ and two integers $$$x_i$$$ and $$$y_i$$$ ($$$1 \\le x_i \\le 10^8$$$; $$$1 \\le y_i \\le 8$$$) \u2014 the type and the coordinates of the $$$i$$$-th white piece. The types of pieces are represented by the following uppercase Latin letters:</p><ul> <li> <span class=\"tex-font-style-tt\">K</span> \u2014 king </li><li> <span class=\"tex-font-style-tt\">Q</span> \u2014 queen </li><li> <span class=\"tex-font-style-tt\">R</span> \u2014 rook </li><li> <span class=\"tex-font-style-tt\">B</span> \u2014 bishop </li><li> <span class=\"tex-font-style-tt\">N</span> \u2014 knight </li></ul><p>There can be any number of white pieces of any type listed above on the board, for example, $$$3$$$ white kings or $$$4$$$ white queens. There are no pawns on the board.</p><p>Additional constrains on the input:</p><ul> <li> no square is occupied by more than one white piece; </li><li> the starting square for the black king is different from the square he wants to reach, and neither of these two squares is occupied or is under attack by any white piece. </li></ul>",
    "outputSpecification": "<p>Print one integer \u2014 the minimum number of moves needed for the black king to reach the target square while not violating the conditions, or $$$-1$$$ if it is impossible.</p>",
    "samples": [
        {
            "input": "\n1 8\n7 8\n2\nN 4 8\nB 4 6\n",
            "output": "\n10\n"
        },
        {
            "input": "\n1 1\n1 5\n2\nK 1 3\nR 2 3\n",
            "output": "\n6\n"
        },
        {
            "input": "\n2 2\n6 4\n1\nQ 4 3\n",
            "output": "\n-1\n"
        }
    ],
    "note": "<p>The image below demonstrates the solution for the second example. Here, the letters <span class=\"tex-font-style-tt\">K</span>, <span class=\"tex-font-style-tt\">R</span>, <span class=\"tex-font-style-tt\">s</span>, and <span class=\"tex-font-style-tt\">t</span> represent the white king, the white rook, the starting square, and the target square, respectively. Bold crosses mark the squares which are under attack by the white pieces. Bold dots show the shortest path for the black king.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/75e053d80447b9c40356ecf9d14366cf30be3a74.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center>",
    "contestId": 1765,
    "index": "I",
    "name": "Infinite Chess",
    "type": "PROGRAMMING",
    "tags": [
        "implementation",
        "shortest paths"
    ],
    "solvedCount": 183
}