{
    "title": "B. Maximum Sum",
    "timeLimit": {
        "value": 1.0,
        "unit": "second"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You have an array $$$a$$$ of $$$n$$$ integers.</p><p>You perform exactly $$$k$$$ operations on it. In one operation, you select any contiguous subarray of the array $$$a$$$ (possibly empty) and insert the sum of this subarray anywhere in the array.</p><p>Your task is to find the maximum possible sum of the array after $$$k$$$ such operations.</p><p>As this number can be very large, output the answer modulo $$$10^9 + 7$$$.</p><p>Reminder: the remainder of a number $$$x$$$ modulo $$$p$$$ is the smallest non-negative $$$y$$$ such that there exists an integer $$$q$$$ and $$$x = p \\cdot q + y$$$.</p>",
    "inputSpecification": "<p>Each test consists of several test cases. The first line contains a single integer $$$t$$$ ($$$1 \\le t \\le 10^4$$$)\u00a0\u2014 the number of test cases. Then follows the description of the test cases.</p><p>The first line of each test case contains two integers $$$n$$$ and $$$k$$$ ($$$1 \\le n, k \\le 2 \\cdot 10^5$$$)\u00a0\u2014 the length of the array $$$a$$$ and the number of operations, respectively.</p><p>The second line of each test case contains $$$n$$$ integers $$$a_1, a_2, \\ldots, a_n$$$ ($$$-10^9 \\le a_i \\le 10^9$$$)\u00a0\u2014 the array $$$a$$$ itself.</p><p>It is guaranteed that the sum of the values of $$$n$$$ and $$$k$$$ for all test cases does not exceed $$$2 \\cdot 10^5$$$.</p>",
    "outputSpecification": "<p>For each test, output a single integer\u00a0\u2014 the maximum sum of the array that can be obtained after $$$k$$$ operations modulo $$$10^9 + 7$$$.</p>",
    "samples": [
        {
            "input": "\n<div class=\"test-example-line test-example-line-even test-example-line-0\">12</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">2 2</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">-4 -7</div><div class=\"test-example-line test-example-line-even test-example-line-2\">3 3</div><div class=\"test-example-line test-example-line-even test-example-line-2\">2 2 8</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">1 7</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">7</div><div class=\"test-example-line test-example-line-even test-example-line-4\">5 1</div><div class=\"test-example-line test-example-line-even test-example-line-4\">4 -2 8 -12 9</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">7 4</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">8 14 -9 6 0 -1 3</div><div class=\"test-example-line test-example-line-even test-example-line-6\">7 100</div><div class=\"test-example-line test-example-line-even test-example-line-6\">5 3 -8 12 -5 -9 3</div><div class=\"test-example-line test-example-line-odd test-example-line-7\">6 1000</div><div class=\"test-example-line test-example-line-odd test-example-line-7\">-1000000000 -1000000000 -1000000000 -1000000000 -1000000000 -1000000000</div><div class=\"test-example-line test-example-line-even test-example-line-8\">2 1</div><div class=\"test-example-line test-example-line-even test-example-line-8\">1000000000 8</div><div class=\"test-example-line test-example-line-odd test-example-line-9\">5 4</div><div class=\"test-example-line test-example-line-odd test-example-line-9\">0 0 0 0 0</div><div class=\"test-example-line test-example-line-even test-example-line-10\">6 10</div><div class=\"test-example-line test-example-line-even test-example-line-10\">48973 757292 58277 -38574 27475 999984</div><div class=\"test-example-line test-example-line-odd test-example-line-11\">7 1</div><div class=\"test-example-line test-example-line-odd test-example-line-11\">-1000 1000 -1000 1000 -1000 1000 -1000</div><div class=\"test-example-line test-example-line-even test-example-line-12\">10 10050</div><div class=\"test-example-line test-example-line-even test-example-line-12\">408293874 -3498597 7374783 295774930 -48574034 26623784 498754833 -294875830 283045804 85938045</div>",
            "output": "\n999999996\n96\n896\n17\n351\n716455332\n42\n2\n0\n897909241\n0\n416571966\n"
        }
    ],
    "note": "<p>In the first test case, it is advantageous to take an empty subarray of the array twice and insert the sum of the empty subarray (zero) anywhere, then the sum of the resulting array will be $$$(-4) + (-7) + 0 + 0 = -11$$$, modulo $$$10^9 + 7$$$ this is $$$999\\,999\\,996$$$.</p><p>In the second test case, it is advantageous to take the sum of the entire array three times and place it anywhere in the array, then one of the possible sequences of actions: [$$$2, 2, 8$$$] $$$\\rightarrow$$$ [$$$2, 2, 8, 12$$$] $$$\\rightarrow$$$ [$$$2, 2, 8, 12, 24$$$] $$$\\rightarrow$$$ [$$$2, 2, 8, 12, 24, 48$$$], the sum of the final array is $$$2 + 2 + 8 + 12 + 24 + 48 = 96$$$.</p><p>In the fourth test case, it is advantageous to take a subarray of the array consisting of the first three numbers (i.e. consisting of the numbers $$$4, -2$$$ and $$$8$$$) and insert its sum at the beginning of the array, thereby obtaining the array [$$$10, 4, -2, 8, -12, 9$$$], the sum of this array is $$$17$$$.</p><p>In the seventh test case, it will always be advantageous for us to take an empty subarray of the array. In this case, the sum of the resulting array will not differ from the sum of the original. The answer will be the sum of the original array, taken modulo\u00a0\u2014 $$$42$$$, because $$$(-6 \\cdot (10^9 + 7) + 42 = -6\\,000\\,000\\,000)$$$.</p>",
    "contestId": 1946,
    "index": "B",
    "name": "Maximum Sum",
    "type": "PROGRAMMING",
    "tags": [
        "dp",
        "greedy",
        "math"
    ],
    "solvedCount": 18645
}