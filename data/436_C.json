{
    "title": "C. Dungeons and Candies",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>During the loading of the game \"Dungeons and Candies\" you are required to get descriptions of <span class=\"tex-span\"><i>k</i></span> levels from the server. Each description is a map of an <span class=\"tex-span\"><i>n</i>\u2009\u00d7\u2009<i>m</i></span> checkered rectangular field. Some cells of the field contain candies (each cell has at most one candy). An empty cell is denoted as \"<span class=\"tex-font-style-tt\">.</span>\" on the map, but if a cell has a candy, it is denoted as a letter of the English alphabet. A level may contain identical candies, in this case the letters in the corresponding cells of the map will be the same.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/96414a1f342f57f89020a923a962eca49b9dd086.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>When you transmit information via a network, you want to minimize traffic \u2014 the total size of the transferred data. The levels can be transmitted in any order. There are two ways to transmit the current level <span class=\"tex-span\"><i>A</i></span>:</p><ol> <li> You can transmit the whole level <span class=\"tex-span\"><i>A</i></span>. Then you need to transmit <span class=\"tex-span\"><i>n</i>\u00b7<i>m</i></span> bytes via the network. </li><li> You can transmit the difference between level <span class=\"tex-span\"><i>A</i></span> and some previously transmitted level <span class=\"tex-span\"><i>B</i></span> (if it exists); this operation requires to transmit <span class=\"tex-span\"><i>d</i><sub class=\"lower-index\"><i>A</i>,\u2009<i>B</i></sub>\u00b7<i>w</i></span> bytes, where <span class=\"tex-span\"><i>d</i><sub class=\"lower-index\"><i>A</i>,\u2009<i>B</i></sub></span> is the number of cells of the field that are different for <span class=\"tex-span\"><i>A</i></span> and <span class=\"tex-span\"><i>B</i></span>, and <span class=\"tex-span\"><i>w</i></span> is a constant. Note, that you should compare only the corresponding cells of levels <span class=\"tex-span\"><i>A</i></span> and <span class=\"tex-span\"><i>B</i></span> to calculate <span class=\"tex-span\"><i>d</i><sub class=\"lower-index\"><i>A</i>,\u2009<i>B</i></sub></span>. You cannot transform the maps of levels, i.e. rotate or shift them relatively to each other. </li></ol><p>Your task is to find a way to transfer all the <span class=\"tex-span\"><i>k</i></span> levels and minimize the traffic.</p>",
    "inputSpecification": "<p>The first line contains four integers <span class=\"tex-span\"><i>n</i>,\u2009<i>m</i>,\u2009<i>k</i>,\u2009<i>w</i></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>\u2009\u2264\u200910;\u00a01\u2009\u2264\u2009<i>k</i>,\u2009<i>w</i>\u2009\u2264\u20091000)</span>. Then follows the description of <span class=\"tex-span\"><i>k</i></span> levels. Each level is described by <span class=\"tex-span\"><i>n</i></span> lines, each line contains <span class=\"tex-span\"><i>m</i></span> characters. Each character is either a letter of the English alphabet or a dot (\"<span class=\"tex-font-style-tt\">.</span>\"). Please note that the case of the letters matters.</p>",
    "outputSpecification": "<p>In the first line print the required minimum number of transferred bytes.</p><p>Then print <span class=\"tex-span\"><i>k</i></span> pairs of integers <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\">1</sub>,\u2009<i>y</i><sub class=\"lower-index\">1</sub>,\u2009<i>x</i><sub class=\"lower-index\">2</sub>,\u2009<i>y</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>x</i><sub class=\"lower-index\"><i>k</i></sub>,\u2009<i>y</i><sub class=\"lower-index\"><i>k</i></sub></span>, describing the way to transfer levels. Pair <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\"><i>i</i></sub></span>, <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\"><i>i</i></sub></span> means that level <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\"><i>i</i></sub></span> needs to be transferred by way <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\"><i>i</i></sub></span>. If <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\"><i>i</i></sub></span> equals 0, that means that the level must be transferred using the first way, otherwise <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\"><i>i</i></sub></span> must be equal to the number of a previously transferred level. It means that you will transfer the difference between levels <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\"><i>i</i></sub></span> to transfer level <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\"><i>i</i></sub></span>. Print the pairs in the order of transferring levels. The levels are numbered 1 through <span class=\"tex-span\"><i>k</i></span> in the order they follow in the input.</p><p>If there are multiple optimal solutions, you can print any of them.</p>",
    "samples": [
        {
            "input": "2 3 3 2<br/>A.A<br/>...<br/>A.a<br/>..C<br/>X.Y<br/>...<br/>",
            "output": "14<br/>1 0<br/>2 1<br/>3 1<br/>"
        },
        {
            "input": "1 1 4 1<br/>A<br/>.<br/>B<br/>.<br/>",
            "output": "3<br/>1 0<br/>2 0<br/>4 2<br/>3 0<br/>"
        },
        {
            "input": "1 3 5 2<br/>ABA<br/>BBB<br/>BBA<br/>BAB<br/>ABB<br/>",
            "output": "11<br/>1 0<br/>3 1<br/>2 3<br/>4 2<br/>5 1<br/>"
        }
    ],
    "note": null,
    "contestId": 436,
    "index": "C",
    "name": "Dungeons and Candies",
    "type": "PROGRAMMING",
    "tags": [
        "dsu",
        "graphs",
        "greedy",
        "trees"
    ],
    "solvedCount": 2585
}