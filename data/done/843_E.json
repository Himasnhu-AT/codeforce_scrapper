{
    "title": "E. Maximum Flow",
    "timeLimit": {
        "value": 1.0,
        "unit": "second"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given a directed graph, consisting of <span class=\"tex-span\"><i>n</i></span> vertices and <span class=\"tex-span\"><i>m</i></span> edges. The vertices <span class=\"tex-span\"><i>s</i></span> and <span class=\"tex-span\"><i>t</i></span> are marked as source and sink correspondingly. Additionally, there are no edges ending at <span class=\"tex-span\"><i>s</i></span> and there are no edges beginning in <span class=\"tex-span\"><i>t</i></span>.</p><p>The graph was constructed in a following way: initially each edge had capacity <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub>\u2009&gt;\u20090</span>. A maximum flow with source at <span class=\"tex-span\"><i>s</i></span> and sink at <span class=\"tex-span\"><i>t</i></span> was constructed in this flow network. Let's denote <span class=\"tex-span\"><i>f</i><sub class=\"lower-index\"><i>i</i></sub></span> as the value of flow passing through edge with index <span class=\"tex-span\"><i>i</i></span>. Next, all capacities <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> and flow value <span class=\"tex-span\"><i>f</i><sub class=\"lower-index\"><i>i</i></sub></span> were erased. Instead, indicators <span class=\"tex-span\"><i>g</i><sub class=\"lower-index\"><i>i</i></sub></span> were written on edges \u2014 if flow value passing through edge <span class=\"tex-span\"><i>i</i></span> was positive, i.e. <span class=\"tex-span\">1</span> if <span class=\"tex-span\"><i>f</i><sub class=\"lower-index\"><i>i</i></sub>\u2009&gt;\u20090</span> and <span class=\"tex-span\">0</span> otherwise.</p><p>Using the graph and values <span class=\"tex-span\"><i>g</i><sub class=\"lower-index\"><i>i</i></sub></span>, find out what is the <span class=\"tex-font-style-bf\">minimum</span> possible number of edges in the initial flow network that could be saturated (the passing flow is equal to capacity, i.e. <span class=\"tex-span\"><i>f</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub></span>). Also construct the corresponding flow network with maximum flow in it.</p><p>A flow in directed graph is described by flow values <span class=\"tex-span\"><i>f</i><sub class=\"lower-index\"><i>i</i></sub></span> on each of the edges so that the following conditions are satisfied: </p><ul> <li> for each vertex, except source and sink, total incoming flow and total outcoming flow are equal, </li><li> for each edge <span class=\"tex-span\">0\u2009\u2264\u2009<i>f</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> </li></ul><p>A flow is maximum if the difference between the sum of flow values on edges from the source, and the sum of flow values on edges to the source (there are no such in this problem), is maximum possible.</p>",
    "inputSpecification": "<p>The first line of input data contains four positive integers <span class=\"tex-span\"><i>n</i>,\u2009<i>m</i>,\u2009<i>s</i>,\u2009<i>t</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u2009100</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>m</i>\u2009\u2264\u20091000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>s</i>,\u2009<i>t</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\"><i>s</i>\u2009\u2260\u2009<i>t</i></span>) \u2014 the number of vertices, the number of edges, index of source vertex and index of sink vertex correspondingly.</p><p>Each of next <span class=\"tex-span\"><i>m</i></span> lines of input data contain non-negative integers <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span>, <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span>, <span class=\"tex-span\"><i>g</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>u</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>v</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i></span>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/d7c46b18c5ed3cbbf7f593217f7473a75df5a335.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>) \u2014 the beginning of edge <span class=\"tex-span\"><i>i</i></span>, the end of edge <span class=\"tex-span\"><i>i</i></span> and indicator, which equals to <span class=\"tex-span\">1</span> if flow value passing through edge <span class=\"tex-span\"><i>i</i></span> was positive and <span class=\"tex-span\">0</span> if not.</p><p>It's guaranteed that no edge connects vertex with itself. Also it's guaranteed that there are no more than one edge between each ordered pair of vertices and that there exists at least one network flow that satisfies all the constrains from input data.</p>",
    "outputSpecification": "<p>In the first line print single non-negative integer <span class=\"tex-span\"><i>k</i></span> \u2014 minimum number of edges, which should be saturated in maximum flow.</p><p>In each of next <span class=\"tex-span\"><i>m</i></span> lines print two integers <span class=\"tex-span\"><i>f</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u200910<sup class=\"upper-index\">9</sup></span>, <span class=\"tex-span\">0\u2009\u2264\u2009<i>f</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub></span>) \u2014 the flow value passing through edge <span class=\"tex-span\"><i>i</i></span> and capacity of edge <span class=\"tex-span\"><i>i</i></span>. </p><p>This data should form a correct maximum flow in flow network. Also there must be exactly <span class=\"tex-span\"><i>k</i></span> edges with statement <span class=\"tex-span\"><i>f</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> satisfied. Also statement <span class=\"tex-span\"><i>f</i><sub class=\"lower-index\"><i>i</i></sub>\u2009&gt;\u20090</span> must be true if and only if <span class=\"tex-span\"><i>g</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u20091</span>.</p><p>If there are several possible answers, print any of them.</p>",
    "samples": [
        {
            "input": "5 6 1 5<br/>1 2 1<br/>2 3 1<br/>3 5 1<br/>1 4 1<br/>4 3 0<br/>4 5 1<br/>",
            "output": "2<br/>3 3<br/>3 8<br/>3 4<br/>4 4<br/>0 5<br/>4 9<br/>"
        }
    ],
    "note": "<center><p>The illustration for second sample case. The saturated edges are marked dark, while edges with <span class=\"tex-span\"><i>g</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u20090</span> are marked with dotted line. The integer on edge is the index of this edge in input list. <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/a80cb6067d5d58458863f416f6ac95ad991a308a.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></p></center>",
    "contestId": 843,
    "index": "E",
    "name": "Maximum Flow",
    "type": "PROGRAMMING",
    "tags": [
        "flows",
        "graphs"
    ],
    "solvedCount": 287
}