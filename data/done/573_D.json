{
    "title": "D. Bear and Cavalry",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Would you want to fight against bears riding horses? Me neither.</p><p>Limak is a grizzly bear. He is general of the dreadful army of Bearland. The most important part of an army is cavalry of course.</p><p>Cavalry of Bearland consists of <span class=\"tex-span\"><i>n</i></span> warriors and <span class=\"tex-span\"><i>n</i></span> horses. <span class=\"tex-span\"><i>i</i></span>-th warrior has strength <span class=\"tex-span\"><i>w</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>i</i></span>-th horse has strength <span class=\"tex-span\"><i>h</i><sub class=\"lower-index\"><i>i</i></sub></span>. Warrior together with his horse is called a unit. Strength of a unit is equal to multiplied strengths of warrior and horse. Total strength of cavalry is equal to sum of strengths of all <span class=\"tex-span\"><i>n</i></span> units. Good assignment of warriors and horses makes cavalry truly powerful.</p><p>Initially, <span class=\"tex-span\"><i>i</i></span>-th warrior has <span class=\"tex-span\"><i>i</i></span>-th horse. You are given <span class=\"tex-span\"><i>q</i></span> queries. In each query two warriors swap their horses with each other.</p><p>General Limak must be ready for every possible situation. What if warriors weren't allowed to ride their own horses? After each query find the maximum possible strength of cavalry if we consider assignments of all warriors to all horses that no warrior is assigned to his own horse (it can be proven that for <span class=\"tex-span\"><i>n</i>\u2009\u2265\u20092</span> there is always at least one correct assignment).</p><p>Note that we can't leave a warrior without a horse.</p>",
    "inputSpecification": "<p>The first line contains two space-separated integers, <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u200930 000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u200910 000</span>).</p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> space-separated integers, <span class=\"tex-span\"><i>w</i><sub class=\"lower-index\">1</sub>,\u2009<i>w</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>w</i><sub class=\"lower-index\"><i>n</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>w</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u200910<sup class=\"upper-index\">6</sup></span>) \u2014 strengths of warriors.</p><p>The third line contains <span class=\"tex-span\"><i>n</i></span> space-separated integers, <span class=\"tex-span\"><i>h</i><sub class=\"lower-index\">1</sub>,\u2009<i>h</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>h</i><sub class=\"lower-index\"><i>n</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>h</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u200910<sup class=\"upper-index\">6</sup></span>) \u2014 strengths of horses.</p><p>Next <span class=\"tex-span\"><i>q</i></span> lines describe queries. <span class=\"tex-span\"><i>i</i></span>-th of them contains two space-separated integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>b</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2260\u2009<i>b</i><sub class=\"lower-index\"><i>i</i></sub></span>), indices of warriors who swap their horses with each other.</p>",
    "outputSpecification": "<p>Print <span class=\"tex-span\"><i>q</i></span> lines with answers to queries. In <span class=\"tex-span\"><i>i</i></span>-th line print the maximum possible strength of cavalry after first <span class=\"tex-span\"><i>i</i></span> queries.</p>",
    "samples": [
        {
            "input": "4 2<br/>1 10 100 1000<br/>3 7 2 5<br/>2 4<br/>2 4<br/>",
            "output": "5732<br/>7532<br/>"
        },
        {
            "input": "3 3<br/>7 11 5<br/>3 2 1<br/>1 2<br/>1 3<br/>2 3<br/>",
            "output": "44<br/>48<br/>52<br/>"
        },
        {
            "input": "7 4<br/>1 2 4 8 16 32 64<br/>87 40 77 29 50 11 18<br/>1 5<br/>2 7<br/>6 2<br/>5 6<br/>",
            "output": "9315<br/>9308<br/>9315<br/>9315<br/>"
        }
    ],
    "note": "<p>Clarification for the first sample:</p><center> <span class=\"tex-font-style-tt\">Warriors:\u00a01\u00a010\u00a0100\u00a01000</span><p><span class=\"tex-font-style-tt\">Horses:\u00a0\u00a0\u00a03\u00a0\u00a07\u00a0\u00a02\u00a0\u00a0\u00a0\u00a05\u00a0</span> </p></center><p>After first query situation looks like the following:</p><center> <span class=\"tex-font-style-tt\">Warriors:\u00a01\u00a010\u00a0100\u00a01000</span><p><span class=\"tex-font-style-tt\">Horses:\u00a0\u00a0\u00a03\u00a0\u00a05\u00a0\u00a02\u00a0\u00a0\u00a0\u00a07\u00a0</span> </p></center><p>We can get <span class=\"tex-span\">1\u00b72\u2009+\u200910\u00b73\u2009+\u2009100\u00b77\u2009+\u20091000\u00b75\u2009=\u20095732</span> (note that no hussar takes his own horse in this assignment).</p><p>After second query we get back to initial situation and optimal assignment is <span class=\"tex-span\">1\u00b72\u2009+\u200910\u00b73\u2009+\u2009100\u00b75\u2009+\u20091000\u00b77\u2009=\u20097532</span>.</p><p>Clarification for the second sample. After first query:</p><center> <span class=\"tex-font-style-tt\">Warriors:\u00a0\u00a07\u00a011\u00a05</span><p><span class=\"tex-font-style-tt\">Horses:\u00a0\u00a0\u00a0\u00a02\u00a0\u00a03\u00a01</span> </p></center><p>Optimal assignment is <span class=\"tex-span\">7\u00b71\u2009+\u200911\u00b72\u2009+\u20095\u00b73\u2009=\u200944</span>.</p><p>Then after second query <span class=\"tex-span\">7\u00b73\u2009+\u200911\u00b72\u2009+\u20095\u00b71\u2009=\u200948</span>.</p><p>Finally <span class=\"tex-span\">7\u00b72\u2009+\u200911\u00b73\u2009+\u20095\u00b71\u2009=\u200952</span>.</p>",
    "contestId": 573,
    "index": "D",
    "name": "Bear and Cavalry",
    "type": "PROGRAMMING",
    "tags": [
        "data structures",
        "divide and conquer",
        "dp"
    ],
    "solvedCount": 452
}