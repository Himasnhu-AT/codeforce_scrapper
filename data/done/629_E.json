{
    "title": "E. Famil Door and Roads",
    "timeLimit": {
        "value": 5.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>Famil Door\u2019s City map looks like a tree (undirected connected acyclic graph) so other people call it Treeland. There are <span class=\"tex-span\"><i>n</i></span> intersections in the city connected by <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> bidirectional roads.</p><p>There are <span class=\"tex-span\"><i>m</i></span> friends of Famil Door living in the city. The <span class=\"tex-span\"><i>i</i></span>-th friend lives at the intersection <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> and works at the intersection <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span>. Everyone in the city is unhappy because there is exactly one simple path between their home and work.</p><p>Famil Door plans to construct exactly one new road and he will randomly choose one among <span class=\"tex-span\"><i>n</i>\u00b7(<i>n</i>\u2009-\u20091)\u2009/\u20092</span> possibilities. Note, that he may even build a new road between two cities that are already connected by one.</p><p>He knows, that each of his friends will become happy, if after Famil Door constructs a new road there is a path from this friend home to work and back that doesn't visit the same road twice. Formally, there is a simple cycle containing both <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span>. </p><p>Moreover, if the friend becomes happy, his pleasure is equal to the length of such path (it's easy to see that it's unique). For each of his friends Famil Door wants to know his expected pleasure, that is the expected length of the cycle containing both <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> if we consider only cases when such a cycle exists.</p>",
    "inputSpecification": "<p>The first line of the input contains integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>,\u2009 <i>m</i>\u2009\u2264\u2009100\u2009000</span>)\u00a0\u2014 the number of the intersections in the Treeland and the number of Famil Door's friends.</p><p>Then follow <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> lines describing bidirectional roads. Each of them contains two integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>b</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i>)</span>\u00a0\u2014 the indices of intersections connected by the <span class=\"tex-span\"><i>i</i></span>-th road.</p><p>Last <span class=\"tex-span\"><i>m</i></span> lines of the input describe Famil Door's friends. The <span class=\"tex-span\"><i>i</i></span>-th of these lines contain two integers <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>u</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>v</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i>,\u2009<i>u</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2260\u2009<i>v</i><sub class=\"lower-index\"><i>i</i></sub></span>)\u00a0\u2014 indices of intersections where the <span class=\"tex-span\"><i>i</i></span>-th friend lives and works.</p>",
    "outputSpecification": "<p>For each friend you should print the expected value of pleasure if he will be happy. Your answer will be considered correct if its absolute or relative error does not exceed <span class=\"tex-span\">10<sup class=\"upper-index\">\u2009-\u20096</sup></span>.</p><p>Namely: let's assume that your answer is <span class=\"tex-span\"><i>a</i></span>, and the answer of the jury is <span class=\"tex-span\"><i>b</i></span>. The checker program will consider your answer correct, if <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/c1b52f0e83e1008ebbb127cf309e0d965533b043.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p>",
    "samples": [
        {
            "input": "4 3<br/>2 4<br/>4 1<br/>3 2<br/>3 1<br/>2 3<br/>4 1<br/>",
            "output": "4.00000000<br/>3.00000000<br/>3.00000000<br/>"
        },
        {
            "input": "3 3<br/>1 2<br/>1 3<br/>1 2<br/>1 3<br/>2 3<br/>",
            "output": "2.50000000<br/>2.50000000<br/>3.00000000<br/>"
        }
    ],
    "note": "<p>Consider the second sample. </p><ol> <li> Both roads <span class=\"tex-span\">(1,\u20092)</span> and <span class=\"tex-span\">(2,\u20093)</span> work, so the expected length if <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/ec563337e40cadafa8449c9571eb5b8c7199e10c.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </li><li> Roads <span class=\"tex-span\">(1,\u20093)</span> and <span class=\"tex-span\">(2,\u20093)</span> make the second friend happy. Same as for friend <span class=\"tex-span\">1</span> the answer is <span class=\"tex-span\">2.5</span> </li><li> The only way to make the third friend happy is to add road <span class=\"tex-span\">(2,\u20093)</span>, so the answer is <span class=\"tex-span\">3</span> </li></ol>",
    "contestId": 629,
    "index": "E",
    "name": "Famil Door and Roads",
    "type": "PROGRAMMING",
    "tags": [
        "combinatorics",
        "data structures",
        "dfs and similar",
        "dp",
        "probabilities",
        "trees"
    ],
    "solvedCount": 974
}