{
    "title": "D. Table with Letters - 2",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Vasya has recently started to learn English. Now he needs to remember how to write English letters. He isn't sure about some of them, so he decided to train a little.</p><p>He found a sheet of squared paper and began writing arbitrary English letters there. In the end Vasya wrote <span class=\"tex-span\"><i>n</i></span> lines containing <span class=\"tex-span\"><i>m</i></span> characters each. Thus, he got a rectangular <span class=\"tex-span\"><i>n</i>\u2009\u00d7\u2009<i>m</i></span> table, each cell of the table contained some English letter. Let's number the table rows from top to bottom with integers from 1 to <span class=\"tex-span\"><i>n</i></span>, and columns \u2014 from left to right with integers from 1 to <span class=\"tex-span\"><i>m</i></span>.</p><p>After that Vasya looked at the resulting rectangular table and wondered, how many subtables are there, that matches both following conditions:</p><ul> <li> the subtable contains at most <span class=\"tex-span\"><i>k</i></span> cells with \"<span class=\"tex-font-style-tt\">a</span>\" letter; </li><li> all letters, located in all four corner cells of the subtable, are equal. </li></ul> <p>Formally, a subtable's definition is as follows. It is defined by four integers <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\">1</sub>,\u2009<i>y</i><sub class=\"lower-index\">1</sub>,\u2009<i>x</i><sub class=\"lower-index\">2</sub>,\u2009<i>y</i><sub class=\"lower-index\">2</sub></span> such that <span class=\"tex-span\">1\u2009\u2264\u2009<i>x</i><sub class=\"lower-index\">1</sub>\u2009&lt;\u2009<i>x</i><sub class=\"lower-index\">2</sub>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>y</i><sub class=\"lower-index\">1</sub>\u2009&lt;\u2009<i>y</i><sub class=\"lower-index\">2</sub>\u2009\u2264\u2009<i>m</i></span>. Then the subtable contains all such cells <span class=\"tex-span\">(<i>x</i>,\u2009<i>y</i>)</span> (<span class=\"tex-span\"><i>x</i></span> is the row number, <span class=\"tex-span\"><i>y</i></span> is the column number), for which the following inequality holds <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\">1</sub>\u2009\u2264\u2009<i>x</i>\u2009\u2264\u2009<i>x</i><sub class=\"lower-index\">2</sub>,\u2009<i>y</i><sub class=\"lower-index\">1</sub>\u2009\u2264\u2009<i>y</i>\u2009\u2264\u2009<i>y</i><sub class=\"lower-index\">2</sub></span>. The corner cells of the table are cells <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">1</sub>,\u2009<i>y</i><sub class=\"lower-index\">1</sub>)</span>, <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">1</sub>,\u2009<i>y</i><sub class=\"lower-index\">2</sub>)</span>, <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">2</sub>,\u2009<i>y</i><sub class=\"lower-index\">1</sub>)</span>, <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">2</sub>,\u2009<i>y</i><sub class=\"lower-index\">2</sub>)</span>.</p><p>Vasya is already too tired after he's been writing letters to a piece of paper. That's why he asks you to count the value he is interested in.</p>",
    "inputSpecification": "<p>The first line contains three integers <span class=\"tex-span\"><i>n</i>,\u2009<i>m</i>,\u2009<i>k</i></span> <span class=\"tex-span\">(2\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>\u2009\u2264\u2009400;\u00a00\u2009\u2264\u2009<i>k</i>\u2009\u2264\u2009<i>n</i>\u00b7<i>m</i>)</span>.</p><p>Next <span class=\"tex-span\"><i>n</i></span> lines contain <span class=\"tex-span\"><i>m</i></span> characters each \u2014 the given table. Each character of the table is a lowercase English letter.</p>",
    "outputSpecification": "<p>Print a single integer \u2014 the number of required subtables.</p>",
    "samples": [
        {
            "input": "3 4 4<br/>aabb<br/>baab<br/>baab<br/>",
            "output": "2<br/>"
        },
        {
            "input": "4 5 1<br/>ababa<br/>ccaca<br/>ccacb<br/>cbabc<br/>",
            "output": "1<br/>"
        }
    ],
    "note": "<p>There are two suitable subtables in the first sample: the first one's upper left corner is cell <span class=\"tex-span\">(2,\u20092)</span> and lower right corner is cell <span class=\"tex-span\">(3,\u20093)</span>, the second one's upper left corner is cell <span class=\"tex-span\">(2,\u20091)</span> and lower right corner is cell <span class=\"tex-span\">(3,\u20094)</span>.</p>",
    "contestId": 253,
    "index": "D",
    "name": "Table with Letters - 2",
    "type": "PROGRAMMING",
    "tags": [
        "brute force",
        "two pointers"
    ],
    "solvedCount": 816
}