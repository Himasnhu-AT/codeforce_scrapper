{
    "title": "D. Messenger",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>Each employee of the \"Blake Techologies\" company uses a special messaging app \"Blake Messenger\". All the stuff likes this app and uses it constantly. However, some important futures are missing. For example, many users want to be able to search through the message history. It was already announced that the new feature will appear in the nearest update, when developers faced some troubles that only you may help them to solve.</p><p>All the messages are represented as a strings consisting of only lowercase English letters. In order to reduce the network load strings are represented in the special compressed form. Compression algorithm works as follows: string is represented as a concatenation of <span class=\"tex-span\"><i>n</i></span> blocks, each block containing only equal characters. One block may be described as a pair <span class=\"tex-span\">(<i>l</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub>)</span>, where <span class=\"tex-span\"><i>l</i><sub class=\"lower-index\"><i>i</i></sub></span> is the length of the <span class=\"tex-span\"><i>i</i></span>-th block and <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> is the corresponding letter. Thus, the string <span class=\"tex-span\"><i>s</i></span> may be written as the sequence of pairs <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/68dc87dc42fc8b5c9e100569fb0db6d0de6f0e20.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p><p>Your task is to write the program, that given two compressed string <span class=\"tex-span\"><i>t</i></span> and <span class=\"tex-span\"><i>s</i></span> finds all occurrences of <span class=\"tex-span\"><i>s</i></span> in <span class=\"tex-span\"><i>t</i></span>. Developers know that there may be many such occurrences, so they only ask you to find the <span class=\"tex-font-style-bf\">number</span> of them. Note that <span class=\"tex-span\"><i>p</i></span> is the starting position of some occurrence of <span class=\"tex-span\"><i>s</i></span> in <span class=\"tex-span\"><i>t</i></span> if and only if <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>p</i></sub><i>t</i><sub class=\"lower-index\"><i>p</i>\u2009+\u20091</sub>...<i>t</i><sub class=\"lower-index\"><i>p</i>\u2009+\u2009|<i>s</i>|\u2009-\u20091</sub>\u2009=\u2009<i>s</i></span>, where <span class=\"tex-span\"><i>t</i><sub class=\"lower-index\"><i>i</i></sub></span> is the <span class=\"tex-span\"><i>i</i></span>-th character of string <span class=\"tex-span\"><i>t</i></span>.</p><p>Note that the way to represent the string in compressed form may not be unique. For example string \"<span class=\"tex-font-style-tt\">aaaa</span>\" may be given as <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/939322623808439da25353cdf333633a2bd459d1.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/1d6356300e6949063b637098187983ab4a94bdd0.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/fe55bc3160319d1cb679fcb8d1a2d90686d4db05.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>...</p>",
    "inputSpecification": "<p>The first line of the input contains two integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>\u2009\u2264\u2009200\u2009000</span>)\u00a0\u2014 the number of blocks in the strings <span class=\"tex-span\"><i>t</i></span> and <span class=\"tex-span\"><i>s</i></span>, respectively.</p><p>The second line contains the descriptions of <span class=\"tex-span\"><i>n</i></span> parts of string <span class=\"tex-span\"><i>t</i></span> in the format \"<span class=\"tex-span\"><i>l</i><sub class=\"lower-index\"><i>i</i></sub></span>-<span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span>\" (<span class=\"tex-span\">1\u2009\u2264\u2009<i>l</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u20091\u2009000\u2009000</span>)\u00a0\u2014 the length of the <span class=\"tex-span\"><i>i</i></span>-th part and the corresponding lowercase English letter.</p><p>The second line contains the descriptions of <span class=\"tex-span\"><i>m</i></span> parts of string <span class=\"tex-span\"><i>s</i></span> in the format \"<span class=\"tex-span\"><i>l</i><sub class=\"lower-index\"><i>i</i></sub></span>-<span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span>\" (<span class=\"tex-span\">1\u2009\u2264\u2009<i>l</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u20091\u2009000\u2009000</span>)\u00a0\u2014 the length of the <span class=\"tex-span\"><i>i</i></span>-th part and the corresponding lowercase English letter.</p>",
    "outputSpecification": "<p>Print a single integer\u00a0\u2014 the number of occurrences of <span class=\"tex-span\"><i>s</i></span> in <span class=\"tex-span\"><i>t</i></span>.</p>",
    "samples": [
        {
            "input": "5 3<br/>3-a 2-b 4-c 3-a 2-c<br/>2-a 2-b 1-c<br/>",
            "output": "1"
        },
        {
            "input": "6 1<br/>3-a 6-b 7-a 4-c 8-e 2-a<br/>3-a<br/>",
            "output": "6"
        },
        {
            "input": "5 5<br/>1-h 1-e 1-l 1-l 1-o<br/>1-w 1-o 1-r 1-l 1-d<br/>",
            "output": "0"
        }
    ],
    "note": "<p>In the first sample, <span class=\"tex-span\"><i>t</i></span> = \"<span class=\"tex-font-style-tt\">aaabbccccaaacc</span>\", and string <span class=\"tex-span\"><i>s</i></span> = \"<span class=\"tex-font-style-tt\">aabbc</span>\". The only occurrence of string <span class=\"tex-span\"><i>s</i></span> in string <span class=\"tex-span\"><i>t</i></span> starts at position <span class=\"tex-span\"><i>p</i>\u2009=\u20092</span>.</p><p>In the second sample, <span class=\"tex-span\"><i>t</i></span> = \"<span class=\"tex-font-style-tt\">aaabbbbbbaaaaaaacccceeeeeeeeaa</span>\", and <span class=\"tex-span\"><i>s</i></span> = \"<span class=\"tex-font-style-tt\">aaa</span>\". The occurrences of <span class=\"tex-span\"><i>s</i></span> in <span class=\"tex-span\"><i>t</i></span> start at positions <span class=\"tex-span\"><i>p</i>\u2009=\u20091</span>, <span class=\"tex-span\"><i>p</i>\u2009=\u200910</span>, <span class=\"tex-span\"><i>p</i>\u2009=\u200911</span>, <span class=\"tex-span\"><i>p</i>\u2009=\u200912</span>, <span class=\"tex-span\"><i>p</i>\u2009=\u200913</span> and <span class=\"tex-span\"><i>p</i>\u2009=\u200914</span>.</p>",
    "contestId": 631,
    "index": "D",
    "name": "Messenger",
    "type": "PROGRAMMING",
    "tags": [
        "data structures",
        "hashing",
        "implementation",
        "string suffix structures",
        "strings"
    ],
    "solvedCount": 2004
}