{
    "title": "F. Jog Around The Graph",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given a simple weighted connected undirected graph, consisting of $$$n$$$ vertices and $$$m$$$ edges.</p><p>A path in the graph of length $$$k$$$ is a sequence of $$$k+1$$$ vertices $$$v_1, v_2, \\dots, v_{k+1}$$$ such that for each $$$i$$$ $$$(1 \\le i \\le k)$$$ the edge $$$(v_i, v_{i+1})$$$ is present in the graph. A path from some vertex $$$v$$$ also has vertex $$$v_1=v$$$. Note that edges and vertices are allowed to be included in the path multiple times.</p><p>The weight of the path is the total weight of edges in it.</p><p>For each $$$i$$$ from $$$1$$$ to $$$q$$$ consider a path from vertex $$$1$$$ of length $$$i$$$ of the maximum weight. What is the sum of weights of these $$$q$$$ paths?</p><p>Answer can be quite large, so print it modulo $$$10^9+7$$$.</p>",
    "inputSpecification": "<p>The first line contains a three integers $$$n$$$, $$$m$$$, $$$q$$$ ($$$2 \\le n \\le 2000$$$; $$$n - 1 \\le m \\le 2000$$$; $$$m \\le q \\le 10^9$$$)\u00a0\u2014 the number of vertices in the graph, the number of edges in the graph and the number of lengths that should be included in the answer.</p><p>Each of the next $$$m$$$ lines contains a description of an edge: three integers $$$v$$$, $$$u$$$, $$$w$$$ ($$$1 \\le v, u \\le n$$$; $$$1 \\le w \\le 10^6$$$)\u00a0\u2014 two vertices $$$v$$$ and $$$u$$$ are connected by an undirected edge with weight $$$w$$$. The graph contains no loops and no multiple edges. It is guaranteed that the given edges form a connected graph.</p>",
    "outputSpecification": "<p>Print a single integer\u00a0\u2014 the sum of the weights of the paths from vertex $$$1$$$ of maximum weights of lengths $$$1, 2, \\dots, q$$$ modulo $$$10^9+7$$$.</p>",
    "samples": [
        {
            "input": "\n7 8 25\n1 2 1\n2 3 10\n3 4 2\n1 5 2\n5 6 7\n6 4 15\n5 3 1\n1 7 3\n",
            "output": "\n4361\n"
        },
        {
            "input": "\n2 1 5\n1 2 4\n",
            "output": "\n60\n"
        },
        {
            "input": "\n15 15 23\n13 10 12\n11 14 12\n2 15 5\n4 10 8\n10 2 4\n10 7 5\n3 10 1\n5 6 11\n1 13 8\n9 15 4\n4 2 9\n11 15 1\n11 12 14\n10 8 12\n3 6 11\n",
            "output": "\n3250\n"
        },
        {
            "input": "\n5 10 10000000\n2 4 798\n1 5 824\n5 2 558\n4 1 288\n3 4 1890\n3 1 134\n2 3 1485\n4 5 284\n3 5 1025\n1 2 649\n",
            "output": "\n768500592\n"
        }
    ],
    "note": "<p>Here is the graph for the first example:</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/0ce6768b978fc39d22fac54ee93fa405336ccdf7.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>Some maximum weight paths are: </p><ul> <li> length $$$1$$$: edges $$$(1, 7)$$$\u00a0\u2014 weight $$$3$$$; </li><li> length $$$2$$$: edges $$$(1, 2), (2, 3)$$$\u00a0\u2014 weight $$$1+10=11$$$; </li><li> length $$$3$$$: edges $$$(1, 5), (5, 6), (6, 4)$$$\u00a0\u2014 weight $$$2+7+15=24$$$; </li><li> length $$$4$$$: edges $$$(1, 5), (5, 6), (6, 4), (6, 4)$$$\u00a0\u2014 weight $$$2+7+15+15=39$$$; </li><li> $$$\\dots$$$ </li></ul><p>So the answer is the sum of $$$25$$$ terms: $$$3+11+24+39+\\dots$$$</p><p>In the second example the maximum weight paths have weights $$$4$$$, $$$8$$$, $$$12$$$, $$$16$$$ and $$$20$$$.</p>",
    "contestId": 1366,
    "index": "F",
    "name": "Jog Around The Graph",
    "type": "PROGRAMMING",
    "tags": [
        "binary search",
        "dp",
        "geometry",
        "graphs"
    ],
    "solvedCount": 595
}