{
    "title": "D. New Year and Arbitrary Arrangement",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given three integers <span class=\"tex-span\"><i>k</i></span>, <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>a</i></sub></span> and <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>b</i></sub></span>.</p><p>You will construct a sequence with the following algorithm: Initially, start with the empty sequence. Each second, you do the following. With probability <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>a</i></sub>\u2009/\u2009(<i>p</i><sub class=\"lower-index\"><i>a</i></sub>\u2009+\u2009<i>p</i><sub class=\"lower-index\"><i>b</i></sub>)</span>, add '<span class=\"tex-font-style-tt\">a</span>' to the end of the sequence. Otherwise (with probability <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>b</i></sub>\u2009/\u2009(<i>p</i><sub class=\"lower-index\"><i>a</i></sub>\u2009+\u2009<i>p</i><sub class=\"lower-index\"><i>b</i></sub>)</span>), add '<span class=\"tex-font-style-tt\">b</span>' to the end of the sequence.</p><p>You stop once there are at least <span class=\"tex-span\"><i>k</i></span> subsequences that form '<span class=\"tex-font-style-tt\">ab</span>'. Determine the expected number of times '<span class=\"tex-font-style-tt\">ab</span>' is a subsequence in the resulting sequence. It can be shown that this can be represented by <span class=\"tex-span\"><i>P</i>\u2009/\u2009<i>Q</i></span>, where <span class=\"tex-span\"><i>P</i></span> and <span class=\"tex-span\"><i>Q</i></span> are coprime integers, and <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/f3f70c219d6724100480cf0d740924e6e612fea1.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. Print the value of <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/3959a3c4efdc3cb9bd918186b97c072d60ff3ddc.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p>",
    "inputSpecification": "<p>The first line will contain three integers integer <span class=\"tex-span\"><i>k</i>,\u2009<i>p</i><sub class=\"lower-index\"><i>a</i></sub>,\u2009<i>p</i><sub class=\"lower-index\"><i>b</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>k</i>\u2009\u2264\u20091\u2009000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>p</i><sub class=\"lower-index\"><i>a</i></sub>,\u2009<i>p</i><sub class=\"lower-index\"><i>b</i></sub>\u2009\u2264\u20091\u2009000\u2009000</span>).</p>",
    "outputSpecification": "<p>Print a single integer, the answer to the problem.</p>",
    "samples": [
        {
            "input": "1 1 1<br/>",
            "output": "2<br/>"
        },
        {
            "input": "3 1 4<br/>",
            "output": "370000006<br/>"
        }
    ],
    "note": "<p>The first sample, we will keep appending to our sequence until we get the subsequence '<span class=\"tex-font-style-tt\">ab</span>' at least once. For instance, we get the sequence '<span class=\"tex-font-style-tt\">ab</span>' with probability 1/4, '<span class=\"tex-font-style-tt\">bbab</span>' with probability 1/16, and '<span class=\"tex-font-style-tt\">aab</span>' with probability 1/8. Note, it's impossible for us to end with a sequence like '<span class=\"tex-font-style-tt\">aabab</span>', since we would have stopped our algorithm once we had the prefix '<span class=\"tex-font-style-tt\">aab</span>'. </p><p>The expected amount of times that '<span class=\"tex-font-style-tt\">ab</span>' will occur across all valid sequences is 2. </p><p>For the second sample, the answer is equal to <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/b95c4c7a595b83bcacbbaf06f7667850752a2092.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p>",
    "contestId": 908,
    "index": "D",
    "name": "New Year and Arbitrary Arrangement",
    "type": "PROGRAMMING",
    "tags": [
        "dp",
        "math",
        "probabilities"
    ],
    "solvedCount": 2267
}