{
    "title": "F. Number of Subsequences",
    "timeLimit": {
        "value": 1.0,
        "unit": "second"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given a string $$$s$$$ consisting of lowercase Latin letters \"<span class=\"tex-font-style-tt\">a</span>\", \"<span class=\"tex-font-style-tt\">b</span>\" and \"<span class=\"tex-font-style-tt\">c</span>\" and question marks \"<span class=\"tex-font-style-tt\">?</span>\".</p><p>Let the number of question marks in the string $$$s$$$ be $$$k$$$. Let's replace each question mark with one of the letters \"<span class=\"tex-font-style-tt\">a</span>\", \"<span class=\"tex-font-style-tt\">b</span>\" and \"<span class=\"tex-font-style-tt\">c</span>\". Here we can obtain all $$$3^{k}$$$ possible strings consisting only of letters \"<span class=\"tex-font-style-tt\">a</span>\", \"<span class=\"tex-font-style-tt\">b</span>\" and \"<span class=\"tex-font-style-tt\">c</span>\". For example, if $$$s = $$$\"<span class=\"tex-font-style-tt\">ac?b?c</span>\" then we can obtain the following strings: $$$[$$$\"<span class=\"tex-font-style-tt\">acabac</span>\", \"<span class=\"tex-font-style-tt\">acabbc</span>\", \"<span class=\"tex-font-style-tt\">acabcc</span>\", \"<span class=\"tex-font-style-tt\">acbbac</span>\", \"<span class=\"tex-font-style-tt\">acbbbc</span>\", \"<span class=\"tex-font-style-tt\">acbbcc</span>\", \"<span class=\"tex-font-style-tt\">accbac</span>\", \"<span class=\"tex-font-style-tt\">accbbc</span>\", \"<span class=\"tex-font-style-tt\">accbcc</span>\"$$$]$$$.</p><p>Your task is to count the total number of subsequences \"<span class=\"tex-font-style-tt\">abc</span>\" in all resulting strings. Since the answer can be very large, print it modulo $$$10^{9} + 7$$$.</p><p>A subsequence of the string $$$t$$$ is such a sequence that can be derived from the string $$$t$$$ after removing some (possibly, zero) number of letters without changing the order of remaining letters. For example, the string \"<span class=\"tex-font-style-tt\">baacbc</span>\" contains two subsequences \"<span class=\"tex-font-style-tt\">abc</span>\" \u2014 a subsequence consisting of letters at positions $$$(2, 5, 6)$$$ and a subsequence consisting of letters at positions $$$(3, 5, 6)$$$.</p>",
    "inputSpecification": "<p>The first line of the input contains one integer $$$n$$$ $$$(3 \\le n \\le 200\\,000)$$$ \u2014 the length of $$$s$$$.</p><p>The second line of the input contains the string $$$s$$$ of length $$$n$$$ consisting of lowercase Latin letters \"<span class=\"tex-font-style-tt\">a</span>\", \"<span class=\"tex-font-style-tt\">b</span>\" and \"<span class=\"tex-font-style-tt\">c</span>\" and question marks\"<span class=\"tex-font-style-tt\">?</span>\".</p>",
    "outputSpecification": "<p>Print the total number of subsequences \"<span class=\"tex-font-style-tt\">abc</span>\" in all strings you can obtain if you replace all question marks with letters \"<span class=\"tex-font-style-tt\">a</span>\", \"<span class=\"tex-font-style-tt\">b</span>\" and \"<span class=\"tex-font-style-tt\">c</span>\", modulo $$$10^{9} + 7$$$.</p>",
    "samples": [
        {
            "input": "\n6\nac?b?c\n",
            "output": "\n24\n"
        },
        {
            "input": "\n7\n???????\n",
            "output": "\n2835\n"
        },
        {
            "input": "\n9\ncccbbbaaa\n",
            "output": "\n0\n"
        },
        {
            "input": "\n5\na???c\n",
            "output": "\n46\n"
        }
    ],
    "note": "<p>In the first example, we can obtain $$$9$$$ strings:</p><ul> <li> \"<span class=\"tex-font-style-tt\">acabac</span>\" \u2014 there are $$$2$$$ subsequences \"<span class=\"tex-font-style-tt\">abc</span>\", </li><li> \"<span class=\"tex-font-style-tt\">acabbc</span>\" \u2014 there are $$$4$$$ subsequences \"<span class=\"tex-font-style-tt\">abc</span>\", </li><li> \"<span class=\"tex-font-style-tt\">acabcc</span>\" \u2014 there are $$$4$$$ subsequences \"<span class=\"tex-font-style-tt\">abc</span>\", </li><li> \"<span class=\"tex-font-style-tt\">acbbac</span>\" \u2014 there are $$$2$$$ subsequences \"<span class=\"tex-font-style-tt\">abc</span>\", </li><li> \"<span class=\"tex-font-style-tt\">acbbbc</span>\" \u2014 there are $$$3$$$ subsequences \"<span class=\"tex-font-style-tt\">abc</span>\", </li><li> \"<span class=\"tex-font-style-tt\">acbbcc</span>\" \u2014 there are $$$4$$$ subsequences \"<span class=\"tex-font-style-tt\">abc</span>\", </li><li> \"<span class=\"tex-font-style-tt\">accbac</span>\" \u2014 there is $$$1$$$ subsequence \"<span class=\"tex-font-style-tt\">abc</span>\", </li><li> \"<span class=\"tex-font-style-tt\">accbbc</span>\" \u2014 there are $$$2$$$ subsequences \"<span class=\"tex-font-style-tt\">abc</span>\", </li><li> \"<span class=\"tex-font-style-tt\">accbcc</span>\" \u2014 there are $$$2$$$ subsequences \"<span class=\"tex-font-style-tt\">abc</span>\". </li></ul><p>So, there are $$$2 + 4 + 4 + 2 + 3 + 4 + 1 + 2 + 2 = 24$$$ subsequences \"<span class=\"tex-font-style-tt\">abc</span>\" in total.</p>",
    "contestId": 1426,
    "index": "F",
    "name": "Number of Subsequences",
    "type": "PROGRAMMING",
    "tags": [
        "combinatorics",
        "dp",
        "strings"
    ],
    "solvedCount": 5152
}