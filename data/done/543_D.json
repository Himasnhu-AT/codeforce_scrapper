{
    "title": "D. Road Improvement",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>The country has <span class=\"tex-span\"><i>n</i></span> cities and <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> bidirectional roads, it is possible to get from every city to any other one if you move only along the roads. The cities are numbered with integers from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>n</i></span> inclusive.</p><p>All the roads are initially bad, but the government wants to improve the state of some roads. We will assume that the citizens are happy about road improvement if the path from the capital located in city <span class=\"tex-span\"><i>x</i></span> to any other city contains at most one bad road.</p><p>Your task is \u2014 for every possible <span class=\"tex-span\"><i>x</i></span> determine the number of ways of improving the quality of some roads in order to meet the citizens' condition. As those values can be rather large, you need to print each value modulo <span class=\"tex-span\">1\u2009000\u2009000\u2009007</span> (<span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>).</p>",
    "inputSpecification": "<p>The first line of the input contains a single integer <span class=\"tex-span\"><i>n</i></span> (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u20092\u00b710<sup class=\"upper-index\">5</sup></span>) \u2014 the number of cities in the country. Next line contains <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> positive integers <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">2</sub>,\u2009<i>p</i><sub class=\"lower-index\">3</sub>,\u2009<i>p</i><sub class=\"lower-index\">4</sub>,\u2009...,\u2009<i>p</i><sub class=\"lower-index\"><i>n</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>p</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>i</i>\u2009-\u20091</span>) \u2014 the description of the roads in the country. Number <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub></span> means that the country has a road connecting city <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\"><i>i</i></sub></span> and city <span class=\"tex-span\"><i>i</i></span>. </p>",
    "outputSpecification": "<p>Print <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span>, where <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span> is the sought number of ways to improve the quality of the roads modulo <span class=\"tex-span\">1\u2009000\u2009000\u2009007</span> (<span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>), if the capital of the country is at city number <span class=\"tex-span\"><i>i</i></span>.</p>",
    "samples": [
        {
            "input": "3<br/>1 1<br/>",
            "output": "4 3 3"
        },
        {
            "input": "5<br/>1 2 3 4<br/>",
            "output": "5 8 9 8 5"
        }
    ],
    "note": null,
    "contestId": 543,
    "index": "D",
    "name": "Road Improvement",
    "type": "PROGRAMMING",
    "tags": [
        "dp",
        "trees"
    ],
    "solvedCount": 2563
}