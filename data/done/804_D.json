{
    "title": "D. Expected diameter of a tree",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Pasha is a good student and one of MoJaK's best friends. He always have a problem to think about. Today they had a talk about the following problem.</p><p>We have a forest (acyclic undirected graph) with <span class=\"tex-span\"><i>n</i></span> vertices and <span class=\"tex-span\"><i>m</i></span> edges. There are <span class=\"tex-span\"><i>q</i></span> queries we should answer. In each query two vertices <span class=\"tex-span\"><i>v</i></span> and <span class=\"tex-span\"><i>u</i></span> are given. Let <span class=\"tex-span\"><i>V</i></span> be the set of vertices in the connected component of the graph that contains <span class=\"tex-span\"><i>v</i></span>, and <span class=\"tex-span\"><i>U</i></span> be the set of vertices in the connected component of the graph that contains <span class=\"tex-span\"><i>u</i></span>. Let's add an edge between some vertex <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/16564d5ea985b3a19b9c976c45a3584ab34a332e.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> and some vertex in <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/7ee9276c1951e3f1f15d7dc61a5012fa00d1ca1c.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> and compute the value <span class=\"tex-span\"><i>d</i></span> of the resulting component. If the resulting component is a tree, the value <span class=\"tex-span\"><i>d</i></span> is the <span class=\"tex-font-style-it\">diameter</span> of the component, and it is equal to <span class=\"tex-font-style-tt\">-1</span> otherwise. What is the expected value of <span class=\"tex-span\"><i>d</i></span>, if we choose vertices <span class=\"tex-span\"><i>a</i></span> and <span class=\"tex-span\"><i>b</i></span> from the sets uniformly at random?</p><p>Can you help Pasha to solve this problem?</p><p>The <span class=\"tex-font-style-it\">diameter</span> of the component is the maximum <span class=\"tex-font-style-it\">distance</span> among some pair of vertices in the component. The <span class=\"tex-font-style-it\">distance</span> between two vertices is the minimum number of edges on some path between the two vertices.</p><p>Note that queries don't add edges to the initial forest. </p>",
    "inputSpecification": "<p>The first line contains three integers <span class=\"tex-span\"><i>n</i></span>, <span class=\"tex-span\"><i>m</i></span> and <span class=\"tex-span\"><i>q</i></span>(<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>,\u2009<i>q</i>\u2009\u2264\u200910<sup class=\"upper-index\">5</sup></span>)\u00a0\u2014 the number of vertices, the number of edges in the graph and the number of queries.</p><p>Each of the next <span class=\"tex-span\"><i>m</i></span> lines contains two integers <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>u</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>v</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i></span>), that means there is an edge between vertices <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span>.</p><p>It is guaranteed that the given graph is a forest.</p><p>Each of the next <span class=\"tex-span\"><i>q</i></span> lines contains two integers <span class=\"tex-span\"><i>u</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>u</i><sub class=\"lower-index\"><i>i</i></sub>,\u2009<i>v</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i></span>)\u00a0\u2014 the vertices given in the <span class=\"tex-span\"><i>i</i></span>-th query.</p>",
    "outputSpecification": "<p>For each query print the expected value of <span class=\"tex-span\"><i>d</i></span> as described in the problem statement.</p><p>Your answer will be considered correct if its absolute or relative error does not exceed <span class=\"tex-span\">10<sup class=\"upper-index\">\u2009-\u20096</sup></span>. Let's assume that your answer is <span class=\"tex-span\"><i>a</i></span>, and the jury's answer is <span class=\"tex-span\"><i>b</i></span>. The checker program will consider your answer correct, if <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/c97ba2000ebfad962bff7ffd8d043594f5ae1086.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p>",
    "samples": [
        {
            "input": "3 1 2<br/>1 3<br/>3 1<br/>2 3<br/>",
            "output": "-1<br/>2.0000000000<br/>"
        },
        {
            "input": "5 2 3<br/>2 4<br/>4 3<br/>4 2<br/>4 1<br/>2 5<br/>",
            "output": "-1<br/>2.6666666667<br/>2.6666666667<br/>"
        }
    ],
    "note": "<p>In the first example the vertices <span class=\"tex-span\">1</span> and <span class=\"tex-span\">3</span> are in the same component, so the answer for the first query is <span class=\"tex-font-style-tt\">-1</span>. For the second query there are two options to add the edge: one option is to add the edge <span class=\"tex-span\">1\u2009-\u20092</span>, the other one is <span class=\"tex-span\">2\u2009-\u20093</span>. In both ways the resulting diameter is <span class=\"tex-span\">2</span>, so the answer is <span class=\"tex-span\">2</span>.</p><p>In the second example the answer for the first query is obviously <span class=\"tex-font-style-tt\">-1</span>. The answer for the second query is the average of three cases: for added edges <span class=\"tex-span\">1\u2009-\u20092</span> or <span class=\"tex-span\">1\u2009-\u20093</span> the diameter is <span class=\"tex-span\">3</span>, and for added edge <span class=\"tex-span\">1\u2009-\u20094</span> the diameter is <span class=\"tex-span\">2</span>. Thus, the answer is <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/f12c59a7dfd20580ff1e8e5eeab9ecd19cb3c3f1.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p>",
    "contestId": 804,
    "index": "D",
    "name": "Expected diameter of a tree",
    "type": "PROGRAMMING",
    "tags": [
        "binary search",
        "brute force",
        "dfs and similar",
        "dp",
        "sortings",
        "trees"
    ],
    "solvedCount": 1259
}