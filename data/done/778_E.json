{
    "title": "E. Selling Numbers",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>Boris really likes numbers and even owns a small shop selling interesting numbers. He has <span class=\"tex-span\"><i>n</i></span> decimal numbers <span class=\"tex-span\"><i>B</i><sub class=\"lower-index\"><i>i</i></sub></span>. Cost of the number in his shop is equal to the sum of costs of its digits. You are given the values <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>d</i></sub></span>, where <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>d</i></sub></span> is the cost of the digit <span class=\"tex-span\"><i>d</i></span>. Of course, Boris is interested in that numbers he owns have the maximum cost possible.</p><p>Recently Boris got hold of the magical artifact <span class=\"tex-span\"><i>A</i></span>, which can allow him to increase the cost of his collection. Artifact is a string, consisting of digits and '<span class=\"tex-font-style-tt\">?</span>' symbols. To use the artifact, Boris must replace all '<span class=\"tex-font-style-tt\">?</span>' with digits to get a decimal number without leading zeros (it is also not allowed to get number 0). After that, the resulting number is added to all numbers <span class=\"tex-span\"><i>B</i><sub class=\"lower-index\"><i>i</i></sub></span> in Boris' collection. He uses the artifact exactly once.</p><p>What is the maximum cost of the collection Boris can achieve after using the artifact?</p>",
    "inputSpecification": "<p>First line contains artifact <span class=\"tex-span\"><i>A</i></span>, consisting of digits '<span class=\"tex-font-style-tt\">0</span>'\u2013'<span class=\"tex-font-style-tt\">9</span>' and '<span class=\"tex-font-style-tt\">?</span>' symbols (<span class=\"tex-span\">1\u2009\u2264\u2009|<i>A</i>|\u2009\u2264\u20091000</span>). Next line contains <span class=\"tex-span\"><i>n</i></span>\u00a0\u2014 the amount of numbers in Boris' collection (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>\u2009\u2264\u20091000</span>). Next <span class=\"tex-span\"><i>n</i></span> lines contain integers <span class=\"tex-span\"><i>B</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>B</i><sub class=\"lower-index\"><i>i</i></sub>\u2009&lt;\u200910<sup class=\"upper-index\">1000</sup></span>). <span class=\"tex-span\"><i>A</i></span> doesn't start with '<span class=\"tex-font-style-tt\">0</span>'.</p><p>Last line contains ten integers\u00a0\u2014 costs of digits <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\">0</sub>,\u2009<i>c</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>c</i><sub class=\"lower-index\">9</sub></span> (<span class=\"tex-span\">0\u2009\u2264\u2009<i>c</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u20091000</span>).</p>",
    "outputSpecification": "<p>Output one integer\u00a0\u2014 the maximum possible cost of the collection after using the artifact.</p>",
    "samples": [
        {
            "input": "42<br/>3<br/>89<br/>1<br/>958<br/>0 0 1 1 2 2 3 3 4 4<br/>",
            "output": "4<br/>"
        },
        {
            "input": "?5?<br/>4<br/>2203<br/>5229<br/>276<br/>6243<br/>2 1 6 1 1 2 5 2 2 3<br/>",
            "output": "62<br/>"
        }
    ],
    "note": "<p>In the second sample input, the optimal way is to compose the number <span class=\"tex-font-style-tt\">453</span>. After adding this number, Boris will have numbers <span class=\"tex-font-style-tt\">2656</span>, <span class=\"tex-font-style-tt\">5682</span>, <span class=\"tex-font-style-tt\">729</span> and <span class=\"tex-font-style-tt\">6696</span>. The total cost of all digits in them is equal to <span class=\"tex-span\">18\u2009+\u200915\u2009+\u200911\u2009+\u200918\u2009=\u200962</span>. </p>",
    "contestId": 778,
    "index": "E",
    "name": "Selling Numbers",
    "type": "PROGRAMMING",
    "tags": [
        "dp",
        "sortings"
    ],
    "solvedCount": 303
}