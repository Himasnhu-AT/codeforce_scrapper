{
    "title": "C. Fixed Point Removal",
    "timeLimit": {
        "value": 4.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Let $$$a_1, \\ldots, a_n$$$ be an array of $$$n$$$ positive integers. In one operation, you can choose an index $$$i$$$ such that $$$a_i = i$$$, and remove $$$a_i$$$ from the array (after the removal, the remaining parts are concatenated).</p><p>The weight of $$$a$$$ is defined as the maximum number of elements you can remove.</p><p>You must answer $$$q$$$ independent queries $$$(x, y)$$$: after replacing the $$$x$$$ first elements of $$$a$$$ and the $$$y$$$ last elements of $$$a$$$ by $$$n+1$$$ (making them impossible to remove), what would be the weight of $$$a$$$?</p>",
    "inputSpecification": "<p>The first line contains two integers $$$n$$$ and $$$q$$$ ($$$1 \\le n, q \\le 3 \\cdot 10^5$$$) \u00a0\u2014 the length of the array and the number of queries.</p><p>The second line contains $$$n$$$ integers $$$a_1$$$, $$$a_2$$$, ..., $$$a_n$$$ ($$$1 \\leq a_i \\leq n$$$)\u00a0\u2014 elements of the array.</p><p>The $$$i$$$-th of the next $$$q$$$ lines contains two integers $$$x$$$ and $$$y$$$ ($$$x, y \\ge 0$$$ and $$$x+y &lt; n$$$).</p>",
    "outputSpecification": "<p>Print $$$q$$$ lines, $$$i$$$-th line should contain a single integer \u00a0\u2014 the answer to the $$$i$$$-th query.</p>",
    "samples": [
        {
            "input": "\n13 5\n2 2 3 9 5 4 6 5 7 8 3 11 13\n3 1\n0 0\n2 4\n5 0\n0 12\n",
            "output": "\n5\n11\n6\n1\n0\n"
        },
        {
            "input": "\n5 2\n1 4 1 2 4\n0 0\n1 0\n",
            "output": "\n2\n0\n"
        }
    ],
    "note": "<p>Explanation of the first query:</p><p>After making first $$$x = 3$$$ and last $$$y = 1$$$ elements impossible to remove, $$$a$$$ becomes $$$[\\times, \\times, \\times, 9, 5, 4, 6, 5, 7, 8, 3, 11, \\times]$$$ (we represent $$$14$$$ as $$$\\times$$$ for clarity).</p><p>Here is a strategy that removes $$$5$$$ elements (the element removed is colored in red):</p><ul> <li> $$$[\\times, \\times, \\times, 9, \\color{red}{5}, 4, 6, 5, 7, 8, 3, 11, \\times]$$$ </li><li> $$$[\\times, \\times, \\times, 9, 4, 6, 5, 7, 8, 3, \\color{red}{11}, \\times]$$$ </li><li> $$$[\\times, \\times, \\times, 9, 4, \\color{red}{6}, 5, 7, 8, 3, \\times]$$$ </li><li> $$$[\\times, \\times, \\times, 9, 4, 5, 7, \\color{red}{8}, 3, \\times]$$$ </li><li> $$$[\\times, \\times, \\times, 9, 4, 5, \\color{red}{7}, 3, \\times]$$$ </li><li> $$$[\\times, \\times, \\times, 9, 4, 5, 3, \\times]$$$ (final state) </li></ul><p>It is impossible to remove more than $$$5$$$ elements, hence the weight is $$$5$$$.</p>",
    "contestId": 1404,
    "index": "C",
    "name": "Fixed Point Removal",
    "type": "PROGRAMMING",
    "tags": [
        "binary search",
        "constructive algorithms",
        "data structures",
        "greedy",
        "two pointers"
    ],
    "solvedCount": 2512
}