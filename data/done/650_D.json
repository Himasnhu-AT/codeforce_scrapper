{
    "title": "D. Zip-line",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Vasya has decided to build a zip-line on trees of a nearby forest. He wants the line to be as long as possible but he doesn't remember exactly the heights of all trees in the forest. He is sure that he remembers correct heights of all trees except, possibly, one of them.</p><p>It is known that the forest consists of <span class=\"tex-span\"><i>n</i></span> trees staying in a row numbered from left to right with integers from <span class=\"tex-span\">1</span> to <span class=\"tex-span\"><i>n</i></span>. According to Vasya, the height of the <span class=\"tex-span\"><i>i</i></span>-th tree is equal to <span class=\"tex-span\"><i>h</i><sub class=\"lower-index\"><i>i</i></sub></span>. The zip-line of length <span class=\"tex-span\"><i>k</i></span> should hang over <span class=\"tex-span\"><i>k</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>k</i>\u2009\u2264\u2009<i>n</i></span>) trees <span class=\"tex-span\"><i>i</i><sub class=\"lower-index\">1</sub>,\u2009<i>i</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>i</i><sub class=\"lower-index\"><i>k</i></sub></span> (<span class=\"tex-span\"><i>i</i><sub class=\"lower-index\">1</sub>\u2009&lt;\u2009<i>i</i><sub class=\"lower-index\">2</sub>\u2009&lt;\u2009...\u2009&lt;\u2009<i>i</i><sub class=\"lower-index\"><i>k</i></sub></span>) such that their heights form an increasing sequence, that is <span class=\"tex-span\"><i>h</i><sub class=\"lower-index\"><i>i</i><sub class=\"lower-index\">1</sub></sub>\u2009&lt;\u2009<i>h</i><sub class=\"lower-index\"><i>i</i><sub class=\"lower-index\">2</sub></sub>\u2009&lt;\u2009...\u2009&lt;\u2009<i>h</i><sub class=\"lower-index\"><i>i</i><sub class=\"lower-index\"><i>k</i></sub></sub></span>.</p><p>Petya had been in this forest together with Vasya, and he now has <span class=\"tex-span\"><i>q</i></span> assumptions about the mistake in Vasya's sequence <span class=\"tex-span\"><i>h</i></span>. His <span class=\"tex-span\"><i>i</i></span>-th assumption consists of two integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span> indicating that, according to Petya, the height of the tree numbered <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span> is actually equal to <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span>. Note that Petya's assumptions are <span class=\"tex-font-style-bf\">independent</span> from each other.</p><p>Your task is to find the maximum length of a zip-line that can be built over the trees under each of the <span class=\"tex-span\"><i>q</i></span> assumptions.</p><p>In this problem the length of a zip line is considered equal to the number of trees that form this zip-line.</p>",
    "inputSpecification": "<p>The first line of the input contains two integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>\u2009\u2264\u2009400\u2009000</span>)\u00a0\u2014 the number of the trees in the forest and the number of Petya's assumptions, respectively.</p><p>The following line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>h</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>h</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u200910<sup class=\"upper-index\">9</sup></span>)\u00a0\u2014 the heights of trees according to Vasya.</p><p>Each of the following <span class=\"tex-span\"><i>m</i></span> lines contains two integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>b</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u200910<sup class=\"upper-index\">9</sup></span>).</p>",
    "outputSpecification": "<p>For each of the Petya's assumptions output one integer, indicating the maximum length of a zip-line that can be built under this assumption.</p>",
    "samples": [
        {
            "input": "4 4<br/>1 2 3 4<br/>1 1<br/>1 4<br/>4 3<br/>4 5<br/>",
            "output": "4<br/>3<br/>3<br/>4<br/>"
        },
        {
            "input": "4 2<br/>1 3 2 6<br/>3 5<br/>2 4<br/>",
            "output": "4<br/>3<br/>"
        }
    ],
    "note": "<p>Consider the first sample. The first assumption actually coincides with the height remembered by Vasya. In the second assumption the heights of the trees are <span class=\"tex-span\">(4,\u20092,\u20093,\u20094)</span>, in the third one they are <span class=\"tex-span\">(1,\u20092,\u20093,\u20093)</span> and in the fourth one they are <span class=\"tex-span\">(1,\u20092,\u20093,\u20095)</span>.</p>",
    "contestId": 650,
    "index": "D",
    "name": "Zip-line",
    "type": "PROGRAMMING",
    "tags": [
        "binary search",
        "data structures",
        "dp",
        "hashing"
    ],
    "solvedCount": 1242
}