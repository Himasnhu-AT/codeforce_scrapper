{
    "title": "B. Cutting Jigsaw Puzzle",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>The Hedgehog recently remembered one of his favorite childhood activities, \u2014 solving puzzles, and got into it with new vigor. He would sit day in, day out with his friend buried into thousands of tiny pieces of the picture, looking for the required items one by one.</p><p>Soon the Hedgehog came up with a brilliant idea: instead of buying ready-made puzzles, one can take his own large piece of paper with some picture and cut it into many small rectangular pieces, then mix them and solve the resulting puzzle, trying to piece together the picture. The resulting task is even more challenging than the classic puzzle: now all the fragments have the same rectangular shape, and one can assemble the puzzle only relying on the picture drawn on the pieces.</p><p>All puzzle pieces turn out to be of the same size <span class=\"tex-span\"><i>X</i>\u2009\u00d7\u2009<i>Y</i></span>, because the picture is cut first by horizontal cuts with the pitch of <span class=\"tex-span\"><i>X</i></span>, then with vertical cuts with the pitch of <span class=\"tex-span\"><i>Y</i></span>. If we denote the initial size of the picture as <span class=\"tex-span\"><i>A</i>\u2009\u00d7\u2009<i>B</i></span>, then <span class=\"tex-span\"><i>A</i></span> must be divisible by <span class=\"tex-span\"><i>X</i></span> and <span class=\"tex-span\"><i>B</i></span> must be divisible by <span class=\"tex-span\"><i>Y</i></span> (<span class=\"tex-span\"><i>X</i></span> and <span class=\"tex-span\"><i>Y</i></span> are integer numbers). </p><p>However, not every such cutting of the picture will result in a <span class=\"tex-font-style-bf\">good</span> puzzle. The Hedgehog finds a puzzle good if no two pieces in it are the same (It is <span class=\"tex-font-style-bf\">allowed to rotate</span> the pieces when comparing them, but it is forbidden to turn them over). </p><p>Your task is to count for a given picture the number of good puzzles that you can make from it, and also to find the puzzle with the minimal piece size.</p>",
    "inputSpecification": "<p>The first line contains two numbers <span class=\"tex-span\"><i>A</i></span> and <span class=\"tex-span\"><i>B</i></span> which are the sizes of the picture. They are positive integers not exceeding 20.</p><p>Then follow <span class=\"tex-span\"><i>A</i></span> lines containing <span class=\"tex-span\"><i>B</i></span> symbols each, describing the actual picture. The lines only contain uppercase English letters.</p>",
    "outputSpecification": "<p>In the first line print the number of possible good puzzles (in other words, the number of pairs <span class=\"tex-span\">(<i>X</i>,\u2009<i>Y</i>)</span> such that the puzzle with the corresponding element sizes will be good). This number should always be positive, because the whole picture is a good puzzle itself. </p><p>In the second line print two numbers \u2014 the sizes <span class=\"tex-span\"><i>X</i></span> and <span class=\"tex-span\"><i>Y</i></span> of the smallest possible element among all good puzzles. The comparison is made firstly by the area <span class=\"tex-span\"><i>XY</i></span> of one element and secondly \u2014 by the length <span class=\"tex-span\"><i>X</i></span>.</p>",
    "samples": [
        {
            "input": "2 4<br/>ABDC<br/>ABDC<br/>",
            "output": "3<br/>2 1<br/>"
        },
        {
            "input": "2 6<br/>ABCCBA<br/>ABCCBA<br/>",
            "output": "1<br/>2 6<br/>"
        }
    ],
    "note": "<p>The picture in the first sample test has the following good puzzles: <span class=\"tex-span\">(2,\u20091)</span>, <span class=\"tex-span\">(2,\u20092)</span>, <span class=\"tex-span\">(2,\u20094)</span>.</p>",
    "contestId": 54,
    "index": "B",
    "name": "Cutting Jigsaw Puzzle",
    "type": "PROGRAMMING",
    "tags": [
        "hashing",
        "implementation"
    ],
    "solvedCount": 744
}