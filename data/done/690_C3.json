{
    "title": "C3. Brain Network (hard)",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Breaking news from zombie neurology! It turns out that \u2013 contrary to previous beliefs \u2013 every zombie is <span class=\"tex-font-style-it\">born</span> with a single brain, and only later it evolves into a complicated brain structure. In fact, whenever a zombie consumes a brain, a new brain appears in its nervous system and gets immediately connected to one of the already existing brains using a single brain connector. Researchers are now interested in monitoring the brain latency of a zombie. Your task is to write a program which, given a history of evolution of a zombie's nervous system, computes its brain latency at every stage.</p>",
    "inputSpecification": "<p>The first line of the input contains one number <span class=\"tex-span\"><i>n</i></span> \u2013 the number of brains in the final nervous system (<span class=\"tex-span\">2\u2009\u2264\u2009<i>n</i>\u2009\u2264\u2009200000</span>). In the second line a history of zombie's nervous system evolution is given. For convenience, we number all the brains by <span class=\"tex-span\">1,\u20092,\u2009...,\u2009<i>n</i></span> in the same order as they appear in the nervous system (the zombie is born with a single brain, number <span class=\"tex-span\">1</span>, and subsequently brains <span class=\"tex-span\">2,\u20093,\u2009...,\u2009<i>n</i></span> are added). The second line contains <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> space-separated numbers <span class=\"tex-span\"><i>p</i><sub class=\"lower-index\">2</sub>,\u2009<i>p</i><sub class=\"lower-index\">3</sub>,\u2009...,\u2009<i>p</i><sub class=\"lower-index\"><i>n</i></sub></span>, meaning that after a new brain <span class=\"tex-span\"><i>k</i></span> is added to the system, it gets connected to a parent-brain <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/c76b6d3543382cd0da515db077f6ef827c20b676.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>.</p>",
    "outputSpecification": "<p>Output <span class=\"tex-span\"><i>n</i>\u2009-\u20091</span> space-separated numbers \u2013 the brain latencies after the brain number <span class=\"tex-span\"><i>k</i></span> is added, for <span class=\"tex-span\"><i>k</i>\u2009=\u20092,\u20093,\u2009...,\u2009<i>n</i></span>.</p>",
    "samples": [
        {
            "input": "6<br/>1<br/>2<br/>2<br/>1<br/>5<br/>",
            "output": "1 2 2 3 4 "
        }
    ],
    "note": null,
    "contestId": 690,
    "index": "C3",
    "name": "Brain Network (hard)",
    "type": "PROGRAMMING",
    "tags": [
        "trees"
    ],
    "solvedCount": 885
}