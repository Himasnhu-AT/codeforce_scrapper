{
    "title": "D. Fixed Prefix Permutations",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>You are given $$$n$$$ permutations $$$a_1, a_2, \\dots, a_n$$$, each of length $$$m$$$. Recall that a permutation of length $$$m$$$ is a sequence of $$$m$$$ <span class=\"tex-font-style-it\">distinct</span> integers from $$$1$$$ to $$$m$$$.</p><p>Let the beauty of a permutation $$$p_1, p_2, \\dots, p_m$$$ be the largest $$$k$$$ such that $$$p_1 = 1, p_2 = 2, \\dots, p_k = k$$$. If $$$p_1 \\neq 1$$$, then the beauty is $$$0$$$.</p><p>The product of two permutations $$$p \\cdot q$$$ is a permutation $$$r$$$ such that $$$r_j = q_{p_j}$$$.</p><p>For each $$$i$$$ from $$$1$$$ to $$$n$$$, print the largest beauty of a permutation $$$a_i \\cdot a_j$$$ over all $$$j$$$ from $$$1$$$ to $$$n$$$ (possibly, $$$i = j$$$).</p>",
    "inputSpecification": "<p>The first line contains a single integer $$$t$$$ ($$$1 \\le t \\le 10^4$$$)\u00a0\u2014 the number of testcases.</p><p>The first line of each testcase contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\le n \\le 5 \\cdot 10^4$$$; $$$1 \\le m \\le 10$$$)\u00a0\u2014 the number of permutations and the length of each permutation.</p><p>The $$$i$$$-th of the next $$$n$$$ lines contains a permutation $$$a_i$$$\u00a0\u2014 $$$m$$$ distinct integers from $$$1$$$ to $$$m$$$.</p><p>The sum of $$$n$$$ doesn't exceed $$$5 \\cdot 10^4$$$ over all testcases.</p>",
    "outputSpecification": "<p>For each testcase, print $$$n$$$ integers. The $$$i$$$-th value should be equal to the largest beauty of a permutation $$$a_i \\cdot a_j$$$ over all $$$j$$$ ($$$1 \\le j \\le n$$$).</p>",
    "samples": [
        {
            "input": "\n<div class=\"test-example-line test-example-line-even test-example-line-0\">3</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">3 4</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">2 4 1 3</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">1 2 4 3</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">2 1 3 4</div><div class=\"test-example-line test-example-line-even test-example-line-2\">2 2</div><div class=\"test-example-line test-example-line-even test-example-line-2\">1 2</div><div class=\"test-example-line test-example-line-even test-example-line-2\">2 1</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">8 10</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">3 4 9 6 10 2 7 8 1 5</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">3 9 1 8 5 7 4 10 2 6</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">3 10 1 7 5 9 6 4 2 8</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">1 2 3 4 8 6 10 7 9 5</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">1 2 3 4 10 6 8 5 7 9</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">9 6 1 2 10 4 7 8 3 5</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">7 9 3 2 5 6 4 8 1 10</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">9 4 3 7 5 6 1 10 8 2</div>",
            "output": "\n1 4 4 \n2 2 \n10 8 1 6 8 10 1 7 \n"
        }
    ],
    "note": null,
    "contestId": 1792,
    "index": "D",
    "name": "Fixed Prefix Permutations",
    "type": "PROGRAMMING",
    "tags": [
        "binary search",
        "bitmasks",
        "data structures",
        "hashing",
        "math",
        "sortings"
    ],
    "solvedCount": 5971
}