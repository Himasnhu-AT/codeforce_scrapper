{
    "title": "E. Interactive Game with Coloring",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p><span class=\"tex-font-style-bf\">This is an interactive problem. Remember to flush your output while communicating with the testing program.</span> You may use <span class=\"tex-font-style-tt\">fflush(stdout)</span> in C++, <span class=\"tex-font-style-tt\">system.out.flush()</span> in Java, <span class=\"tex-font-style-tt\">stdout.flush()</span> in Python or <span class=\"tex-font-style-tt\">flush(output)</span> in Pascal to flush the output. If you use some other programming language, consult its documentation. You may also refer to the guide on interactive problems: <a href=\"https://codeforces.com/blog/entry/45307\">https://codeforces.com/blog/entry/45307</a>.</p><p>You are given a tree on $$$n$$$ vertices; vertex $$$1$$$ is the root of the tree. For every $$$i \\in [2, n]$$$, the parent of the $$$i$$$-th vertex is $$$p_i$$$, and $$$p_i &lt; i$$$.</p><p>You have to color all edges of the tree using the <span class=\"tex-font-style-bf\">minimum possible number of colors</span> such that you can win the game on that tree (every edge should be painted into exactly one color).</p><p>The game we're going to play will be conducted as follows. After you paint the edges and print their colors, the jury will place a chip into one of the vertices of the tree (except for the root). Your goal is to move this chip to the root in exactly $$$d$$$ moves, where $$$d$$$ is the distance from the root to that vertex (the distance is equal to the number of edges on the path). If the chip reaches the root in $$$d$$$ moves, you win. Otherwise, you lose.</p><p>The jury won't tell you where the chip is located. You won't even know the value of $$$d$$$ in advance. However, at the start of each move, you will be told how many edges of each color are incident to the current vertex (this includes both the edge leading up the tree and the edges leading away from the root). You have to choose one of these colors, and the chip will be moved along the edge of the chosen color (if there are multiple edges with that color incident to the current vertex, the jury gets to choose one of them). After the chip is moved, you will be told the same information about the current vertex again, and the game continues, until you either reach the root, or you make $$$d$$$ moves without reaching the root.</p><p><span class=\"tex-font-style-bf\">The interactor for this problem is adaptive</span>. It means that both the starting vertex and the current vertex are <span class=\"tex-font-style-bf\">not fixed</span> and may change \"on the run\" depending on the output of your program. However, the state of the game will always be consistent with the information you are given: <span class=\"tex-font-style-bf\">there will always be at least one starting vertex and at least one path of your chip from that vertex consistent with both the information about the colors you receive and the colors you've chosen during the moves</span>.</p>",
    "inputSpecification": "<p>The first line contains one integer $$$n$$$ ($$$3 \\le n \\le 100$$$) \u2014 the number of vertices in the tree.</p><p>The second line contains $$$n-1$$$ integers $$$p_2, p_3, \\dots, p_n$$$ ($$$1 \\le p_i &lt; i$$$), where $$$p_i$$$ is the parent of the $$$i$$$-th vertex in the tree.</p>",
    "outputSpecification": null,
    "samples": [
        {
            "input": "\n5\n1 1 1 1\n0\n1\n1",
            "output": "\n1\n1 1 1 1\n1\n"
        },
        {
            "input": "\n4\n1 2 3\n0\n0 1 0\n0\n1 1 0\n0\n1 0 1\n1",
            "output": "\n3\n3 1 2\n2\n1\n3\n"
        },
        {
            "input": "\n3\n1 2\n0\n1 1\n1\n",
            "output": "\n2\n1 2\n1"
        }
    ],
    "note": "<p>In the first example, every vertex from $$$2$$$ to $$$n$$$ is connected to the root. So, we can paint all edges into the same color $$$1$$$, and when the game starts, there will be only one edge incident to the current vertex (and it will lead to the root).</p><p>In the second example, the tree is a path of $$$4$$$ vertices. We have to paint its edges into different colors, because it can be shown that we don't have a winning strategy with just two colors.</p>",
    "contestId": 1879,
    "index": "E",
    "name": "Interactive Game with Coloring",
    "type": "PROGRAMMING",
    "tags": [
        "brute force",
        "constructive algorithms",
        "dfs and similar",
        "graphs",
        "implementation",
        "interactive",
        "trees"
    ],
    "solvedCount": 1194
}