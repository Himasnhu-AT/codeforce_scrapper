{
    "title": "E. Masha-forgetful",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Masha meets a new friend and learns his phone number\u00a0\u2014 $$$s$$$. She wants to remember it as soon as possible. The phone number\u00a0\u2014 is a string of length $$$m$$$ that consists of digits from $$$0$$$ to $$$9$$$. The phone number may start with <span class=\"tex-font-style-tt\">0</span>.</p><p>Masha already knows $$$n$$$ phone numbers (all numbers have the same length $$$m$$$). It will be easier for her to remember a new number if the $$$s$$$ is represented as segments of numbers she already knows. Each such segment must be of length <span class=\"tex-font-style-bf\">at least $$$2$$$</span>, otherwise there will be too many segments and Masha will get confused.</p><p>For example, Masha needs to remember the number: $$$s = $$$ '<span class=\"tex-font-style-tt\">12345678</span>' and she already knows $$$n = 4$$$ numbers: '<span class=\"tex-font-style-tt\">12340219</span>', '<span class=\"tex-font-style-tt\">20215601</span>', '<span class=\"tex-font-style-tt\">56782022</span>', '<span class=\"tex-font-style-tt\">12300678</span>'. You can represent $$$s$$$ as a $$$3$$$ segment: '<span class=\"tex-font-style-tt\">1234</span>' of number one, '<span class=\"tex-font-style-tt\">56</span>' of number two, and '<span class=\"tex-font-style-tt\">78</span>' of number three. There are other ways to represent $$$s$$$.</p><p>Masha asks you for help, she asks you to break the string $$$s$$$ into segments of length $$$2$$$ or more of the numbers she already knows. If there are several possible answers, print <span class=\"tex-font-style-bf\">any</span> of them.</p>",
    "inputSpecification": "<p>The first line of input data contains an integer $$$t$$$ ($$$1 \\le t \\le 10^4$$$)\u00a0\u2014the number of test cases.</p><p>Before each test case there is a blank line. Then there is a line containing integers $$$n$$$ and $$$m$$$ ($$$1 \\le n, m \\le 10^3$$$)\u00a0\u2014the number of phone numbers that Masha knows and the number of digits in each phone number. Then follow $$$n$$$ line, $$$i$$$-th of which describes the $$$i$$$-th number that Masha knows. The next line contains the phone number of her new friend $$$s$$$.</p><p>Among the given $$$n+1$$$ phones, there may be duplicates (identical phones).</p><p>It is guaranteed that the sum of $$$n \\cdot m$$$ ($$$n$$$ multiplied by $$$m$$$) values over all input test cases does not exceed $$$10^6$$$.</p>",
    "outputSpecification": "<p>You need to print the answers to $$$t$$$ test cases. The first line of the answer should contain one number $$$k$$$, corresponding to the number of segments into which you split the phone number $$$s$$$. Print <span class=\"tex-font-style-tt\">-1</span> if you cannot get such a split.</p><p>If the answer is yes, then follow $$$k$$$ lines containing triples of numbers $$$l, r, i$$$. Such triplets mean that the next $$$r-l+1$$$ digits of number $$$s$$$ are equal to a segment (substring) with boundaries $$$[l, r]$$$ of the phone under number $$$i$$$. Both the phones and the digits in them are numbered from $$$1$$$. Note that $$$r-l+1 \\ge 2$$$ for all $$$k$$$ lines.</p>",
    "samples": [
        {
            "input": "\n<div class=\"test-example-line test-example-line-even test-example-line-0\">5</div><div class=\"test-example-line test-example-line-odd test-example-line-1\"><br/></div><div class=\"test-example-line test-example-line-odd test-example-line-1\">4 8</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">12340219</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">20215601</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">56782022</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">12300678</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">12345678</div><div class=\"test-example-line test-example-line-even test-example-line-2\"><br/></div><div class=\"test-example-line test-example-line-even test-example-line-2\">2 3</div><div class=\"test-example-line test-example-line-even test-example-line-2\">134</div><div class=\"test-example-line test-example-line-even test-example-line-2\">126</div><div class=\"test-example-line test-example-line-even test-example-line-2\">123</div><div class=\"test-example-line test-example-line-odd test-example-line-3\"><br/></div><div class=\"test-example-line test-example-line-odd test-example-line-3\">1 4</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">1210</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">1221</div><div class=\"test-example-line test-example-line-even test-example-line-4\"><br/></div><div class=\"test-example-line test-example-line-even test-example-line-4\">4 3</div><div class=\"test-example-line test-example-line-even test-example-line-4\">251</div><div class=\"test-example-line test-example-line-even test-example-line-4\">064</div><div class=\"test-example-line test-example-line-even test-example-line-4\">859</div><div class=\"test-example-line test-example-line-even test-example-line-4\">957</div><div class=\"test-example-line test-example-line-even test-example-line-4\">054</div><div class=\"test-example-line test-example-line-odd test-example-line-5\"><br/></div><div class=\"test-example-line test-example-line-odd test-example-line-5\">4 7</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">7968636</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">9486033</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">4614224</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">5454197</div><div class=\"test-example-line test-example-line-odd test-example-line-5\">9482268</div>",
            "output": "\n3\n1 4 1\n5 6 2\n3 4 3\n-1\n2\n1 2 1\n2 3 1\n-1\n3\n1 3 2\n5 6 3\n3 4 1\n"
        }
    ],
    "note": "<p>The example from the statement.</p><p>In the second case, it is impossible to represent by segments of known numbers of length 2 or more.</p><p>In the third case, you can get the segments '<span class=\"tex-font-style-tt\">12</span>' and '<span class=\"tex-font-style-tt\">21</span>' from the first phone number.</p>",
    "contestId": 1624,
    "index": "E",
    "name": "Masha-forgetful",
    "type": "PROGRAMMING",
    "tags": [
        "brute force",
        "constructive algorithms",
        "dp",
        "hashing",
        "implementation",
        "strings"
    ],
    "solvedCount": 3984
}