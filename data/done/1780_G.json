{
    "title": "G. Delicious Dessert",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>Today is an important day for chef Tonio \u2014 an auditor has arrived in his hometown of Morioh. He has also arrived at Tonio's restaurant and ordered dessert. Tonio has not been prepared for this turn of events.</p><p>As you know, dessert is a string of lowercase English letters. Tonio remembered the rule of desserts\u00a0\u2014 a string $$$s$$$ of length $$$n$$$. Any dessert $$$t$$$ is <span class=\"tex-font-style-it\">delicious</span> if the number of occurrences of $$$t$$$ in $$$s$$$ as a substring is <span class=\"tex-font-style-bf\">divisible</span> by the length of $$$t$$$.</p><p>Now Tonio wants to know the number of delicious substrings of $$$s$$$. If the substring occurs several times in the string $$$s$$$, then all occurrences must be taken into account.</p>",
    "inputSpecification": "<p>The first line contains an integer $$$n$$$ ($$$1 \\leq n \\leq 10^6$$$) \u2014 the length of the rule $$$s$$$.</p><p>The second line contains the string $$$s$$$ of length $$$n$$$ \u2014 the rule. The rule consists only of lowercase English letters.</p>",
    "outputSpecification": "<p>In a single line print the number of delicious substrings of $$$s$$$.</p>",
    "samples": [
        {
            "input": "\n7\nabacaba\n",
            "output": "\n11\n"
        },
        {
            "input": "\n8\nabaababa\n",
            "output": "\n11\n"
        },
        {
            "input": "\n10\ndeadinside\n",
            "output": "\n12\n"
        },
        {
            "input": "\n5\naaaaa\n",
            "output": "\n12\n"
        }
    ],
    "note": "<p>In the first sample, there are many delicious substrings. $$$7$$$ of them are substrings of length $$$1$$$ (<span class=\"tex-font-style-it\">because any number is divisible by $$$1$$$</span>). Consider other delicious substrings:</p><ul> <li> \"<span class=\"tex-font-style-tt\">ab</span>\" occurs in $$$s$$$ $$$2$$$ times, which is divisible by the length of the substring. </li><li> \"<span class=\"tex-font-style-tt\">ba</span>\" also occurs $$$2$$$ times. </li></ul><p>Therefore, the answer is $$$7 + 2 + 2 = 11$$$.</p><p>Note that the answer includes both occurrences of \"<span class=\"tex-font-style-tt\">ab</span>\" and \"<span class=\"tex-font-style-tt\">ba</span>\".</p>",
    "contestId": 1780,
    "index": "G",
    "name": "Delicious Dessert",
    "type": "PROGRAMMING",
    "tags": [
        "binary search",
        "dsu",
        "hashing",
        "math",
        "number theory",
        "string suffix structures"
    ],
    "solvedCount": 678
}