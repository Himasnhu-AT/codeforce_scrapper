{
    "title": "E. Cyclic Cipher",
    "timeLimit": {
        "value": 5.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/550a6151b8df55658866f2b9383eed1f104d7cf5.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>Senor Vorpal Kickass'o invented an innovative method to encrypt integer sequences of length <span class=\"tex-span\"><i>n</i></span>. To encrypt a sequence, one has to choose a secret sequence <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/c1146bf07905465e664a906aeef2d536ae820df3.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>, that acts as a key.</p><p>Vorpal is very selective, so the key should be such a sequence <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span>, that its cyclic shifts are linearly independent, that is, there is no non-zero set of coefficients <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\">0</sub>,\u2009<i>x</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>x</i><sub class=\"lower-index\"><i>n</i>\u2009-\u20091</sub></span>, such that <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/546797560358482102548e689f1d4f6a4f3f51f7.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> for all <span class=\"tex-span\"><i>k</i></span> at the same time.</p><p>After that for a sequence <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/ac0849a8b9d57bfad827eb6d0c43bded96bb2261.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> you should build the following cipher:</p><center class=\"tex-equation\"><img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/7ab03a39943fa9203348006520bdfadd7973328b.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></center><p>In other words, you are to compute the quadratic deviation between each cyclic shift of <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span> and the sequence <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span>. The resulting sequence is the Kickass's cipher. The cipher is in development right now and Vorpal wants to decipher a sequence after it has been encrypted. You are to solve this problem for him. You are given sequences <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span>. You are to find all suitable sequences <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span>.</p>",
    "inputSpecification": "<p>The first line contains a single integer <span class=\"tex-span\"><i>n</i></span> (<img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/15dd0d7eb10161f8c844467763048bb5736c9340.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>).</p><p>The second line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\">0</sub>,\u2009<i>b</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>b</i><sub class=\"lower-index\"><i>n</i>\u2009-\u20091</sub></span> (<img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/8523c91fc44afb64bd85979c8fd795932943eedd.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>).</p><p>The third line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\">0</sub>,\u2009<i>c</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>c</i><sub class=\"lower-index\"><i>n</i>\u2009-\u20091</sub></span> (<img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/34928efa66264a17ac3e21237414236994ae968a.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>).</p><p>It is guaranteed that all cyclic shifts of sequence <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span> are linearly independent.</p>",
    "outputSpecification": "<p>In the first line print a single integer <span class=\"tex-span\"><i>k</i></span>\u00a0\u2014 the number of sequences <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span>, such that after encrypting them with key <span class=\"tex-span\"><i>b</i><sub class=\"lower-index\"><i>i</i></sub></span> you get the sequence <span class=\"tex-span\"><i>c</i><sub class=\"lower-index\"><i>i</i></sub></span>.</p><p>After that in each of <span class=\"tex-span\"><i>k</i></span> next lines print <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">0</sub>,\u2009<i>a</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i>\u2009-\u20091</sub></span>. Print the sequences in lexicographical order.</p><p>Note that <span class=\"tex-span\"><i>k</i></span> could be equal to <span class=\"tex-span\">0</span>.</p>",
    "samples": [
        {
            "input": "1<br/>1<br/>0<br/>",
            "output": "1<br/>1<br/>"
        },
        {
            "input": "1<br/>100<br/>81<br/>",
            "output": "2<br/>91<br/>109<br/>"
        },
        {
            "input": "3<br/>1 1 3<br/>165 185 197<br/>",
            "output": "2<br/>-6 -9 -1<br/>8 5 13<br/>"
        }
    ],
    "note": null,
    "contestId": 901,
    "index": "E",
    "name": "Cyclic Cipher",
    "type": "PROGRAMMING",
    "tags": [
        "fft",
        "math"
    ],
    "solvedCount": 85
}