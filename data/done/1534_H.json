{
    "title": "H. Lost Nodes",
    "timeLimit": {
        "value": 4.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p><span class=\"tex-font-style-it\">This is an interactive problem.</span></p><p>As he qualified for IOI this year, Little Ericyi was given a gift from all his friends: a tree of $$$n$$$ nodes!</p><p>On the flight to IOI Little Ericyi was very bored, so he decided to play a game with Little Yvonne with his new tree. First, Little Yvonne selects two (not necessarily different) nodes $$$a$$$ and $$$b$$$ on the tree (without telling Ericyi), and then gives him a hint $$$f$$$ (which is some node on the path from $$$a$$$ to $$$b$$$).</p><p>Then, Little Ericyi is able to ask the following question repeatedly:</p><ul><li> If I rooted the tree at node $$$r$$$ (Ericyi gets to choose $$$r$$$), what would be the <a href=\"https://en.wikipedia.org/wiki/Lowest_common_ancestor\">Lowest Common Ancestor</a> of $$$a$$$ and $$$b$$$?</li></ul><p>Little Ericyi's goal is to find the nodes $$$a$$$ and $$$b$$$, and report them to Little Yvonne.</p><p>However, Little Yvonne thought this game was too easy, so before he gives the hint $$$f$$$ to Little Ericyi, he also wants him to first find the maximum number of queries required to determine $$$a$$$ and $$$b$$$ over all possibilities of $$$a$$$, $$$b$$$, and $$$f$$$ assuming Little Ericyi plays optimally. Little Ericyi defines an optimal strategy as one that makes the minimum number of queries. Of course, once Little Ericyi replies with the maximum number of queries, Little Yvonne will only let him use that many queries in the game.</p><p>The tree, $$$a$$$, $$$b$$$, and $$$f$$$ are all fixed before the start of the game and do not change as queries are made.</p>",
    "inputSpecification": null,
    "outputSpecification": null,
    "samples": [
        {
            "input": "\n4\n3 2\n2 1\n2 4\n\n1\n\n1\n\n2\n\n2\n",
            "output": "\n3\n\n? 1\n\n? 2\n\n? 3\n\n! 4 1"
        },
        {
            "input": "\n5\n3 1\n1 4\n4 5\n4 2\n\n1\n\n4\n\n1\n\n4\n",
            "output": "\n3\n\n? 4\n\n? 1\n\n? 5\n\n! 1 4"
        }
    ],
    "note": "<p>Here is the the tree from the first sample interaction. Nodes $$$a$$$ and $$$b$$$ are highlighted.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/5b0b6dc78b10d9ec52afe52f9985dfd139874a00.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>Notice that $$$a$$$ and $$$b$$$ can be output in any order.</p><p>Additionally, here are the answers to querying every single node $$$1,2,\\ldots,n$$$ for your convenience:</p><ul><li> $$$1$$$: $$$1$$$ </li><li> $$$2$$$: $$$2$$$ </li><li> $$$3$$$: $$$2$$$ </li><li> $$$4$$$: $$$4$$$</li></ul><p>__________________________________________</p><p>Here is the the tree from the second sample interaction. Again, nodes $$$a$$$ and $$$b$$$ are highlighted.</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/f2819e4480c58243a49beaa5d2d5db30a781d445.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>Lastly, here are the answers to querying every single node $$$1,2,\\ldots,n$$$ (in example $$$2$$$) for your convenience:</p><ul><li> $$$1$$$: $$$1$$$ </li><li> $$$2$$$: $$$4$$$ </li><li> $$$3$$$: $$$1$$$ </li><li> $$$4$$$: $$$4$$$ </li><li> $$$5$$$: $$$4$$$</li></ul>",
    "contestId": 1534,
    "index": "H",
    "name": "Lost Nodes",
    "type": "PROGRAMMING",
    "tags": [
        "constructive algorithms",
        "dp",
        "graphs",
        "interactive",
        "sortings",
        "trees"
    ],
    "solvedCount": 145
}