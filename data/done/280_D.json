{
    "title": "D. k-Maximum Subsequence Sum",
    "timeLimit": {
        "value": 4.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Consider integer sequence <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span>. You should run queries of two types:</p><ul> <li> The query format is \"<span class=\"tex-span\">0</span> <span class=\"tex-span\"><i>i</i></span> <span class=\"tex-span\"><i>val</i></span>\". In reply to this query you should make the following assignment: <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009=\u2009<i>val</i></span>. </li><li> The query format is \"<span class=\"tex-span\">1</span> <span class=\"tex-span\"><i>l</i></span> <span class=\"tex-span\"><i>r</i></span> <span class=\"tex-span\"><i>k</i></span>\". In reply to this query you should print the maximum sum of at most <span class=\"tex-span\"><i>k</i></span> non-intersecting subsegments of sequence <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>l</i></sub>,\u2009<i>a</i><sub class=\"lower-index\"><i>l</i>\u2009+\u20091</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>r</i></sub></span>. Formally, you should choose at most <span class=\"tex-span\"><i>k</i></span> pairs of integers <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">1</sub>,\u2009<i>y</i><sub class=\"lower-index\">1</sub>),\u2009(<i>x</i><sub class=\"lower-index\">2</sub>,\u2009<i>y</i><sub class=\"lower-index\">2</sub>),\u2009...,\u2009(<i>x</i><sub class=\"lower-index\"><i>t</i></sub>,\u2009<i>y</i><sub class=\"lower-index\"><i>t</i></sub>)</span> <span class=\"tex-span\">(<i>l</i>\u2009\u2264\u2009<i>x</i><sub class=\"lower-index\">1</sub>\u2009\u2264\u2009<i>y</i><sub class=\"lower-index\">1</sub>\u2009&lt;\u2009<i>x</i><sub class=\"lower-index\">2</sub>\u2009\u2264\u2009<i>y</i><sub class=\"lower-index\">2</sub>\u2009&lt;\u2009...\u2009&lt;\u2009<i>x</i><sub class=\"lower-index\"><i>t</i></sub>\u2009\u2264\u2009<i>y</i><sub class=\"lower-index\"><i>t</i></sub>\u2009\u2264\u2009<i>r</i>;\u00a0<i>t</i>\u2009\u2264\u2009<i>k</i>)</span> such that the sum <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>x</i><sub class=\"lower-index\">1</sub></sub>\u2009+\u2009<i>a</i><sub class=\"lower-index\"><i>x</i><sub class=\"lower-index\">1</sub>\u2009+\u20091</sub>\u2009+\u2009...\u2009+\u2009<i>a</i><sub class=\"lower-index\"><i>y</i><sub class=\"lower-index\">1</sub></sub>\u2009+\u2009<i>a</i><sub class=\"lower-index\"><i>x</i><sub class=\"lower-index\">2</sub></sub>\u2009+\u2009<i>a</i><sub class=\"lower-index\"><i>x</i><sub class=\"lower-index\">2</sub>\u2009+\u20091</sub>\u2009+\u2009...\u2009+\u2009<i>a</i><sub class=\"lower-index\"><i>y</i><sub class=\"lower-index\">2</sub></sub>\u2009+\u2009...\u2009+\u2009<i>a</i><sub class=\"lower-index\"><i>x</i><sub class=\"lower-index\"><i>t</i></sub></sub>\u2009+\u2009<i>a</i><sub class=\"lower-index\"><i>x</i><sub class=\"lower-index\"><i>t</i></sub>\u2009+\u20091</sub>\u2009+\u2009...\u2009+\u2009<i>a</i><sub class=\"lower-index\"><i>y</i><sub class=\"lower-index\"><i>t</i></sub></sub></span> is as large as possible. Note that you should choose at most <span class=\"tex-span\"><i>k</i></span> subsegments. Particularly, you can choose 0 subsegments. In this case the described sum considered equal to zero. </li></ul>",
    "inputSpecification": "<p>The first line contains integer <span class=\"tex-span\"><i>n</i></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>n</i>\u2009\u2264\u200910<sup class=\"upper-index\">5</sup>)</span>, showing how many numbers the sequence has. The next line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> <span class=\"tex-span\">(|<i>a</i><sub class=\"lower-index\"><i>i</i></sub>|\u2009\u2264\u2009500)</span>. </p><p>The third line contains integer <span class=\"tex-span\"><i>m</i></span> <span class=\"tex-span\">(1\u2009\u2264\u2009<i>m</i>\u2009\u2264\u200910<sup class=\"upper-index\">5</sup>)</span> \u2014 the number of queries. The next <span class=\"tex-span\"><i>m</i></span> lines contain the queries in the format, given in the statement.</p><p>All changing queries fit into limits: <span class=\"tex-span\">1\u2009\u2264\u2009<i>i</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\">|<i>val</i>|\u2009\u2264\u2009500</span>.</p><p>All queries to count the maximum sum of at most <span class=\"tex-span\"><i>k</i></span> non-intersecting subsegments fit into limits: <span class=\"tex-span\">1\u2009\u2264\u2009<i>l</i>\u2009\u2264\u2009<i>r</i>\u2009\u2264\u2009<i>n</i></span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>k</i>\u2009\u2264\u200920</span>. It is guaranteed that the number of the queries to count the maximum sum of at most <span class=\"tex-span\"><i>k</i></span> non-intersecting subsegments doesn't exceed <span class=\"tex-span\">10000</span>.</p>",
    "outputSpecification": "<p>For each query to count the maximum sum of at most <span class=\"tex-span\"><i>k</i></span> non-intersecting subsegments print the reply \u2014 the maximum sum. Print the answers to the queries in the order, in which the queries follow in the input.</p>",
    "samples": [
        {
            "input": "9<br/>9 -8 9 -1 -1 -1 9 -8 9<br/>3<br/>1 1 9 1<br/>1 1 9 2<br/>1 4 6 3<br/>",
            "output": "17<br/>25<br/>0<br/>"
        },
        {
            "input": "15<br/>-4 8 -3 -10 10 4 -7 -7 0 -6 3 8 -10 7 2<br/>15<br/>1 3 9 2<br/>1 6 12 1<br/>0 6 5<br/>0 10 -7<br/>1 4 9 1<br/>1 7 9 1<br/>0 10 -3<br/>1 4 10 2<br/>1 3 13 2<br/>1 4 11 2<br/>0 15 -9<br/>0 13 -9<br/>0 11 -10<br/>1 5 14 2<br/>1 6 12 1<br/>",
            "output": "14<br/>11<br/>15<br/>0<br/>15<br/>26<br/>18<br/>23<br/>8<br/>"
        }
    ],
    "note": "<p>In the first query of the first example you can select a single pair <span class=\"tex-span\">(1,\u20099)</span>. So the described sum will be 17.</p><p>Look at the second query of the first example. How to choose two subsegments? (1, 3) and (7, 9)? Definitely not, the sum we could get from (1, 3) and (7, 9) is 20, against the optimal configuration (1, 7) and (9, 9) with 25.</p><p>The answer to the third query is 0, we prefer select nothing if all of the numbers in the given interval are negative.</p>",
    "contestId": 280,
    "index": "D",
    "name": "k-Maximum Subsequence Sum",
    "type": "PROGRAMMING",
    "tags": [
        "data structures",
        "flows",
        "graphs",
        "implementation"
    ],
    "solvedCount": 1206
}