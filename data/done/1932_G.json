{
    "title": "G. Moving Platforms",
    "timeLimit": {
        "value": 3.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>There is a game where you need to move through a labyrinth. The labyrinth consists of $$$n$$$ platforms, connected by $$$m$$$ passages. </p><p>Each platform is at some level $$$l_i$$$, an integer number from $$$0$$$ to $$$H - 1$$$. In a single step, if you are currently on platform $$$i$$$, you can stay on it, or move to another platform $$$j$$$. To move to platform $$$j$$$ they have to be connected by the passage, and their levels have to be the same, namely $$$l_i = l_j$$$.</p><p>After each step, the levels of all platforms change. The new level of platform $$$i$$$ is calculated as $$$l'_i = (l_i + s_i) \\bmod H$$$, for all $$$i$$$. </p><p>You start on platform $$$1$$$. Find the minimum number of steps you need to get to platform $$$n$$$.</p>",
    "inputSpecification": "<p>The first line of input contains a single integer $$$t$$$ ($$$1 \\le t \\le 10^4$$$)\u00a0\u2014 the number of test cases. Then the descriptions of the test cases follow.</p><p>The first line of each test case contains three integers $$$n$$$, $$$m$$$, and $$$H$$$ ($$$2 \\le n \\le 10^5$$$, $$$1 \\le m \\le 10^5$$$, $$$1 \\le H \\le 10^9$$$).</p><p>The second line contains $$$n$$$ integers $$$l_i$$$, the initial level of each platform ($$$0 \\le l_i \\le H-1$$$). </p><p>The third line contains $$$n$$$ integers $$$s_i$$$, the change of level for each platform ($$$0 \\le s_i \\le H-1$$$).</p><p>Next $$$m$$$ lines contain a description of the passages. Each passage is described as a pair of integers\u00a0\u2014 the platforms, connected by the passage. There is at most one passage connecting each pair of platforms, and there is no passage connecting a platform to itself.</p><p>The sum of $$$n$$$ for all tests does not exceed $$$10^5$$$, the sum of $$$m$$$ for all tests does not exceed $$$10^5$$$.</p>",
    "outputSpecification": "<p>For each test case, print a single integer, the minimum number of steps needed to get from platform $$$1$$$ to platform $$$n$$$.</p><p>If it is impossible to get to platform $$$n$$$, print $$$-1$$$.</p>",
    "samples": [
        {
            "input": "\n<div class=\"test-example-line test-example-line-even test-example-line-0\">3</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">3 3 10</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">1 9 4</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">2 3 0</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">1 2</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">3 2</div><div class=\"test-example-line test-example-line-odd test-example-line-1\">1 3</div><div class=\"test-example-line test-example-line-even test-example-line-2\">2 1 10</div><div class=\"test-example-line test-example-line-even test-example-line-2\">1 2</div><div class=\"test-example-line test-example-line-even test-example-line-2\">4 6</div><div class=\"test-example-line test-example-line-even test-example-line-2\">1 2</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">8 7 25</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">22 14 5 3 10 14 11 1</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">9 5 4 10 7 16 18 18</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">2 8</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">6 3</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">3 5</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">7 5</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">2 6</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">1 4</div><div class=\"test-example-line test-example-line-odd test-example-line-3\">4 7</div>",
            "output": "\n6\n-1\n52\n"
        }
    ],
    "note": "<p>This is how levels of the platforms change, and what actions we need to perform in the first example.</p><p><table class=\"tex-tabular\"><tbody><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Platform 1</span></td><td class=\"tex-tabular-text-align-center tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Platform 2</span></td><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Platform 3</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Action</span></td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top\"><span class=\"tex-font-style-bf\">Step 1</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-top\">1</td><td class=\"tex-tabular-text-align-center tex-tabular-border-top\">9</td><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top\">4</td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top\">Stay on the platform 1</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right\"><span class=\"tex-font-style-bf\">Step 2</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-center\">3</td><td class=\"tex-tabular-text-align-center\">2</td><td class=\"tex-tabular-text-align-center tex-tabular-border-right\">4</td><td class=\"tex-tabular-border-left tex-tabular-text-align-left\">Stay on the platform 1</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right\"><span class=\"tex-font-style-bf\">Step 3</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-center\"><span class=\"tex-font-style-bf\">5</span></td><td class=\"tex-tabular-text-align-center\"><span class=\"tex-font-style-bf\">5</span></td><td class=\"tex-tabular-text-align-center tex-tabular-border-right\">4</td><td class=\"tex-tabular-border-left tex-tabular-text-align-left\">Move to the platform 2</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right\"><span class=\"tex-font-style-bf\">Step 4</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-center\">7</td><td class=\"tex-tabular-text-align-center\">8</td><td class=\"tex-tabular-text-align-center tex-tabular-border-right\">4</td><td class=\"tex-tabular-border-left tex-tabular-text-align-left\">Stay on the platform 2</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right\"><span class=\"tex-font-style-bf\">Step 5</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-center\">9</td><td class=\"tex-tabular-text-align-center\">1</td><td class=\"tex-tabular-text-align-center tex-tabular-border-right\">4</td><td class=\"tex-tabular-border-left tex-tabular-text-align-left\">Stay on the platform 2</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right\"><span class=\"tex-font-style-bf\">Step 6</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-center\">1</td><td class=\"tex-tabular-text-align-center\"><span class=\"tex-font-style-bf\">4</span></td><td class=\"tex-tabular-text-align-center tex-tabular-border-right\"><span class=\"tex-font-style-bf\">4</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left\">Move to the platform 3</td></tr></tbody></table></p>",
    "contestId": 1932,
    "index": "G",
    "name": "Moving Platforms",
    "type": "PROGRAMMING",
    "tags": [
        "graphs",
        "math",
        "number theory",
        "shortest paths"
    ],
    "solvedCount": 916
}