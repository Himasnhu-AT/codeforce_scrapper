{
    "title": "F. Guards In The Storehouse",
    "timeLimit": {
        "value": 1.5,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 512.0,
        "unit": "megabytes"
    },
    "statement": "<p>Polycarp owns a shop in the capital of Berland. Recently the criminal activity in the capital increased, so Polycarp is thinking about establishing some better security in the storehouse of his shop.</p><p>The storehouse can be represented as a matrix with <span class=\"tex-span\"><i>n</i></span> rows and <span class=\"tex-span\"><i>m</i></span> columns. Each element of the matrix is either <span class=\"tex-font-style-tt\">.</span> (an empty space) or <span class=\"tex-font-style-tt\">x</span> (a wall).</p><p>Polycarp wants to hire some guards (possibly zero) to watch for the storehouse. Each guard will be in some cell of matrix and will protect every cell to the right of his own cell and every cell to the bottom of his own cell, until the nearest wall. More formally, if the guard is standing in the cell <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">0</sub>,\u2009<i>y</i><sub class=\"lower-index\">0</sub>)</span>, then he protects cell <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">1</sub>,\u2009<i>y</i><sub class=\"lower-index\">1</sub>)</span> if all these conditions are met:</p><ul> <li> <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">1</sub>,\u2009<i>y</i><sub class=\"lower-index\">1</sub>)</span> is an empty cell; </li><li> either <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\">0</sub>\u2009=\u2009<i>x</i><sub class=\"lower-index\">1</sub></span> and <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\">0</sub>\u2009\u2264\u2009<i>y</i><sub class=\"lower-index\">1</sub></span>, or <span class=\"tex-span\"><i>x</i><sub class=\"lower-index\">0</sub>\u2009\u2264\u2009<i>x</i><sub class=\"lower-index\">1</sub></span> and <span class=\"tex-span\"><i>y</i><sub class=\"lower-index\">0</sub>\u2009=\u2009<i>y</i><sub class=\"lower-index\">1</sub></span>; </li><li> there are no walls between cells <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">0</sub>,\u2009<i>y</i><sub class=\"lower-index\">0</sub>)</span> and <span class=\"tex-span\">(<i>x</i><sub class=\"lower-index\">1</sub>,\u2009<i>y</i><sub class=\"lower-index\">1</sub>)</span>. <span class=\"tex-font-style-bf\">There can be a guard between these cells, guards can look through each other.</span> </li></ul><p>Guards can be placed only in empty cells (and can protect only empty cells). The <span class=\"tex-font-style-it\">plan</span> of placing the guards is some set of cells where guards will be placed (of course, two plans are different if there exists at least one cell that is included in the first plan, but not included in the second plan, or vice versa). Polycarp calls a plan <span class=\"tex-font-style-it\">suitable</span> if there is <span class=\"tex-font-style-bf\">not more than one</span> empty cell that is not protected.</p><p>Polycarp wants to know the number of suitable plans. Since it can be very large, you have to output it modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>.</p>",
    "inputSpecification": "<p>The first line contains two numbers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span> \u2014 the length and the width of the storehouse (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>\u2009\u2264\u2009250</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>nm</i>\u2009\u2264\u2009250</span>).</p><p>Then <span class=\"tex-span\"><i>n</i></span> lines follow, <span class=\"tex-span\"><i>i</i></span>th line contains a string consisting of <span class=\"tex-span\"><i>m</i></span> characters \u2014 <span class=\"tex-span\"><i>i</i></span>th row of the matrix representing the storehouse. Each character is either <span class=\"tex-font-style-tt\">.</span> or <span class=\"tex-font-style-tt\">x</span>.</p>",
    "outputSpecification": "<p>Output the number of suitable plans modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>.</p>",
    "samples": [
        {
            "input": "1 3<br/>.x.<br/>",
            "output": "3<br/>"
        },
        {
            "input": "2 2<br/>xx<br/>xx<br/>",
            "output": "1<br/>"
        },
        {
            "input": "2 2<br/>..<br/>..<br/>",
            "output": "10<br/>"
        },
        {
            "input": "3 1<br/>x<br/>.<br/>x<br/>",
            "output": "2<br/>"
        }
    ],
    "note": "<p>In the first example you have to put at least one guard, so there are three possible arrangements: one guard in the cell <span class=\"tex-span\">(1,\u20091)</span>, one guard in the cell <span class=\"tex-span\">(1,\u20093)</span>, and two guards in both these cells.</p>",
    "contestId": 845,
    "index": "F",
    "name": "Guards In The Storehouse",
    "type": "PROGRAMMING",
    "tags": [
        "bitmasks",
        "dp"
    ],
    "solvedCount": 423
}