{
    "title": "E. A Museum Robbery",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>There's a famous museum in the city where Kleof\u00e1\u0161 lives. In the museum, <span class=\"tex-span\"><i>n</i></span> exhibits (numbered <span class=\"tex-span\">1</span> through <span class=\"tex-span\"><i>n</i></span>) had been displayed for a long time; the <span class=\"tex-span\"><i>i</i></span>-th of those exhibits has value <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> and mass <span class=\"tex-span\"><i>w</i><sub class=\"lower-index\"><i>i</i></sub></span>. </p><p>Then, the museum was bought by a large financial group and started to vary the exhibits. At about the same time, Kleof\u00e1\u0161... gained interest in the museum, so to say.</p><p>You should process <span class=\"tex-span\"><i>q</i></span> events of three types:</p><ul><li> type <span class=\"tex-span\">1</span> \u2014 the museum displays an exhibit with value <span class=\"tex-span\"><i>v</i></span> and mass <span class=\"tex-span\"><i>w</i></span>; the exhibit displayed in the <span class=\"tex-span\"><i>i</i></span>-th event of this type is numbered <span class=\"tex-span\"><i>n</i>\u2009+\u2009<i>i</i></span> (see sample explanation for more details)</li><li> type <span class=\"tex-span\">2</span> \u2014 the museum removes the exhibit with number <span class=\"tex-span\"><i>x</i></span> and stores it safely in its vault</li><li> type <span class=\"tex-span\">3</span> \u2014 Kleof\u00e1\u0161 visits the museum and wonders (for no important reason at all, of course): if there was a robbery and exhibits with total mass at most <span class=\"tex-span\"><i>m</i></span> were stolen, what would their maximum possible total value be?</li></ul><p>For each event of type 3, let <span class=\"tex-span\"><i>s</i>(<i>m</i>)</span> be the maximum possible total value of stolen exhibits with total mass <span class=\"tex-span\">\u2009\u2264\u2009<i>m</i></span>.</p><p>Formally, let <span class=\"tex-span\"><i>D</i></span> be the set of numbers of all exhibits that are currently displayed (so initially <span class=\"tex-span\"><i>D</i></span> = {1, ..., n}). Let <span class=\"tex-span\"><i>P</i>(<i>D</i>)</span> be the set of all subsets of <span class=\"tex-span\"><i>D</i></span> and let </p><center class=\"tex-equation\"><img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/2d29385d7a96042070a59354d9aa9dbbb3b0cfbe.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></center><p>Then, <span class=\"tex-span\"><i>s</i>(<i>m</i>)</span> is defined as </p><center class=\"tex-equation\"><img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/e44e3f211ddf59e954fe7d37e335aec12b26f686.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></center><p>Compute <span class=\"tex-span\"><i>s</i>(<i>m</i>)</span> for each <img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/34ca452cd2f1c2ab8922517e9cc383e39874d188.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/>. Note that the output follows a special format.</p>",
    "inputSpecification": "<p>The first line of the input contains two space-separated integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>k</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>\u2009\u2264\u20095000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>k</i>\u2009\u2264\u20091000</span>) \u2014 the initial number of exhibits in the museum and the maximum interesting mass of stolen exhibits. </p><p>Then, <span class=\"tex-span\"><i>n</i></span> lines follow. The <span class=\"tex-span\"><i>i</i></span>-th of them contains two space-separated positive integers <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>w</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>v</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u20091\u2009000\u2009000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>w</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u20091000</span>)\u00a0\u2014 the value and mass of the <span class=\"tex-span\"><i>i</i></span>-th exhibit.</p><p>The next line contains a single integer <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u200930\u2009000</span>)\u00a0\u2014 the number of events.</p><p>Each of the next <span class=\"tex-span\"><i>q</i></span> lines contains the description of one event in the following format:</p><ul><li> <span class=\"tex-span\">1 <i>v</i> <i>w</i></span> \u2014 an event of type 1, a new exhibit with value <span class=\"tex-span\"><i>v</i></span> and mass <span class=\"tex-span\"><i>w</i></span> has been added (<span class=\"tex-span\">1\u2009\u2264\u2009<i>v</i>\u2009\u2264\u20091\u2009000\u2009000</span>, <span class=\"tex-span\">1\u2009\u2264\u2009<i>w</i>\u2009\u2264\u20091000</span>)</li><li> <span class=\"tex-span\">2 <i>x</i></span> \u2014 an event of type 2, the exhibit with number <span class=\"tex-span\"><i>x</i></span> has been removed; it's guaranteed that the removed exhibit had been displayed at that time</li><li> <span class=\"tex-span\">3</span> \u2014 an event of type 3, Kleof\u00e1\u0161 visits the museum and asks his question</li></ul><p>There will be at most <span class=\"tex-span\">10\u2009000</span> events of type 1 and at least one event of type 3.</p>",
    "outputSpecification": "<p>As the number of values <span class=\"tex-span\"><i>s</i>(<i>m</i>)</span> can get large, output the answers to events of type 3 in a special format.</p><p>For each event of type 3, consider the values <span class=\"tex-span\"><i>s</i>(<i>m</i>)</span> computed for the question that Kleof\u00e1\u0161 asked in this event; print one line containing a single number </p><center class=\"tex-equation\"><img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/d8c5de0bab73c4e43c77c59eb44795e974a5dafc.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></center><p>where <span class=\"tex-span\"><i>p</i>\u2009=\u200910<sup class=\"upper-index\">7</sup>\u2009+\u200919</span> and <span class=\"tex-span\"><i>q</i>\u2009=\u200910<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>.</p><p>Print the answers to events of type 3 in the order in which they appear in the input.</p>",
    "samples": [
        {
            "input": "3 10<br/>30 4<br/>60 6<br/>5 1<br/>9<br/>3<br/>1 42 5<br/>1 20 3<br/>3<br/>2 2<br/>2 4<br/>3<br/>1 40 6<br/>3<br/>",
            "output": "556674384<br/>168191145<br/>947033915<br/>181541912<br/>"
        },
        {
            "input": "3 1000<br/>100 42<br/>100 47<br/>400 15<br/>4<br/>2 2<br/>2 1<br/>2 3<br/>3<br/>",
            "output": "0<br/>"
        }
    ],
    "note": "<p>In the first sample, the numbers of displayed exhibits and values <span class=\"tex-span\"><i>s</i>(1),\u2009...,\u2009<i>s</i>(10)</span> for individual events of type 3 are, in order: </p><center class=\"tex-equation\"><img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/cd9cbad4d6c8ba8cdbbf9a3b1ef42e9d8439383d.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></center> <center class=\"tex-equation\"><img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/3f95fffbd0c32b53ec1f8c00688e1775113ec087.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></center> <center class=\"tex-equation\"><img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/c49fc439dd31d787510f0baee9823491dd48f14a.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></center> <center class=\"tex-equation\"><img align=\"middle\" class=\"tex-formula\" src=\"https://espresso.codeforces.com/a41a35d4c3c56e9e060570bd222583645efb2798.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/></center><p>The values of individual exhibits are <span class=\"tex-span\"><i>v</i><sub class=\"lower-index\">1</sub>\u2009=\u200930,\u2009<i>v</i><sub class=\"lower-index\">2</sub>\u2009=\u200960,\u2009<i>v</i><sub class=\"lower-index\">3</sub>\u2009=\u20095,\u2009<i>v</i><sub class=\"lower-index\">4</sub>\u2009=\u200942,\u2009<i>v</i><sub class=\"lower-index\">5</sub>\u2009=\u200920,\u2009<i>v</i><sub class=\"lower-index\">6</sub>\u2009=\u200940</span> and their masses are <span class=\"tex-span\"><i>w</i><sub class=\"lower-index\">1</sub>\u2009=\u20094,\u2009<i>w</i><sub class=\"lower-index\">2</sub>\u2009=\u20096,\u2009<i>w</i><sub class=\"lower-index\">3</sub>\u2009=\u20091,\u2009<i>w</i><sub class=\"lower-index\">4</sub>\u2009=\u20095,\u2009<i>w</i><sub class=\"lower-index\">5</sub>\u2009=\u20093,\u2009<i>w</i><sub class=\"lower-index\">6</sub>\u2009=\u20096</span>.</p><p>In the second sample, the only question is asked after removing all exhibits, so <span class=\"tex-span\"><i>s</i>(<i>m</i>)\u2009=\u20090</span> for any <span class=\"tex-span\"><i>m</i></span>.</p>",
    "contestId": 601,
    "index": "E",
    "name": "A Museum Robbery",
    "type": "PROGRAMMING",
    "tags": [
        "data structures",
        "dp"
    ],
    "solvedCount": 811
}