{
    "title": "D. Domino Carpet",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p><span class=\"tex-font-style-it\">...Mike the TV greets you again!</span> </p><p><span class=\"tex-font-style-it\">Tired of the monotonous furniture? Sick of gray routine? Dreaming about dizzying changes in your humble abode? We have something to offer you!</span> </p><p><span class=\"tex-font-style-it\">This domino carpet for only $99.99 will change your life! You can lay it on the floor, hang it on the wall or even on the ceiling! Among other things ...</span> </p><p>Having watched the commercial, virus Hexadecimal also wanted to get a Domino Carpet and wanted badly to be photographed in front of it. But of course, a virus will never consent to buying a licensed Carpet! So she ordered a truck of dominoes and decided to make such a Carpet herself. </p><p>The original Domino Carpet is a field of squares <span class=\"tex-span\"><i>n</i>\u2009\u00d7\u2009<i>m</i></span> in size. Each square is half of a domino, and can be rotated either vertically or horizontally, independently from its neighbors. Vertically rotated domino halves look like this: </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/dc948fb9935610f2edcaa94edaf504f4f95af644.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center> <p>And horizontally rotated halves look like this: </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/6d5cf56290803c55abdec640fa97b6ceb82374ed.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>Notice, that some halves looks the same in both rotations, but other halves differ.</p><p>Dominoes bought by Hexadecimal are represented by uncuttable chips <span class=\"tex-span\">1\u2009\u00d7\u20092</span> in size, which can be laid either vertically or horizontally. If the chip is laid vertically, then both of it's halves should be laid vertically orientated; if the chip is laid horizontally, then both of it's halves should be laid horizontally.</p><p>The samples of valid and invalid dominoes laid vertically and horizontally are: </p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/8fa8d68db3606f6415610de9abeb091c7231d052.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center> <p>Virus Hexadecimal assembles her own Domino Carpet so that the following conditions are satisfied:</p><ul> <li> each carpet square is covered by a domino chip, i.e. there are no empty squares; </li><li> all domino chips lie entirely within the carpet and don't overlap with each other; </li><li> if there is a horizontal domino chip with its left half in column <span class=\"tex-span\"><i>j</i></span> then there are no horizontal domino chips with their left halves in columns <span class=\"tex-span\"><i>j</i>\u2009-\u20091</span> or <span class=\"tex-span\"><i>j</i>\u2009+\u20091</span>. </li></ul><p>Before starting to assemble her own Domino Carpet, the virus wants to know the number of ways to achieve the intended purpose modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>.</p><p>You can assume that the virus has an infinitely large number of dominoes of each type.</p>",
    "inputSpecification": "<p>The first line contains two integers <span class=\"tex-span\"><i>n</i></span> and <span class=\"tex-span\"><i>m</i></span>, separated by a space \u2014 the size of the Domino Carpet (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>,\u2009<i>m</i>\u2009\u2264\u2009250</span>). Next <span class=\"tex-span\">4<i>n</i>\u2009+\u20091</span> lines contain <span class=\"tex-span\">4<i>m</i>\u2009+\u20091</span> symbols. </p><p>Each square of the Domino Carpet, which is a domino half, is described by a <span class=\"tex-span\">3\u2009\u00d7\u20093</span> square. Symbol <span class=\"tex-font-style-tt\">'O'</span> in this square indicates the presence of a point, symbol <span class=\"tex-font-style-tt\">'.'</span> \u2014 its absence. </p><p>Each <span class=\"tex-span\">3\u2009\u00d7\u20093</span> square is delineated from adjacent squares by symbols <span class=\"tex-font-style-tt\">'#'</span> as shown in the examples. </p><p>It is guaranteed that every box describes the correct half of a domino. </p><p>In all pretests the Domino Carpets have the size of <span class=\"tex-span\">2\u2009\u00d7\u20092</span> and <span class=\"tex-span\">4\u2009\u00d7\u20094</span>.</p>",
    "outputSpecification": "<p>Print a single number, the number of ways to assemble the Domino Carpet modulo <span class=\"tex-span\">10<sup class=\"upper-index\">9</sup>\u2009+\u20097</span>, using only standard dominoes of size <span class=\"tex-span\">1\u2009\u00d7\u20092</span>.</p>",
    "samples": [
        {
            "input": "3 4<br/>#################<br/>#O..#...#O.O#...#<br/>#.O.#.O.#.O.#...#<br/>#..O#...#O.O#...#<br/>#################<br/>#O.O#OOO#O.O#...#<br/>#.O.#...#...#.O.#<br/>#O.O#OOO#O.O#...#<br/>#################<br/>#O.O#...#O.O#...#<br/>#...#...#...#.O.#<br/>#O.O#...#O.O#...#<br/>#################<br/>",
            "output": "3"
        },
        {
            "input": "2 2<br/>#########<br/>#O.O#O.O#<br/>#.O.#...#<br/>#O.O#O.O#<br/>#########<br/>#...#O.O#<br/>#...#...#<br/>#...#O.O#<br/>#########<br/>",
            "output": "2"
        },
        {
            "input": "2 2<br/>#########<br/>#..O#O..#<br/>#...#...#<br/>#O..#..O#<br/>#########<br/>#O..#..O#<br/>#...#...#<br/>#..O#O..#<br/>#########<br/>",
            "output": "0"
        }
    ],
    "note": "<p><span class=\"tex-font-style-bf\">A note to the first example:</span> all correct ways to make Domino Carpet are represented below:</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/b96abcb2ea9a01c1e90dc1f2e7d56330b3ce0765.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center><p>And this way is incorrect:</p><center> <img class=\"tex-graphics\" src=\"https://espresso.codeforces.com/9357443c252ff7e9673f82f5a07af65082e20eb0.png\" style=\"max-width: 100.0%;max-height: 100.0%;\"/> </center>",
    "contestId": 77,
    "index": "D",
    "name": "Domino Carpet",
    "type": "PROGRAMMING",
    "tags": [
        "dp",
        "implementation"
    ],
    "solvedCount": 312
}