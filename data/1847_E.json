{
    "title": "E. Triangle Platinum?",
    "timeLimit": {
        "value": 2.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p><span class=\"tex-font-style-it\">This is an interactive problem.</span></p><p><span class=\"tex-font-style-it\">Made in Heaven</span> is a rather curious Stand. Of course, it is (arguably) the strongest Stand in existence, but it is also an ardent puzzle enjoyer. For example, it gave Qtaro the following problem recently:</p><p><span class=\"tex-font-style-it\">Made in Heaven</span> has $$$n$$$ hidden integers $$$a_1, a_2, \\dots, a_n$$$ ($$$3 \\le n \\le 5000$$$, $$$1 \\le a_i \\le 4$$$). Qtaro must determine all the $$$a_i$$$ by asking <span class=\"tex-font-style-it\">Made in Heaven</span> some queries of the following form: </p><ul> <li> In one query Qtaro is allowed to give <span class=\"tex-font-style-it\">Made in Heaven</span> three <span class=\"tex-font-style-bf\">distinct</span> indexes $$$i$$$, $$$j$$$ and $$$k$$$ ($$$1 \\leq i, j, k \\leq n$$$). </li><li> If $$$a_i, a_j, a_k$$$ form the sides of a non-degenerate triangle$$$^\\dagger$$$, <span class=\"tex-font-style-it\">Made in Heaven</span> will respond with the area of this triangle. </li><li> Otherwise, <span class=\"tex-font-style-it\">Made in Heaven</span> will respond with $$$0$$$. </li></ul><p>By asking at most $$$5500$$$ such questions, Qtaro must either tell <span class=\"tex-font-style-it\">Made in Heaven</span> all the values of the $$$a_i$$$, or report that it is <span class=\"tex-font-style-bf\">not</span> possible to <span class=\"tex-font-style-bf\">uniquely</span> determine them.</p><p>Unfortunately due to the universe reboot, Qtaro is not as smart as Jotaro. Please help Qtaro solve <span class=\"tex-font-style-it\">Made In Heaven</span>'s problem. </p><center> \u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014 </center><p>$$$^\\dagger$$$ Three positive integers $$$a, b, c$$$ are said to form the sides of a non-degenerate triangle if and only if all of the following three inequalities hold: </p><ul> <li> $$$a+b &gt; c$$$, </li><li> $$$b+c &gt; a$$$, </li><li> $$$c+a &gt; b$$$. </li></ul>",
    "inputSpecification": null,
    "outputSpecification": null,
    "samples": [
        {
            "input": "\n3\n\n63\n",
            "output": "\n\n? 1 2 3\n\n! -1"
        },
        {
            "input": "\n6\n\n0\n\n0\n\n0\n\n63\n\n15\n\n135\n\n",
            "output": "\n? 1 2 3\n\n? 2 3 4\n\n? 4 5 6\n\n? 1 5 6\n\n? 3 5 6\n\n? 1 2 4\n\n! 3 2 1 4 2 2"
        },
        {
            "input": "\n\n15\n\n3\n\n3\n\n3\n\n3\n\n3\n\n0\n\n",
            "output": "\n\n\n? 1 2 3\n\n? 4 6 7\n\n? 8 9 10\n\n? 11 12 13\n\n? 13 14 15\n\n? 4 5 6\n\n! -1\n"
        },
        {
            "input": "\n\n15\n\n3\n\n15\n\n0\n\n3\n\n3\n\n3\n\n",
            "output": "\n\n\n? 1 2 3\n\n? 3 4 5\n\n? 4 5 6\n\n? 7 8 9\n\n? 10 11 12\n\n? 13 14 15\n\n! 1 1 1 2 2 4 1 1 1 1 1 1 1 1 1 1\n"
        },
        {
            "input": "\n\n10\n\n3\n\n48\n\n3\n\n48\n\n63\n\n0\n\n\n",
            "output": "\n\n? 1 3 5\n\n? 4 6 8\n\n? 1 5 9\n\n? 6 8 10\n\n? 4 2 6\n\n? 7 10 8\n\n! 1 3 1 2 1 2 4 2 1 2\n"
        }
    ],
    "note": "<p>In the first example, the interaction process happens as follows:</p><center> <table class=\"tex-tabular\"><tbody><tr><td class=\"tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Stdin</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Stdout</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Explanation</span></td></tr><tr><td class=\"tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">3</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Read $$$n = 3$$$. There are $$$3$$$ hidden integers</td></tr><tr><td class=\"tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">? 1 2 3</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Ask for the area formed by $$$a_1$$$, $$$a_2$$$ and $$$a_3$$$</td></tr><tr><td class=\"tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">63</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Received $$$16\\Delta^2 = 63$$$. So the area $$$\\Delta = \\sqrt{\\frac{63}{16}} \\approx 1.984313$$$</td></tr><tr><td class=\"tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top\"><span class=\"tex-font-style-tt\">! -1</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top\">Answer that there is no <span class=\"tex-font-style-bf\">unique</span> array satisfying the queries.</td></tr></tbody></table> </center><p>From the area received, we can deduce that the numbers that forms the triangle are either ($$$4$$$, $$$4$$$, $$$1$$$) or ($$$3$$$, $$$2$$$, $$$2$$$) (in some order). As there are multiple arrays of numbers that satisfy the queries, a unique answer cannot be found.</p><p>In the second example, the interaction process happens as follows:</p><center> <table class=\"tex-tabular\"><tbody><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Step</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Stdin</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Stdout</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-bottom\"><span class=\"tex-font-style-bf\">Explanation</span></td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">1</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">6</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Read $$$n = 6$$$. There are $$$6$$$ hidden integers</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">2</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">? 1 2 3</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Ask for the area formed by $$$a_1$$$, $$$a_2$$$ and $$$a_3$$$</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">3</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">0</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Does not form a non-degenerate triangle</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">4</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">? 2 3 4</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Ask for the area formed by $$$a_2$$$, $$$a_3$$$ and $$$a_4$$$</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">5</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">0</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Does not form a non-degenerate triangle</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">6</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">? 4 5 6</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Ask for the area formed by $$$a_4$$$, $$$a_5$$$ and $$$a_6$$$</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">7</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">0</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Does not form a non-degenerate triangle</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top\"></td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-bottom\">8</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">? 1 5 6</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-bottom\">Ask for the area formed by $$$a_1$$$, $$$a_5$$$ and $$$a_6$$$</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">9</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">63</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Received $$$16\\Delta^2 = 63$$$. So the area $$$\\Delta = \\sqrt{\\frac{63}{16}} \\approx 1.984313$$$</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">10</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">? 3 5 6</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Ask for the area formed by $$$a_3$$$, $$$a_5$$$ and $$$a_6$$$</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">11</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">15</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Received $$$16\\Delta^2 = 15$$$. So the area $$$\\Delta = \\sqrt{\\frac{15}{16}} \\approx 0.968245$$$</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">12</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">? 1 2 4</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Ask for the area formed by $$$a_3$$$, $$$a_5$$$ and $$$a_6$$$</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\">13</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"><span class=\"tex-font-style-tt\">135</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top tex-tabular-border-bottom\">Received $$$16\\Delta^2 = 135$$$. So the area $$$\\Delta = \\sqrt{\\frac{135}{16}} \\approx 2.904738$$$</td></tr><tr><td class=\"tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top\">14</td><td class=\"tex-tabular-border-left tex-tabular-text-align-right tex-tabular-border-right tex-tabular-border-top\"></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top\"><span class=\"tex-font-style-tt\">! 3 2 1 4 2 2</span></td><td class=\"tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-top\">A unique answer is found, which is $$$a = [3, 2, 1, 4, 2, 2]$$$.</td></tr></tbody></table> </center><p>From steps $$$10$$$ and $$$11$$$, we can deduce that the the <span class=\"tex-font-style-bf\">multiset</span> $$$\\left\\{a_3, a_5, a_6\\right\\}$$$ must be $$$\\left\\{2, 2, 1\\right\\}$$$.</p><p>From steps $$$8$$$ and $$$9$$$, the <span class=\"tex-font-style-bf\">multiset</span> $$$\\left\\{a_1, a_5, a_6\\right\\}$$$ must be either $$$\\left\\{4, 4, 1\\right\\}$$$ or $$$\\left\\{3, 2, 2\\right\\}$$$.</p><p>As $$$\\left\\{a_3, a_5, a_6\\right\\}$$$ and $$$\\left\\{a_1, a_5, a_6\\right\\}$$$ share $$$a_5$$$ and $$$a_6$$$, we conclude that $$$a_5 = a_6 = 2$$$, as well as $$$a_1 = 3$$$, $$$a_3 = 1$$$.</p><p>From steps $$$6$$$ and $$$7$$$, we know that $$$a_5 = a_6 = 2$$$, and $$$a_4$$$, $$$a_5$$$ and $$$a_6$$$ cannot form a non-degenerate triangle, hence $$$a_4 = 4$$$.</p><p>With all the known information, only $$$a_2 = 2$$$ satisfies the queries made in steps $$$2$$$, $$$3$$$, $$$4$$$, $$$5$$$, $$$12$$$ and $$$13$$$.</p><p>In the third example, one array that satisfies the queries is $$$[1, 1, 1, 1, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]$$$.</p>",
    "contestId": 1847,
    "index": "E",
    "name": "Triangle Platinum?",
    "type": "PROGRAMMING",
    "tags": [
        "brute force",
        "combinatorics",
        "implementation",
        "interactive",
        "math",
        "probabilities"
    ],
    "solvedCount": 320
}