{
    "title": "D. Huffman Coding on Segment",
    "timeLimit": {
        "value": 4.0,
        "unit": "seconds"
    },
    "memoryLimit": {
        "value": 256.0,
        "unit": "megabytes"
    },
    "statement": "<p>Alice wants to send an important message to Bob. Message <span class=\"tex-span\"><i>a</i>\u2009=\u2009(<i>a</i><sub class=\"lower-index\">1</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub>)</span> is a sequence of positive integers (<span class=\"tex-font-style-it\">characters</span>).</p><p>To compress the message Alice wants to use binary Huffman coding. We recall that <span class=\"tex-font-style-it\">binary Huffman code</span>, or <span class=\"tex-font-style-it\">binary prefix code</span> is a function <span class=\"tex-span\"><i>f</i></span>, that maps each letter that appears in the string to some binary string (that is, string consisting of characters '<span class=\"tex-font-style-tt\">0</span>' and '<span class=\"tex-font-style-tt\">1</span>' only) such that for each pair of different characters <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>j</i></sub></span> string <span class=\"tex-span\"><i>f</i>(<i>a</i><sub class=\"lower-index\"><i>i</i></sub>)</span> is not a prefix of <span class=\"tex-span\"><i>f</i>(<i>a</i><sub class=\"lower-index\"><i>j</i></sub>)</span> (and vice versa). The result of the encoding of the message <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> is the concatenation of the encoding of each character, that is the string <span class=\"tex-span\"><i>f</i>(<i>a</i><sub class=\"lower-index\">1</sub>)<i>f</i>(<i>a</i><sub class=\"lower-index\">2</sub>)... <i>f</i>(<i>a</i><sub class=\"lower-index\"><i>n</i></sub>)</span>. Huffman codes are very useful, as the compressed message can be easily and uniquely decompressed, if the function <span class=\"tex-span\"><i>f</i></span> is given. Code is usually chosen in order to minimize the total length of the compressed message, i.e. the length of the string <span class=\"tex-span\"><i>f</i>(<i>a</i><sub class=\"lower-index\">1</sub>)<i>f</i>(<i>a</i><sub class=\"lower-index\">2</sub>)... <i>f</i>(<i>a</i><sub class=\"lower-index\"><i>n</i></sub>)</span>.</p><p>Because of security issues Alice doesn't want to send the whole message. Instead, she picks some substrings of the message and wants to send them separately. For each of the given substrings <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>l</i><sub class=\"lower-index\"><i>i</i></sub></sub>... <i>a</i><sub class=\"lower-index\"><i>r</i><sub class=\"lower-index\"><i>i</i></sub></sub></span> she wants to know the minimum possible length of the Huffman coding. Help her solve this problem.</p>",
    "inputSpecification": "<p>The first line of the input contains the single integer <span class=\"tex-span\"><i>n</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>n</i>\u2009\u2264\u2009100\u2009000</span>)\u00a0\u2014 the length of the initial message. The second line contains <span class=\"tex-span\"><i>n</i></span> integers <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\">1</sub>,\u2009<i>a</i><sub class=\"lower-index\">2</sub>,\u2009...,\u2009<i>a</i><sub class=\"lower-index\"><i>n</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>a</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009100\u2009000</span>)\u00a0\u2014 characters of the message.</p><p>Next line contains the single integer <span class=\"tex-span\"><i>q</i></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>q</i>\u2009\u2264\u2009100\u2009000</span>)\u00a0\u2014 the number of queries.</p><p>Then follow <span class=\"tex-span\"><i>q</i></span> lines with queries descriptions. The <span class=\"tex-span\"><i>i</i></span>-th of these lines contains two integers <span class=\"tex-span\"><i>l</i><sub class=\"lower-index\"><i>i</i></sub></span> and <span class=\"tex-span\"><i>r</i><sub class=\"lower-index\"><i>i</i></sub></span> (<span class=\"tex-span\">1\u2009\u2264\u2009<i>l</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>r</i><sub class=\"lower-index\"><i>i</i></sub>\u2009\u2264\u2009<i>n</i></span>)\u00a0\u2014 the position of the left and right ends of the <span class=\"tex-span\"><i>i</i></span>-th substring respectively. Positions are numbered from <span class=\"tex-span\">1</span>. Substrings may overlap in any way. The same substring may appear in the input more than once.</p>",
    "outputSpecification": "<p>Print <span class=\"tex-span\"><i>q</i></span> lines. Each line should contain a single integer\u00a0\u2014 the minimum possible length of the Huffman encoding of the substring <span class=\"tex-span\"><i>a</i><sub class=\"lower-index\"><i>l</i><sub class=\"lower-index\"><i>i</i></sub></sub>... <i>a</i><sub class=\"lower-index\"><i>r</i><sub class=\"lower-index\"><i>i</i></sub></sub></span>.</p>",
    "samples": [
        {
            "input": "7<br/>1 2 1 3 1 2 1<br/>5<br/>1 7<br/>1 3<br/>3 5<br/>2 4<br/>4 4<br/>",
            "output": "10<br/>3<br/>3<br/>5<br/>0<br/>"
        }
    ],
    "note": "<p>In the first query, one of the optimal ways to encode the substring is to map <span class=\"tex-span\">1</span> to \"<span class=\"tex-font-style-tt\">0</span>\", <span class=\"tex-span\">2</span> to \"<span class=\"tex-font-style-tt\">10</span>\" and <span class=\"tex-span\">3</span> to \"<span class=\"tex-font-style-tt\">11</span>\".</p><p>Note that it is correct to map the letter to the empty substring (as in the fifth query from the sample).</p>",
    "contestId": 700,
    "index": "D",
    "name": "Huffman Coding on Segment",
    "type": "PROGRAMMING",
    "tags": [
        "data structures",
        "greedy"
    ],
    "solvedCount": 455
}